define(["translations","pgadmin.browser.endpoints","pgadmin.browser.utils","pgadmin.browser.messages","pgadmin.user_management.current_user","pgadmin.server.supported_servers"],function(e,n,a,o,l,r){return webpackJsonp([0,2,3],[,,function(e,t,i){"use strict";var n,a;n=[i(43)],void 0!==(a=function(e){return function(t,i){var n,a=e[t]?e[t]:t,o=/([^%]*)%\(([^\)]+)\)s(.*)/,l=a;do{n=!1,l=l.replace(o,function(e,t,a,o){return n=!0,t+i[a]+o})}while(n);return l}}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a,o,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(i){a=[],n=i,void 0!==(o="function"==typeof n?n.apply(t,a):n)&&(e.exports=o)}(function(){var e=window.pgAdmin=window.pgAdmin||{};return function(e,t,i){function n(e,t,n,o){n=n||"width";var l,s,d,u=(t.match(c)||[])[2],m="px"===u?1:p[u+"toPx"],g=/r?em/i;if(m||g.test(u)&&!o)e=m?e:"rem"===u?r:"fontSize"===n?e.parentNode||e:e,m=m||parseFloat(a(e,"fontSize")),d=parseFloat(t)*m;else{l=e.style,s=l[n];try{l[n]=t}catch(e){return 0}d=l[n]?parseFloat(a(e,n)):0,l[n]=s!==i?s:null}return d}function a(e,t){var i,l,r,s,p,u=/^top|bottom/,m=["paddingTop","paddingBottom","borderTop","borderBottom"],g=4;if(i=d?d(e)[t]:(l=e.style["pixel"+t.charAt(0).toUpperCase()+t.slice(1)])?l+"px":"fontSize"===t?n(e,"1em","left",1)+"px":e.currentStyle[t],"%"===(r=(i.match(c)||[])[2])&&o)if(u.test(t)){for(s=(p=e.parentNode||e).offsetHeight;g--;)s-=parseFloat(a(p,m[g]));i=parseFloat(i)/100*s+"px"}else i=n(e,i);else("auto"===i||r&&"px"!==r)&&d?i=0:r&&"px"!==r&&!d&&(i=n(e,i)+"px");return i}var o,l=t.createElement("test"),r=t.documentElement,s=t.defaultView,d=s&&s.getComputedStyle,c=/^(-?[\d+\.\-]+)([a-z]+|%)$/i,p={},u=[1/25.4,1/2.54,1/72,1/6],m=["mm","cm","pt","pc","in","mozmm"],g=6;for(r.appendChild(l),d&&(l.style.marginTop="1%",o="1%"===d(l).marginTop);g--;)p[m[g]+"toPx"]=u[g]?u[g]*p.inToPx:n(l,"1"+m[g]);r.removeChild(l),l=i,e.toPx=n}(e,window.document),e.natural_sort=function(e,t,i){var n,a,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,r=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,d=/^0x[0-9a-f]+$/i,c=/^0/,i=i||{},p=function(e){return i.insensitive&&(""+e).toLowerCase()||""+e},u=p(e).replace(r,"")||"",m=p(t).replace(r,"")||"",g=u.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),h=m.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),b=parseInt(u.match(d))||1!==g.length&&u.match(s)&&Date.parse(u),f=parseInt(m.match(d))||b&&m.match(s)&&Date.parse(m)||null,_=i.desc?-1:1;if(f){if(b<f)return-1*_;if(b>f)return 1*_}for(var v=0,y=Math.max(g.length,h.length);v<y;v++){if(n=!(g[v]||"").match(c)&&parseFloat(g[v])||g[v]||0,a=!(h[v]||"").match(c)&&parseFloat(h[v])||h[v]||0,isNaN(n)!==isNaN(a))return(isNaN(n)?1:-1)*_;if((void 0===n?"undefined":l(n))!==(void 0===a?"undefined":l(a))&&(n+="",a+=""),n<a)return-1*_;if(n>a)return 1*_}return 0},e})},,function(e,t,i){"use strict";var n,a;n=[i(44)],void 0!==(a=function(e){return function(t,i){var n=e[t],a=/([<])([^:^>]*:)?([^>]+)([>])/g,o=n;return n?o=o.replace(a,function(e,t,n,a){return a in i?i[a]:e}):n}}.apply(t,n))&&(e.exports=a)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(13),a=function(e){return e&&e.__esModule?e:{default:e}}(n);i(49),i(84),i(85),i(74),i(86),i(87),i(88),i(89),i(50),i(90),i(75),i(91),i(92),i(93),i(94),i(37),t.default=a.default},,,,,,,,,function(e,t,i){"use strict";(function(e){var n,a,o,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(r){"object"==l(t)&&"object"==l(e)?r(i(13)):(a=[i(13)],n=r,void 0!==(o="function"==typeof n?n.apply(t,a):n)&&(e.exports=o))}(function(e){e.pgadminKeywordRangeFinder=function(t,i,n,a){for(var o,l,r=i.line,s=t.getLine(r),d=s.length;d>0;){var c=s.lastIndexOf(n,d),p=n,u=a;if(c<i.ch){var c=s.lastIndexOf("[",d);if(c<i.ch)break;var p="[",u="]"}if(l=t.getTokenAt(e.Pos(r,c+1)).type,!/^(comment|string)/.test(l)){o=c;break}d=c-1}if(!(null==o||s.lastIndexOf(p)>o)){var m,g,h=1,b=t.lineCount();e:for(var f=r+1;f<b;++f)for(var _=t.getLine(f),v=0;;){var y=_.indexOf(p,v),w=_.indexOf(u,v);if(y<0&&(y=_.length),w<0&&(w=_.length),(v=Math.min(y,w))==_.length)break;if(t.getTokenAt(e.Pos(f,v+1)).type==l)if(v==y)++h;else if(!--h){m=f,g=v;break e}++v}if(null!=m&&m!=r+1)return{from:e.Pos(r,o+n.length),to:e.Pos(m,g)}}},e.pgadminBeginRangeFinder=function(t,i){return e.pgadminKeywordRangeFinder(t,i,"BEGIN","END;")},e.pgadminIfRangeFinder=function(t,i){return e.pgadminKeywordRangeFinder(t,i,"IF","END IF")},e.pgadminLoopRangeFinder=function(t,i){return e.pgadminKeywordRangeFinder(t,i,"LOOP","END LOOP")},e.pgadminCaseRangeFinder=function(t,i){return e.pgadminKeywordRangeFinder(t,i,"CASE","END CASE")}})}).call(t,i(45)(e))},,,,,,function(t,i){t.exports=e},function(e,t){e.exports=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=a},,,,,,,,,,,,,,,,,,,function(e,t){e.exports=o},function(e,t,i){"use strict";function n(e,t,i,n,a,l){var r="";return o.default.each(o.default.sortBy(o.default.pick(t,a),function(e){return e.priority}),function(e){r=r+"/"+encodeURI(e._id)}),r=l?r+"/"+l:r+"/",""+e+n+"/"+i+r}var a=i(1),o=function(e){return e&&e.__esModule?e:{default:e}}(a);e.exports={generate_url:n}},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(15),i(3),i(6),i(10),i(11),i(13),i(17),i(29),i(22),i(26),i(154)],void 0!==(a=function(e,t,i,n,a,o,l,r,s,d,c,p){var u=function(e){var t=e.get("type");if(-1!=t.indexOf("[]"))return-1!=t.indexOf("integer")?d.Extension.InputIntegerArrayCell:d.Extension.InputStringArrayCell;switch(t){case"bool":return d.BooleanCell;case"integer":return void 0!=e.get("value")&&e.set({value:parseInt(e.get("value"))},{silent:!0}),d.IntegerCell;case"real":return void 0!=e.get("value")&&e.set({value:parseFloat(e.get("value"))},{silent:!0}),d.NumberCell;case"string":return d.StringCell;case"date":return d.DateCell;default:return d.Cell}},m=function(e){return-1!=e.get("type").indexOf("[]")?d.StringCell:d.BooleanCell},g=s.Model.extend({defaults:{name:void 0,type:void 0,is_null:void 0,expr:void 0,value:void 0,use_default:void 0,default_value:void 0},validate:function(){if(n.isUndefined(this.get("value"))||n.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var t=e("Please enter a value for the parameter.");return this.errorModel.set("value",t),t}return this.errorModel.unset("value"),null}}),h=s.Collection.extend({model:g}),b=function(e){return e instanceof s.Model&&e.get("use_default")},f=function(e){e.get("type");if(e instanceof s.Model){return-1==e.get("type").indexOf("[]")}};return function(a,l){o.debuggerInputArgsDialog||o.dialog("debuggerInputArgsDialog",function(){return{main:function(a,l,s){this.set("title",a),this.data=l,this.restart_debug=s;var c=this.func_args_data=[];if(0==s){var p=r.tree,g=p.selected(),_=g&&1==g.length?p.itemData(g):void 0,v=_&&r.Nodes[_._type];if(!_)return;var y=v.getTreeNodeHierarchy.apply(v,[g]);if("function"==_._type)var w=t("debugger.get_arguments",{sid:y.server._id,did:y.database._id,scid:y.schema._id,func_id:y.function._id});else if("procedure"==_._type)var w=t("debugger.get_arguments",{sid:y.server._id,did:y.database._id,scid:y.schema._id,func_id:y.procedure._id});else if("edbfunc"==_._type)var w=t("debugger.get_arguments",{sid:y.server._id,did:y.database._id,scid:y.schema._id,func_id:y.edbfunc._id});else if("edbproc"==_._type)var w=t("debugger.get_arguments",{sid:y.server._id,did:y.database._id,scid:y.schema._id,func_id:y.edbproc._id})}else var w=t("debugger.get_arguments",{sid:this.data.server_id,did:this.data.database_id,scid:this.data.schema_id,func_id:this.data.function_id});i.ajax({url:w,method:"GET",async:!1,success:function(e){if(0!=e.data.args_count)for(g=0;g<e.data.result.length;g++)c.push({arg_id:e.data.result[g].arg_id,is_null:e.data.result[g].is_null,is_expression:e.data.result[g].is_expression,use_default:e.data.result[g].use_default,value:e.data.result[g].value})},error:function(t){o.alert(e("Debugger Error"),e("Unable to fetch the arguments from server"))}});var x,C,N,D,k,S,T=d.HeaderCell.extend({className:"width_percent_25"}),j=[],M=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"type",label:e("Type"),type:"text",editable:!1,cell:"string"},{name:"is_null",label:e("Null?"),type:"boolean",cell:"boolean"},{name:"expr",label:e("Expression?"),type:"boolean",cellFunction:m,editable:f},{name:"value",label:e("Value"),type:"text",editable:!0,cellFunction:u,headerCell:T},{name:"use_default",label:e("Use Default?"),type:"boolean",cell:"boolean",editable:b},{name:"default_value",label:e("Default value"),type:"text",editable:!1,cell:"string"}],E=[],P=[],U=this.input_arg_id=[];if(null!=this.data.proargmodes)for(var I=this.data.proargmodes.split(","),O=0;O<I.length;O++)"i"!=I[O]&&"b"!=I[O]||U.push(O);else for(var A=this.data.proargtypenames.split(","),O=0;O<A.length;O++)U.push(O);if(C=this.data.proargtypenames.split(","),null!=this.data.proargmodes&&(N=this.data.proargmodes.split(",")),this.data.pronargdefaults&&(D=this.data.pronargdefaults,k=this.data.proargdefaults.split(","),S=D),null!=this.data.proargnames){x=this.data.proargnames.split(",");for(var q=x.length-1;q>=0;q--)null!=this.data.proargmodes?!S||"i"!=N[q]&&"b"!=N[q]?j[q]="<No default value>":(S-=1,j[q]=k[S]):S?(S-=1,j[q]=k[S]):j[q]="<No default value>";if(0!=C.length)for(g=0;g<C.length;g++)if(null!=this.data.proargmodes){if("i"==N[g]||"b"==N[g]){var B=!1;"<No default value>"!=j[g]&&(B=!0),E.push({name:x[g],type:C[g],use_default:B,default_value:j[g]})}}else{var B=!1;"<No default value>"!=j[g]&&(B=!0),E.push({name:x[g],type:C[g],use_default:B,default_value:j[g]})}if(0!=c.length)for(g=0;g<c.length;g++){var z=c[g].arg_id,L=[];if(-1!=C[z].indexOf("[]")){var H=c[g].value.split(",");-1!=C[z].indexOf("integer")&&n.each(H,function(e){L.push({value:parseInt(e)})}),n.each(H,function(e){L.push({value:e})})}else L=c[g].value;P.push({name:x[z],type:C[z],is_null:!!c[g].is_null,expr:!!c[g].is_expression,value:L,use_default:!!c[g].use_default,default_value:j[z]})}}else{var F=[];for(g=0;g<C.length;g++)F[g]="dbgparam"+(g+1);if(this.data.pronargdefaults){for(var q=F.length-1;q>=0;q--)null==this.data.proargmodes?S?(S-=1,j[q]=k[S]):j[q]="<No default value>":!S||"i"!=N[q]&&"b"!=N[q]?j[q]="<No default value>":(S-=1,j[q]=k[S]);for(g=0;g<C.length;g++)if(null==this.data.proargmodes){var B=!1;"<No default value>"!=j[g]&&(B=!0),E.push({name:F[g],type:C[g],use_default:B,default_value:j[g]})}else if("i"==N[g]||"b"==N[g]){var B=!1;"<No default value>"!=j[g]&&(B=!0),E.push({name:F[g],type:C[g],use_default:B,default_value:j[g]})}}else for(g=0;g<C.length;g++)E.push({name:F[g],type:C[g],use_default:!1,default_value:"<No default value>"}),j[g]="<No default value>";if(0!=c.length)for(g=0;g<c.length;g++){var z=c[g].arg_id,L=[];if(-1!=C[z].indexOf("[]")){var H=c[g].value.split(",");-1!=C[z].indexOf("integer")&&n.each(H,function(e){L.push({value:parseInt(e)})}),n.each(H,function(e){L.push({value:e})})}else L=c[g].value;P.push({name:F[z],type:C[z],is_null:!!c[g].is_null,expr:!!c[g].is_expression,value:L,use_default:!!c[g].use_default,default_value:j[z]})}}if(0==c.length)var R=this.debuggerInputArgsColl=new h(E);else var R=this.debuggerInputArgsColl=new h(P);this.grid&&(this.grid.remove(),this.grid=null);var $=this.grid=new d.Grid({columns:M,collection:R,className:"backgrid table-bordered"});$.render(),i(this.elements.content).html($.el);var V=i($.el).find("input:checkbox").first();V.length&&setTimeout(function(){V.click()},250)},setup:function(){return{buttons:[{text:"Debug",key:13,className:"btn btn-primary"},{text:"Cancel",key:27,className:"btn btn-primary"}],options:{padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1}}},callback:function(n){if("Debug"===n.button.text){var a=this;if(0==a.restart_debug){var l=r.tree,s=l.selected(),d=s&&1==s.length?l.itemData(s):void 0,c=d&&r.Nodes[d._type];if(!d)return;var p=c.getTreeNodeHierarchy.apply(c,[s])}var u=[],m=this.sqlite_func_args_list=[],g=0;if(this.grid.collection.each(function(e){if(e.get("is_null")?u.push({name:e.get("name"),type:e.get("type"),value:"NULL"}):e.get("use_default")?u.push({name:e.get("name"),type:e.get("type"),value:e.get("default_value")}):u.push({name:e.get("name"),type:e.get("type"),value:e.get("value")}),0==a.restart_debug){var t;"function"==d._type?t=p.function._id:"procedure"==d._type?t=p.procedure._id:"edbfunc"==d._type?t=p.edbfunc._id:"edbproc"==d._type&&(t=p.edbproc._id),m.push({server_id:p.server._id,database_id:p.database._id,schema_id:p.schema._id,function_id:t,arg_id:a.input_arg_id[g],is_null:e.get("is_null")?1:0,is_expression:e.get("expr")?1:0,use_default:e.get("use_default")?1:0,value:e.get("value")})}else m.push({server_id:a.data.server_id,database_id:a.data.database_id,schema_id:a.data.schema_id,function_id:a.data.function_id,arg_id:a.input_arg_id[g],is_null:e.get("is_null")?1:0,is_expression:e.get("expr")?1:0,use_default:e.get("use_default")?1:0,value:e.get("value")});g+=1}),0==a.restart_debug){var h;"function"==d._type?h=t("debugger.initialize_target_for_function",{debug_type:"direct",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.function._id}):"procedure"==d._type?h=t("debugger.initialize_target_for_function",{debug_type:"direct",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.procedure._id}):"edbfunc"==d._type?h=t("debugger.initialize_target_for_function",{debug_type:"direct",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.edbfunc._id}):"edbproc"==d._type&&(h=t("debugger.initialize_target_for_function",{debug_type:"direct",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.edbproc._id})),i.ajax({url:h,method:"POST",data:{data:JSON.stringify(u)},success:function(n){var a=t("debugger.direct",{trans_id:n.data.debuggerTransId});if(n.data.newBrowserTab)window.open(a,"_blank");else{r.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",function(e){e.openURL(a)});var l=r.docker.findPanels("properties"),s=r.docker.addPanel("frm_debugger",wcDocker.DOCK.STACKED,l[0]);s.focus(),s.on(wcDocker.EVENT.CLOSED,function(){var e=t("debugger.close",{trans_id:n.data.debuggerTransId});i.ajax({url:e,method:"DELETE"})})}if("function"==d._type)var c=t("debugger.set_arguments",{sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.function._id});else if("procedure"==d._type)var c=t("debugger.set_arguments",{sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.procedure._id});else if("edbfunc"==d._type)var c=t("debugger.set_arguments",{sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.edbfunc._id});else if("edbproc"==d._type)var c=t("debugger.set_arguments",{sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.edbproc._id});i.ajax({url:c,method:"POST",data:{data:JSON.stringify(m)},success:function(e){},error:function(t){o.alert(e("Debugger Error"),e("Unable to set the arguments on the server"))}})},error:function(t){o.alert(e("Debugger Target Initialization Error"),t.responseJSON.errormsg)}})}else{var h=t("debugger.start_listener",{trans_id:a.data.trans_id});i.ajax({url:h,method:"POST",data:{data:JSON.stringify(u)},success:function(e){},error:function(t){o.alert(e("Debugger Listener Startup Error"),t.responseJSON.errormsg)}});var b=t("debugger.set_arguments",{sid:a.data.server_id,did:a.data.database_id,scid:a.data.schema_id,func_id:a.data.function_id});i.ajax({url:b,method:"POST",data:{data:JSON.stringify(m)},success:function(e){},error:function(t){o.alert(e("Debugger Error"),e("Unable to set the arguments on the server"))}})}return!0}if("Cancel"===n.button.text)return!1},build:function(){o.pgDialogBuild.apply(this)},prepare:function(){i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),0==this.func_args_data.length?this.__internal.buttons[0].element.disabled=!0:this.__internal.buttons[0].element.disabled=!1,this.grid.listenTo(this.debuggerInputArgsColl,"backgrid:edited",function(e){return function(){for(var t=!1,i=0;i<this.collection.length;i++)if(""==this.collection.models[i].get("value")||null==this.collection.models[i].get("value")||void 0==this.collection.models[i].get("value")){if(t=!0,!this.collection.models[i].get("use_default")){e.__internal.buttons[0].element.disabled=!0;break}e.__internal.buttons[0].element.disabled=!1}t||(e.__internal.buttons[0].element.disabled=!1)}}(this))}}}),o.debuggerInputArgsDialog("Debugger",a,l).resizeTo("60%","60%")}}.apply(t,n))&&(e.exports=a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n,a;n=[i(0),i(1),i(4)],void 0!==(a=function(e,t,i){return function(e,n){if(t.isUndefined(n)||t.isNull(n))return!0;i.startsWith(n,"coll-")&&(n=n.replace("coll-",""));var a=["server_group","server","catalog_object_column"];if(t.indexOf(a,n)>=0)return!0;var o=e.get_preference("browser","show_node_"+n);return!o||o.value}}.apply(t,n))&&(e.exports=a)},,,,function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(15),i(3),i(6),i(10),i(11),i(28),i(17),i(97),i(29),i(22),i(26)],void 0!==(a=function(e,t,i,n,a,o,l,r,s,d,c,p,u){var m=c.default;null!=l.Browser.tree&&(l=l||window.pgAdmin||{});var g=l.Tools=l.Tools||{};if(g.DirectDebug)return g.DirectDebug;var h=new function(){};n.extend(h,s.Events,{enable:function(e,t){this.trigger("pgDebugger:button:state:"+e,t)},set_breakpoint:function(n,a,l){var r=t("debugger.set_breakpoint",{trans_id:n,line_no:a,set_type:l});i.ajax({url:r,method:"GET",success:function(e){e.data.status},error:function(t){o.alert(e("Debugger Error"),e("Error while setting debugging breakpoint."))}})},UpdateBreakpoint:function(e){var t=this,i=t.GetBreakpointInformation(e);if(1!=i.length||-1!=i[0].linenumber){for(var n=new Array,a=0;a<i.length;a++)-1!=i[a].linenumber&&n.push(i[a].linenumber);for(var a=0;a<n.length;a++){void 0!=g.DirectDebug.editor.lineInfo(n[a]-1).gutterMarkers?g.DirectDebug.editor.setGutterMarker(n[a]-1,"breakpoints",null):g.DirectDebug.editor.setGutterMarker(n[a]-1,"breakpoints",function(){var e=document.createElement("div");return e.style.color="#822",e.innerHTML="●",e}())}}},GetBreakpointInformation:function(n){var a="",l=t("debugger.execute_query",{trans_id:n,query_type:"get_breakpoints"});return i.ajax({url:l,method:"GET",async:!1,success:function(t){"Success"===t.data.status?a=t.data.result:"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while fetching breakpoint information."))},error:function(t){o.alert(e("Debugger Error"),e("Error while fetching breakpoint information."))}}),a},start_execution:function(n,a){var l=this,r=t("debugger.start_execution",{trans_id:n,port_num:a});i.ajax({url:r,method:"GET",success:function(t){"Success"===t.data.status?l.execute_query(n):"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while starting debugging session."))},error:function(t){o.alert(e("Debugger Error"),e("Error while starting debugging session."))}})},execute_query:function(n){var a=this,l=t("debugger.execute_query",{trans_id:n,query_type:"wait_for_breakpoint"});i.ajax({url:l,method:"GET",success:function(t){if("Success"===t.data.status){if(null!=t.data.result[0].src&&null!=t.data.result[0].linenumber){g.DirectDebug.editor.setValue(t.data.result[0].src);a.active_line_no=t.data.result[0].linenumber-2;g.DirectDebug.editor.addLineClass(t.data.result[0].linenumber-2,"wrap","CodeMirror-activeline-background")}a.GetStackInformation(n),g.DirectDebug.debug_type&&a.poll_end_execution_result(n)}else"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while executing requested debugging information."))},error:function(t){o.alert(e("Debugger Error"),e("Error while executing requested debugging information."))}})},GetLocalVariables:function(n){var a=this,l=t("debugger.execute_query",{trans_id:n,query_type:"get_variables"});i.ajax({url:l,method:"GET",success:function(t){"Success"===t.data.status?(a.AddLocalVariables(t.data.result),a.AddParameters(t.data.result),g.DirectDebug.debug_restarted&&(g.DirectDebug.debug_type&&a.poll_end_execution_result(n),g.DirectDebug.debug_restarted=!1)):"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while fetching variable information."))},error:function(t){o.alert(e("Debugger Error"),e("Error while fetching variable information."))}})},GetStackInformation:function(n){var a=this,l=t("debugger.execute_query",{trans_id:n,query_type:"get_stack_info"});i.ajax({url:l,method:"GET",success:function(t){"Success"===t.data.status?(a.AddStackInformation(t.data.result),a.GetLocalVariables(g.DirectDebug.trans_id)):"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while fetching stack information."))},error:function(t){o.alert(e("Debugger Error"),e("Error while fetching stack information."))}})},poll_result:function(n){var a=this;if(g.DirectDebug.is_polling_required){var l=t("debugger.poll_result",{trans_id:n});if(g.DirectDebug.polling_timeout_idle)var r=1e3;else var r=200;setTimeout(function(){i.ajax({url:l,method:"GET",beforeSend:function(e,t){i(".debugger-container").addClass("show_progress")},success:function(t){i(".debugger-container").removeClass("show_progress"),"Success"===t.data.status?null==t.data.result||0==t.data.result.length?a.poll_result(n):(void 0!=t.data.result[0].src||null!=t.data.result[0].src?(g.DirectDebug.polling_timeout_idle=!1,g.DirectDebug.docker.finishLoading(50),g.DirectDebug.editor.setValue(t.data.result[0].src),a.UpdateBreakpoint(n),g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),g.DirectDebug.editor.addLineClass(t.data.result[0].linenumber-2,"wrap","CodeMirror-activeline-background"),a.active_line_no=t.data.result[0].linenumber-2,a.GetStackInformation(n)):g.DirectDebug.debug_type||g.DirectDebug.first_time_indirect_debug?(g.DirectDebug.polling_timeout_idle=!1,g.DirectDebug.docker.finishLoading(50),t.data.result[0].src!=g.DirectDebug.editor.getValue()&&(g.DirectDebug.editor.setValue(t.data.result[0].src),a.UpdateBreakpoint(n)),g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),g.DirectDebug.editor.addLineClass(t.data.result[0].linenumber-2,"wrap","CodeMirror-activeline-background"),a.active_line_no=t.data.result[0].linenumber-2,a.GetStackInformation(n)):(g.DirectDebug.docker.finishLoading(50),void 0!=a.active_line_no&&g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),a.clear_all_breakpoint(n),a.execute_query(n),g.DirectDebug.first_time_indirect_debug=!0,g.DirectDebug.polling_timeout_idle=!1),a.enable("stop",!0),a.enable("step_over",!0),a.enable("step_into",!0),a.enable("continue",!0),a.enable("toggle_breakpoint",!0),a.enable("clear_all_breakpoints",!0)):"Busy"===t.data.status?(g.DirectDebug.polling_timeout_idle=!0,g.DirectDebug.debug_type?a.poll_result(n):(g.DirectDebug.docker.startLoading(e("Waiting for another session to invoke the target...")),a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("continue",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),g.DirectDebug.first_time_indirect_debug=!1,a.poll_result(n))):"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while polling result."))},error:function(t){o.alert(e("Debugger Error"),e("Error while polling result."))}})},r)}},update_messages:function(e){e=n.escape(e);var t="",i="";t=g.DirectDebug.messages_panel.$container.find(".messages").html(),i=t?(t+"\n"+e).replace(/(?:\r\n|\r|\n)/g,"<br />").replace(/(<br\ ?\/?>)+/g,"<br />"):e,g.DirectDebug.messages_panel.$container.find(".messages").html(i)},poll_end_execution_result:function(n){var a=this;if(g.DirectDebug.is_polling_required){var l=t("debugger.poll_end_execution_result",{trans_id:n});if(g.DirectDebug.polling_timeout_idle)var r=1200;else var r=250;setTimeout(function(){i.ajax({url:l,method:"GET",success:function(t){"Success"===t.data.status?void 0==t.data.result?(g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),g.DirectDebug.direct_execution_completed=!0,g.DirectDebug.polling_timeout_idle=!0,o.success(t.info,3),t.data.status_message&&a.update_messages(t.data.status_message),i(".debugger-container").removeClass("show_progress"),a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!0),g.DirectDebug.is_polling_required=!1):null!=t.data.result&&(g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),a.AddResults(t.data.col_info,t.data.result),g.DirectDebug.results_panel.focus(),g.DirectDebug.direct_execution_completed=!0,g.DirectDebug.polling_timeout_idle=!0,o.success(t.info,3),t.data.status_message&&a.update_messages(t.data.status_message),i(".debugger-container").removeClass("show_progress"),a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!0),g.DirectDebug.is_polling_required=!1):"Busy"===t.data.status?(a.poll_end_execution_result(n),t.data.status_message&&a.update_messages(t.data.status_message)):"NotConnected"===t.data.status?o.alert(e("Debugger poll end execution error"),t.data.result):"ERROR"===t.data.status&&(g.DirectDebug.direct_execution_completed=!0,g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),g.DirectDebug.is_user_aborted_debugging||o.error(t.info,3),t.data.status_message&&a.update_messages(t.data.status_message),g.DirectDebug.messages_panel.focus(),i(".debugger-container").removeClass("show_progress"),a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),g.DirectDebug.is_user_aborted_debugging||(a.enable("continue",!0),g.DirectDebug.is_user_aborted_debugging=!1),g.DirectDebug.is_polling_required=!1)},error:function(t){o.alert(e("Debugger Error"),e("Error while polling result."))}})},r)}},Restart:function(n){var a=this,l=t("debugger.restart",{trans_id:n});a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1),g.DirectDebug.messages_panel.$container.find(".messages").html(""),i.ajax({url:l,success:function(l){var r=l.data.restart_debug?1:0;if(g.DirectDebug.polling_timeout_idle=!1,g.DirectDebug.is_polling_required=!0,a.poll_end_execution_result(n),a.poll_result(n),r&&(g.DirectDebug.debug_restarted=!0),l.data.result.require_input){u(l.data.result,r)}else{var s=t("debugger.start_listener",{trans_id:n});i.ajax({url:s,method:"GET",success:function(e){g.DirectDebug.debug_type&&a.poll_end_execution_result(n)},error:function(t){o.alert(e("Debugger Error"),e("Error while polling result."))}})}},error:function(t,n,a){try{var l=i.parseJSON(t.responseText);0==l.success&&o.alert(e("Debugger Error"),l.errormsg)}catch(e){}}})},Continue:function(n){var a=this;if(a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1),g.DirectDebug.direct_execution_completed&&g.DirectDebug.direct_execution_completed==g.DirectDebug.polling_timeout_idle)a.Restart(n);else{var l=t("debugger.execute_query",{trans_id:n,query_type:"continue"});i.ajax({url:l,method:"GET",success:function(t){t.data.status?a.poll_result(n):o.alert(e("Debugger Error"),e("Error while executing continue in debugging session."))},error:function(t){o.alert(e("Debugger Error"),e("Error while executing continue in debugging session."))}})}},Step_over:function(n){var a=this;a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1);var l=t("debugger.execute_query",{trans_id:n,query_type:"step_over"});i.ajax({url:l,method:"GET",success:function(t){t.data.status?a.poll_result(n):o.alert(e("Debugger Error"),e("Error while executing step over in debugging session."))},error:function(t){o.alert(e("Debugger Error"),e("Error while executing step over in debugging session."))}})},Step_into:function(n){var a=this;a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1);var l=t("debugger.execute_query",{trans_id:n,query_type:"step_into"});i.ajax({url:l,method:"GET",success:function(t){t.data.status?a.poll_result(n):o.alert(e("Debugger Error"),e("Error while executing step into in debugging session."))},error:function(t){o.alert(e("Debugger Error"),e("Error while executing step into in debugging session."))}})},Stop:function(n){var a=this;a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1);var l=t("debugger.execute_query",{trans_id:n,query_type:"abort_target"});i.ajax({url:l,method:"GET",success:function(t){t.data.status?(g.DirectDebug.editor.removeLineClass(a.active_line_no,"wrap","CodeMirror-activeline-background"),g.DirectDebug.direct_execution_completed=!0,g.DirectDebug.is_user_aborted_debugging=!0,g.DirectDebug.is_polling_required=!1,a.enable("continue",!1),o.success(t.info,3)):"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while executing stop in debugging session."))},error:function(t){o.alert(e("Debugger Error"),e("Error while executing stop in debugging session."))}})},toggle_breakpoint:function(n){var a=this;a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1);var l=g.DirectDebug.editor.lineInfo(a.active_line_no),r="";r=void 0==l.gutterMarkers?t("debugger.set_breakpoint",{trans_id:n,line_no:a.active_line_no+1,set_type:"1"}):t("debugger.set_breakpoint",{trans_id:n,line_no:a.active_line_no+1,set_type:"0"}),i.ajax({url:r,method:"GET",success:function(t){if(t.data.status){void 0!=g.DirectDebug.editor.lineInfo(a.active_line_no).gutterMarkers?g.DirectDebug.editor.setGutterMarker(a.active_line_no,"breakpoints",null):g.DirectDebug.editor.setGutterMarker(a.active_line_no,"breakpoints",function(){var e=document.createElement("div");return e.style.color="#822",e.innerHTML="●",e}()),a.enable("stop",!0),a.enable("step_over",!0),a.enable("step_into",!0),a.enable("toggle_breakpoint",!0),a.enable("clear_all_breakpoints",!0),a.enable("continue",!0)}else"NotConnected"===t.data.status&&o.alert(e("Debugger Error"),e("Error while toggling breakpoint."))},error:function(t){o.alert(e("Debugger Error"),e("Error while toggling breakpoint."))}})},clear_all_breakpoint:function(n){var a=this,l=a.GetBreakpointInformation(n);if(1!=l.length||-1!=l[0].linenumber){a.enable("stop",!1),a.enable("step_over",!1),a.enable("step_into",!1),a.enable("toggle_breakpoint",!1),a.enable("clear_all_breakpoints",!1),a.enable("continue",!1);for(var r=new Array,s=0;s<l.length;s++)-1!=l[s].linenumber&&r.push(l[s].linenumber);var d=t("debugger.clear_all_breakpoint",{trans_id:n});i.ajax({url:d,method:"POST",data:{breakpoint_list:r.join()},success:function(e){if(e.data.status)for(var t=0;t<r.length;t++){var i=g.DirectDebug.editor.lineInfo(r[t]-1);i&&void 0!=i.gutterMarkers&&g.DirectDebug.editor.setGutterMarker(r[t]-1,"breakpoints",null)}a.enable("stop",!0),a.enable("step_over",!0),a.enable("step_into",!0),a.enable("toggle_breakpoint",!0),a.enable("clear_all_breakpoints",!0),a.enable("continue",!0)},error:function(t){o.alert(e("Debugger Error"),e("Error while clearing all breakpoint."))}})}},AddStackInformation:function(t){var i=this;i.stack_grid&&(i.stack_grid.remove(),i.stack_grid=null);for(var n=s.Model.extend({defaults:{frame_id:0,name:void 0,value:void 0,line_no:void 0}}),a=s.Collection.extend({model:n}),o=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"value",label:e("Value"),type:"text",editable:!1,cell:"string"},{name:"line_no",label:e("Line No."),type:"text",editable:!1,cell:"string"}],l=[],r=0;r<t.length;r++)l.push({frame_id:r,name:t[r].targetname,value:t[r].args,line_no:t[r].linenumber});var c=this.stackColl=new a(l);this.stackColl.on("backgrid:row:selected",i.select_frame,i);var p=this.stack_grid=new d.Grid({columns:o,row:d.Row.extend({highlightColor:"#D9EDF7",disabledColor:"#F1F1F1",events:{click:"rowClick"},rowClick:function(e){i.frame_id=this.model.get("frame_id"),this.model.trigger("backgrid:row:selected",this),i.stack_grid.$el.find("td").css("background-color",this.disabledColor),this.$el.find("td").css("background-color",this.highlightColor)}}),collection:c,className:"backgrid table-bordered"});p.render(),g.DirectDebug.stack_pane_panel.$container.find(".stack_pane").append(p.el)},AddResults:function(e,t){var i=this;i.result_grid&&(i.result_grid.remove(),i.result_grid=null);var a=s.Model.extend({defaults:{name:void 0}}),o=s.Collection.extend({model:a}),l=[];n.size(e)&&n.each(e,function(e){var t={type:"text",editable:!1,cell:"string"};t.name=t.label=e.name,l.push(t)});var r=this.result_grid=new d.Grid({columns:l,collection:new o(t),className:"backgrid table-bordered"});r.render(),g.DirectDebug.results_panel.$container.find(".debug_results").append(r.el)},AddLocalVariables:function(t){var i=this;i.variable_grid&&(i.variable_grid.remove(),i.variable_grid=null);var n=s.Model.extend({defaults:{name:void 0,type:void 0,value:void 0}}),a=s.Collection.extend({model:n}),o=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"type",label:e("Type"),type:"text",editable:!1,cell:"string"},{name:"value",label:e("Value"),type:"text",cell:"string"}],l=[];if(0!=t.length)for(var r=0;r<t.length;r++)"L"==t[r].varclass&&l.push({name:t[r].name,type:t[r].dtype,value:t[r].value});var c=this.variable_grid=new d.Grid({columns:o,collection:new a(l),className:"backgrid table-bordered"});c.render(),g.DirectDebug.local_variables_panel.$container.find(".local_variables").append(c.el)},AddParameters:function(t){var i=this;i.param_grid&&(i.param_grid.remove(),i.param_grid=null);var n=s.Model.extend({defaults:{name:void 0,type:void 0,value:void 0}}),a=i.ParametersCollection=s.Collection.extend({model:n});i.ParametersCollection.prototype.on("change",i.deposit_parameter_value,i);var o=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"type",label:e("Type"),type:"text",editable:!1,cell:"string"},{name:"value",label:e("Value"),type:"text",cell:"string"}],l=[];if(0!=t.length)for(var r=0;r<t.length;r++)"A"==t[r].varclass&&l.push({name:t[r].name,type:t[r].dtype,value:t[r].value});var c=this.param_grid=new d.Grid({columns:o,collection:new a(l),className:"backgrid table-bordered"});c.render(),g.DirectDebug.parameters_panel.$container.find(".parameters").append(c.el)},deposit_parameter_value:function(n){var a=this,l=[];l.push({name:n.get("name"),type:n.get("type"),value:n.get("value")});var r=t("debugger.deposit_value",{trans_id:g.DirectDebug.trans_id});i.ajax({url:r,method:"POST",data:{data:JSON.stringify(l)},success:function(e){e.data.status&&(a.GetLocalVariables(g.DirectDebug.trans_id),e.data.result?o.success(e.data.info,3):o.error(e.data.info,3))},error:function(t){o.alert(e("Debugger Error"),e("Error while depositing variable value."))}})},select_frame:function(n,a){var l=this,r=t("debugger.select_frame",{trans_id:g.DirectDebug.trans_id,frame_id:l.frame_id});i.ajax({url:r,method:"GET",success:function(e){e.data.status&&(g.DirectDebug.editor.setValue(e.data.result[0].src),l.UpdateBreakpoint(g.DirectDebug.trans_id),g.DirectDebug.editor.addLineClass(e.data.result[0].linenumber-2,"wrap","CodeMirror-activeline-background"),l.GetLocalVariables(g.DirectDebug.trans_id))},error:function(t){o.alert(e("Debugger Error"),e("Error while selecting frame."))}})}});var b=s.View.extend({el:"#btn-toolbar",initialize:function(){h.on("pgDebugger:button:state:stop",this.enable_stop,this),h.on("pgDebugger:button:state:step_over",this.enable_step_over,this),h.on("pgDebugger:button:state:step_into",this.enable_step_into,this),h.on("pgDebugger:button:state:continue",this.enable_continue,this),h.on("pgDebugger:button:state:toggle_breakpoint",this.enable_toggle_breakpoint,this),h.on("pgDebugger:button:state:clear_all_breakpoints",this.enable_clear_all_breakpoints,this)},events:{"click .btn-stop":"on_stop","click .btn-clear-breakpoint":"on_clear_all_breakpoint","click .btn-toggle-breakpoint":"on_toggle_breakpoint","click .btn-continue":"on_continue","click .btn-step-over":"on_step_over","click .btn-step-into":"on_step_into"},enable_stop:function(e){var t=this.$el.find(".btn-stop");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_step_over:function(e){var t=this.$el.find(".btn-step-over");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_step_into:function(e){var t=this.$el.find(".btn-step-into");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_continue:function(e){var t=this.$el.find(".btn-continue");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_toggle_breakpoint:function(e){var t=this.$el.find(".btn-toggle-breakpoint");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_clear_all_breakpoints:function(e){var t=this.$el.find(".btn-clear-breakpoint");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},on_stop:function(){h.Stop(g.DirectDebug.trans_id)},on_clear_all_breakpoint:function(){h.clear_all_breakpoint(g.DirectDebug.trans_id)},on_toggle_breakpoint:function(){h.toggle_breakpoint(g.DirectDebug.trans_id)},on_continue:function(){h.Continue(g.DirectDebug.trans_id)},on_step_over:function(){h.Step_over(g.DirectDebug.trans_id)},on_step_into:function(){h.Step_into(g.DirectDebug.trans_id)}}),f=function(){};return n.extend(f.prototype,{init:function(a,l){var r=this;if(n.bindAll(g.DirectDebug,"messages"),!this.initialized){this.initialized=!0,this.trans_id=a,this.debug_type=l,this.first_time_indirect_debug=!1,this.direct_execution_completed=!1,this.polling_timeout_idle=!1,this.debug_restarted=!1,this.is_user_aborted_debugging=!1,this.is_polling_required=!0;this.docker=new wcDocker("#container",{allowContextMenu:!1,allowCollapse:!1,themePath:t("static",{filename:"css"}),theme:"webcabin.overrides.css"});if(this.panels=[],void 0==a||l)if(void 0!=a&&l){var s=t("debugger.start_listener",{trans_id:a});i.ajax({url:s,method:"GET",success:function(e){e.data.status&&r.messages(a)},error:function(t){o.alert(e("Debugger Error"),e("Error while starting debugging listener."))}})}else this.intializePanels();else{var s=t("debugger.start_listener",{trans_id:a});i.ajax({url:s,method:"GET",success:function(e){e.data.status&&(r.intializePanels(),h.poll_result(a))},error:function(t){o.alert(e("Debugger Error"),e("Error while starting debugging listener."))}})}}},messages:function(n){var a=this,l=t("debugger.messages",{trans_id:n});i.ajax({url:l,method:"GET",success:function(t){"Success"===t.data.status?(a.intializePanels(),h.start_execution(n,t.data.result)):"Busy"===t.data.status?a.messages(n):"NotConnected"===t.data.status&&o.alert(e("Not connected to server or connection with the server has been closed."),t.data.result)},error:function(t){o.alert(e("Debugger Error"),e("Error while fetching messages information."))}})},onBreakPoint:function(e,t,i){var n=this;if("breakpoints"==i&&!g.DirectDebug.polling_timeout_idle){var a=e.lineInfo(t);void 0==a.gutterMarkers?h.set_breakpoint(n.trans_id,t+1,1):void 0==a.gutterMarkers.breakpoints?h.set_breakpoint(n.trans_id,t+1,1):h.set_breakpoint(n.trans_id,t+1,0);var o=a.gutterMarkers;void 0!=o&&void 0==a.gutterMarkers.breakpoints&&(o=a.gutterMarkers.breakpoints),e.setGutterMarker(t,"breakpoints",o?null:function(){var e=document.createElement("div");return e.style.color="#822",e.innerHTML="●",e}())}},intializePanels:function(){var t=this;this.registerPanel("code",!1,"100%","50%",function(i){var n=new l.Browser.Panel({name:"parameters",title:e("Parameters"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="parameters" class="parameters"></div>'}),a=new l.Browser.Panel({name:"local_variables",title:e("Local variables"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="local_variables" class="local_variables"></div>'}),o=new l.Browser.Panel({name:"messages",title:e("Messages"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id="messages" class="messages"></div>'}),r=new l.Browser.Panel({name:"results",title:e("Results"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id="debug_results" class="debug_results"></div>'}),s=new l.Browser.Panel({name:"stack_pane",title:e("Stack"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id="stack_pane" class="stack_pane"></div>'});n.load(t.docker),a.load(t.docker),o.load(t.docker),r.load(t.docker),s.load(t.docker)}),t.code_editor_panel=t.docker.addPanel("code",wcDocker.DOCK.TOP),t.parameters_panel=t.docker.addPanel("parameters",wcDocker.DOCK.BOTTOM,t.code_editor_panel),t.local_variables_panel=t.docker.addPanel("local_variables",wcDocker.DOCK.STACKED,t.parameters_panel,{tabOrientation:wcDocker.TAB.TOP}),t.messages_panel=t.docker.addPanel("messages",wcDocker.DOCK.STACKED,t.parameters_panel),t.results_panel=t.docker.addPanel("results",wcDocker.DOCK.STACKED,t.parameters_panel),t.stack_pane_panel=t.docker.addPanel("stack_pane",wcDocker.DOCK.STACKED,t.parameters_panel);var n=i('<div id="stack_editor_pane" class="full-container-pane info"></div>'),a=i('<textarea id="debugger-editor-textarea"></textarea>').append(n);t.code_editor_panel.layout().addItem(a);var o=(t.editor=m.fromTextArea(a.get(0),{lineNumbers:!0,foldOptions:{widget:"…"},foldGutter:{rangeFinder:m.fold.combine(m.pgadminBeginRangeFinder,m.pgadminIfRangeFinder,m.pgadminLoopRangeFinder,m.pgadminCaseRangeFinder)},gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","breakpoints"],mode:"text/x-pgsql",readOnly:!0,extraKeys:l.Browser.editor_shortcut_keys,indentWithTabs:l.Browser.editor_options.indent_with_tabs,indentUnit:l.Browser.editor_options.tabSize,tabSize:l.Browser.editor_options.tabSize,lineWrapping:l.Browser.editor_options.wrapCode,autoCloseBrackets:l.Browser.editor_options.insert_pair_brackets,matchBrackets:l.Browser.editor_options.brace_matching}),function(){t.docker.finishLoading(100),t.docker.off(wcDocker.EVENT.LOADED),t.editor.on("gutterClick",t.onBreakPoint.bind(t),t)});t.docker.startLoading(e("Loading...")),t.docker.on(wcDocker.EVENT.LOADED,o),this.toolbarView=new b},registerPanel:function(e,t,n,a,o){var l=this;this.docker.registerPanelType(e,{title:t,isPrivate:!0,onCreate:function(r){l.panels[e]=r,r.initSize(n,a),t?r.title(t):r.title(!1),r.closeable(!1),r.layout().addItem(i("<div>",{class:"pg-debugger-panel"})),o&&o.apply(l,[r])}})}}),g.DirectDebug=new f,g.DirectDebug.jquery=i,g.DirectDebug}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(0)],void 0!==(a=function(e){return{epicRandomString:function(e){for(var t=[],i="0123456789abcdef",n=0;n<36;n++)t[n]=i.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=i.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("").replace(/-/g,"").substr(0,e)},getHash:function(e){for(var t=0,i=e.length,n=0;n<i;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t},calculateColumnWidth:function(t){e("body").append('<span id="pg_text" style="visibility: hidden;">'+t+"</span>");var i=e("#pg_text").width()+23;return e("#pg_text").remove(),i},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}}.apply(t,n))&&(e.exports=a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(269),i(189),i(15),i(21)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c){if(!r.Nodes.server){var p=function(t,n,o,l,s){var d=s||n.connected,p=function(t,i,a,l,r,s,d,p){n.connected=!1,p||(o.setInode(d),o.addIcon(d,{icon:"icon-server-not-connected"})),c.pgNotifier("error",t,a,function(t){setTimeout(function(){c.dlgServerPass(e("Connect to Server"),t,l,r,s,d,p).resizeTo()},100)})},u=function(e,i,n,o,l,s){if(e&&e.data){"string"==typeof e.data.icon&&(o.removeIcon(l),n.icon=e.data.icon,o.addIcon(l,{icon:n.icon})),a.extend(n,e.data),n.is_connecting=!1;(r.serverInfo=r.serverInfo||{})[n._id]=a.extend({},n),c.success(e.info),t.trigger("connected",t,l,n),r.Events.trigger("pgadmin:server:connected",n._id,l,n),r.Events.trigger("pgadmin:database:connected",n._id,n.db,l,n),s?setTimeout(function(){i.callbacks.refresh.apply(i,[!0])},10):(o.setInode(l),o.deselect(l),setTimeout(function(){o.select(l),o.open(l)},10))}};c.dlgServerPass||c.dialog("dlgServerPass",function(){return{main:function(e,t,i,n,a,o,l,r,s,d){this.set("title",e),this.message=t,this.tree=a,this.nodeData=n,this.nodeItem=o,this.node=i,this.connected=l,this.onSuccess=r||u,this.onFailure=s||p,this.onCancel=d||m},setup:function(){return{buttons:[{text:e("OK"),key:13,className:"btn btn-primary"},{text:e("Cancel"),className:"btn btn-danger"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},prepare:function(){this.setContent(this.message)},callback:function(t){var n=this.tree,a=this.nodeItem,o=this.node,l=this.nodeData,r=this.connected,s=this.onSuccess,d=this.onFailure;this.onCancel;if(t.button.text==e("OK")){var c=o.generate_url(a,"connect",l,!0);r||(n.setLeaf(a),n.removeIcon(a),n.addIcon(a,{icon:"icon-server-connecting"})),i.ajax({type:"POST",timeout:3e4,url:c,data:i("#frmPassword").serialize(),success:function(e){return s(e,o,l,n,a,r)},error:function(e,t,i){return d(e,t,i,o,l,n,a,r)}})}else this.onCancel&&"function"==typeof this.onCancel&&this.onCancel(n,a,l,r)}}});var m=function(e,i,a,o){a.is_connecting=!1,e.unload(i),e.setInode(i),e.removeIcon(i),e.addIcon(i,{icon:"icon-server-not-connected"}),t.trigger("connect:cancelled",n._id,n.db,t,i,a),r.Events.trigger("pgadmin:server:connect:cancelled",n._id,i,a,t),r.Events.trigger("pgadmin:database:connect:cancelled",n._id,n.db,i,a,t),o&&e.select(i)};n.is_connecting=!0;var g=t.generate_url(l,"connect",n,!0);i.post(g).done(function(e){if(1==e.success)return u(e,t,n,o,l,d)}).fail(function(e,i,a){return p(e,0,a,t,n,o,l,d)})},u=["prefer","require","verify-ca","verify-full"];r.SecLabelModel=r.Node.Model.extend({defaults:{provider:void 0,label:void 0},schema:[{id:"provider",label:e("Provider"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"label",label:e("Security Label"),type:"text",editable:!0,cellHeaderClasses:"override_label_class_font_size"}],validate:function(){var t=null;return this.errorModel.clear(),a.isUndefined(this.get("label"))||a.isNull(this.get("label"))||""==String(this.get("label")).replace(/^\s+|\s+$/g,"")?(t=e("Label must be specified."),this.errorModel.set("label",t),t):null}});l.Browser.Nodes.server=l.Browser.Node.extend({parent_type:"server_group",type:"server",dialogHelp:t("help.static",{filename:"server_dialog.html"}),label:e("Server"),canDrop:!0,hasStatistics:!0,hasCollectiveStatistics:!0,can_expand:function(e){return e&&e.connected},Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_server_on_sg",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"create_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:3,label:e("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"connect_server",node:"server",module:this,applies:["object","context"],callback:"connect_server",category:"connect",priority:4,label:e("Connect Server"),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_server",node:"server",module:this,applies:["object","context"],callback:"disconnect_server",category:"drop",priority:5,label:e("Disconnect Server"),icon:"fa fa-chain-broken",enable:"is_connected"},{name:"reload_configuration",node:"server",module:this,applies:["tools","context"],callback:"reload_configuration",category:"reload",priority:6,label:e("Reload Configuration"),icon:"fa fa-repeat",enable:"enable_reload_config"},{name:"restore_point",node:"server",module:this,applies:["tools","context"],callback:"restore_point",category:"restore",priority:9,label:e("Add Named Restore Point..."),icon:"fa fa-anchor",enable:"is_applicable"},{name:"change_password",node:"server",module:this,applies:["file"],callback:"change_password",label:e("Change Password..."),icon:"fa fa-lock",enable:"is_connected"},{name:"wal_replay_pause",node:"server",module:this,applies:["tools","context"],callback:"pause_wal_replay",category:"wal_replay_pause",priority:7,label:e("Pause Replay of WAL"),icon:"fa fa-pause-circle",enable:"wal_pause_enabled"},{name:"wal_replay_resume",node:"server",module:this,applies:["tools","context"],callback:"resume_wal_replay",category:"wal_replay_resume",priority:8,label:e("Resume Replay of WAL"),icon:"fa fa-play-circle",enable:"wal_resume_enabled"}]),a.bindAll(this,"connection_lost"),r.Events.on("pgadmin:server:connection:lost",this.connection_lost))},is_not_connected:function(e){return e&&1!=e.connected},is_connected:function(e){return e&&1==e.connected},enable_reload_config:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser)},is_applicable:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&0==e.in_recovery)},wal_pause_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&0==e.wal_pause)},wal_resume_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&1==e.wal_pause)},callbacks:{connect_server:function(e){var t=e||{},i=this,n=r.tree,a=t.item||n.selected(),o=a&&1==a.length?n.itemData(a):void 0;return!!o&&(p(i,o,n,a,!1),!1)},disconnect_server:function(t,n){var o=t||{},l=this,s=r.tree,d="item"in o?o.item:s.selected(),p=d&&1==d.length?s.itemData(d):void 0;if(!p)return!1;n=n||a.isUndefined(n)||a.isNull(n);var u=function(){i.ajax({url:l.generate_url(d,"connect",p,!0),type:"DELETE",success:function(e){if(1==e.success)c.success(e.info),p=s.itemData(d),s.removeIcon(d),p.connected=!1,p.icon="icon-server-not-connected",s.addIcon(d,{icon:p.icon}),l.callbacks.refresh.apply(l,[null,d]),r.serverInfo&&p._id in r.serverInfo&&delete r.serverInfo[p._id],r.enable_disable_menus(d),r.Events.trigger("pgadmin:server:disconnect",{item:d,data:p},!1);else{try{c.error(e.errormsg)}catch(e){}s.unload(d)}},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}s.unload(d)}})};return n?c.confirm(e("Disconnect server"),e("Are you sure you want to disconnect the server %(server)s?",{server:p.label}),function(e){u()},function(e){return!0}):u(),!1},beforeopen:function(e,t){return!(!t||"server"!=t._type)&&(r.tree.addIcon(e,{icon:t.icon}),!!t.connected||(p(this,t,r.tree,e,!1),!1))},added:function(e,t){return r.serverInfo=r.serverInfo||{},r.serverInfo[t._id]=a.extend({},t),l.Browser.Node.callbacks.added.apply(this,arguments),!0},reload_configuration:function(t){var n=t||{},a=this,l=r.tree,s=n.item||l.selected(),d=s&&1==s.length?l.itemData(s):void 0;return!!d&&(c.confirm(e("Reload server configuration"),o(e("Are you sure you want to reload the server configuration on %s?")).sprintf(d.label).value(),function(e){i.ajax({url:a.generate_url(s,"reload",d,!0),method:"GET",success:function(e){e.data.status?c.success(e.data.result):c.error(e.data.result)},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}l.unload(s)}})},function(e){return!0}),!1)},restore_point:function(t){var n=t||{},o=this,l=r.tree,s=n.item||l.selected(),d=s&&1==s.length?l.itemData(s):void 0;if(!d)return!1;c.prompt(e("Enter the name of the restore point to add"),"",function(t,n){a.isUndefined(n)||a.isNull(n)||""===n||""===String(n).replace(/^\s+|\s+$/g,"")?(t.cancel=!0,c.error(e("Please enter a valid name."),10)):i.ajax({url:o.generate_url(s,"restore_point",d,!0),method:"POST",data:{value:JSON.stringify(n)},success:function(e){c.success(e.data.result,10)},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg,10)}catch(e){}l.unload(s)}})},function(e,t){e.cancel=!1}).set({title:"Restore point name"})},change_password:function(t){var o=t||{},l=this,s=r.tree,d=o.item||s.selected(),p=d&&1==d.length?s.itemData(d):void 0,u=(p&&r.Nodes[p._type],l.generate_url(d,"change_password",p,!0)),m=!1,g=l.generate_url(d,"check_pgpass",p,!0);if(!p)return!1;if(!c.changeServerPassword){var h=n.Model.extend({defaults:{user_name:void 0,password:void 0,newPassword:void 0,confirmPassword:void 0},validate:function(){return null}}),b=[{name:"user_name",label:e("User"),type:"text",disabled:!0,control:"input"},{name:"password",label:e("Current Password"),type:"password",disabled:function(){return m},control:"input",required:!0},{name:"newPassword",label:e("New Password"),type:"password",disabled:!1,control:"input",required:!0},{name:"confirmPassword",label:e("Confirm Password"),type:"password",disabled:!1,control:"input",required:!0}];c.dialog("changeServerPassword",function(){return{main:function(t){var i=e("Change Password ");this.set("title",i),this.user_name=t.user.name},setup:function(){return{buttons:[{text:e("Ok"),key:13,className:"btn btn-primary",attrs:{name:"submit"}},{text:e("Cancel"),key:27,className:"btn btn-danger",attrs:{name:"cancel"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this;this.__internal.buttons[0].element.disabled=!0;var n=i("<div class='change_password'></div>"),o=new h({user_name:t.user_name});(this.view=new Backform.Form({el:n,model:o,fields:b})).render(),this.elements.content.appendChild(n.get(0)),this.view.model.on("change",function(){var i=this,n=this.get("password"),o=this.get("newPassword"),l=this.get("confirmPassword");!m&&(a.isUndefined(n)||a.isNull(n)||""==n)||a.isUndefined(o)||a.isNull(o)||""==o||a.isUndefined(l)||a.isNull(l)||""==l?t.__internal.buttons[0].element.disabled=!0:o!=l?(t.__internal.buttons[0].element.disabled=!0,this.errorTimeout&&clearTimeout(this.errorTimeout),this.errorTimeout=setTimeout(function(){i.errorModel.set("confirmPassword",e("Passwords do not match."))},400)):(i.errorModel.clear(),t.__internal.buttons[0].element.disabled=!1)})},callback:function(t){if("submit"==t.button.element.name){var n=this,a=this.view.model.toJSON();t.cancel=!0,i.ajax({url:u,method:"POST",data:{data:JSON.stringify(a)},success:function(t){t.success?(m&&c.alert(e("Change Password"),e("Please make sure to disconnect the server and update the new password in the pgpass file before performing any other operation")),c.success(t.info),n.close()):c.error(t.errormsg)},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}}})}}}})}return i.ajax({url:g,method:"GET",success:function(e){e.success&&e.data.is_pgpass&&(m=!0),c.changeServerPassword(p).resizeTo("40%","52%")},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}}}),!1},pause_wal_replay:function(e){var t=e||{},n=this,a=r.tree,l=t.item||a.selected(),s=l&&1==l.length?a.itemData(l):void 0;if(!s)return!1;i.ajax({url:n.generate_url(l,"wal_replay",s,!0),type:"DELETE",dataType:"json",success:function(e){1==e.success&&(c.success(e.info),a.itemData(l).wal_pause=e.data.wal_pause,a.unload(l),a.setInode(l),a.deselect(l),setTimeout(function(){a.select(l)},10))},error:function(e,t,n){try{var r=i.parseJSON(e.responseText);0==r.success&&(msg=o(r.errormsg).value(),c.error(r.errormsg))}catch(e){}a.unload(l)}})},resume_wal_replay:function(e){var t=e||{},n=this,a=r.tree,l=t.item||a.selected(),s=l&&1==l.length?a.itemData(l):void 0;if(!s)return!1;i.ajax({url:n.generate_url(l,"wal_replay",s,!0),type:"PUT",dataType:"json",success:function(e){1==e.success&&(c.success(e.info),a.itemData(l).wal_pause=e.data.wal_pause,a.unload(l),a.setInode(l),a.deselect(l),setTimeout(function(){a.select(l)},10))},error:function(e,t,n){try{var r=i.parseJSON(e.responseText);0==r.success&&(msg=o(r.errormsg).value(),c.error(r.errormsg))}catch(e){}a.unload(l)}})}},model:l.Browser.Node.Model.extend({defaults:{gid:void 0,id:void 0,name:"",sslmode:"prefer",host:"",hostaddr:"",port:5432,db:"postgres",username:d.name,role:null,connect_now:!0,password:void 0,save_password:!1,db_res:"",passfile:void 0,sslcompression:!1,sslcert:void 0,sslkey:void 0,sslrootcert:void 0,sslcrl:void 0},initialize:function(e,t){0===a.size(e)&&this.set({gid:t.node_info.server_group._id}),l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"id",label:e("ID"),type:"int",mode:["properties"]},{id:"name",label:e("Name"),type:"text",mode:["properties","edit","create"]},{id:"gid",label:e("Server group"),type:"int",control:"node-list-by-id",node:"server_group",mode:["create","edit"],select2:{allowClear:!1}},{id:"server_type",label:e("Server type"),type:"options",mode:["properties"],visible:"isConnected",options:s},{id:"connected",label:e("Connected?"),type:"switch",mode:["properties"],group:e("Connection"),options:{onText:e("True"),offText:e("False"),onColor:"success",offColor:"danger",size:"small"}},{id:"version",label:e("Version"),type:"text",group:null,mode:["properties"],visible:"isConnected"},{id:"bgcolor",label:e("Background"),type:"color",group:null,mode:["edit","create"],disabled:"isfgColorSet",deps:["fgcolor"]},{id:"fgcolor",label:e("Foreground"),type:"color",group:null,mode:["edit","create"],disabled:"isConnected"},{id:"connect_now",controlLabel:e("Connect now?"),type:"checkbox",group:null,mode:["create"]},{id:"comment",label:e("Comments"),type:"multiline",group:null,mode:["properties","edit","create"]},{id:"host",label:e("Host name/address"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"port",label:e("Port"),type:"int",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected",min:1024,max:65535},{id:"db",label:e("Maintenance database"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"username",label:e("Username"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"password",label:e("Password"),type:"password",group:e("Connection"),control:"input",mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()}},{id:"save_password",controlLabel:e("Save password?"),type:"checkbox",group:e("Connection"),mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(e){return!d.allow_save_password}},{id:"role",label:e("Role"),type:"text",group:e("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"sslmode",label:e("SSL mode"),type:"options",group:e("SSL"),mode:["properties","edit","create"],disabled:"isConnected",options:[{label:e("Allow"),value:"allow"},{label:e("Prefer"),value:"prefer"},{label:e("Require"),value:"require"},{label:e("Disable"),value:"disable"},{label:e("Verify-CA"),value:"verify-ca"},{label:e("Verify-Full"),value:"verify-full"}]},{id:"sslcert",label:e("Client certificate"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:Backform.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslkey",label:e("Client certificate key"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:Backform.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslrootcert",label:e("Root certificate"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:Backform.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcrl",label:e("Certificate revocation list"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",control:Backform.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcompression",label:e("SSL compression?"),type:"switch",mode:["edit","create"],group:e("SSL"),options:{onText:e("True"),offText:e("False"),onColor:"success",offColor:"danger",size:"small"},deps:["sslmode"],disabled:"isSSL"},{id:"sslcert",label:e("Client certificate"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcert");return!a.isUndefined(t)&&!a.isNull(t)}},{id:"sslkey",label:e("Client certificate key"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslkey");return!a.isUndefined(t)&&!a.isNull(t)}},{id:"sslrootcert",label:e("Root certificate"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslrootcert");return!a.isUndefined(t)&&!a.isNull(t)}},{id:"sslcrl",label:e("Certificate revocation list"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcrl");return!a.isUndefined(t)&&!a.isNull(t)}},{id:"sslcompression",label:e("SSL compression?"),type:"switch",mode:["properties"],group:e("SSL"),options:{onText:e("True"),offText:e("False"),onColor:"success",offColor:"danger",size:"small"},deps:["sslmode"],visible:function(e){var t=e.get("sslmode");return-1!=a.indexOf(u,t)}},{id:"hostaddr",label:e("Host address"),type:"text",group:e("Advanced"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"db_res",label:e("DB restriction"),type:"select2",group:e("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",select2:{multiple:!0,allowClear:!1,tags:!0,tokenSeparators:[","],first_empty:!1,selectOnClose:!0,emptyOptions:!0}},{id:"passfile",label:e("Password file"),type:"text",group:e("Advanced"),mode:["edit","create"],disabled:"isConnectedWithValidLib",control:Backform.FileControl,dialog_type:"select_file",supp_types:["*"]},{id:"passfile",label:e("Password file"),type:"text",group:e("Advanced"),mode:["properties"],visible:function(e){var t=e.get("passfile");return!a.isUndefined(t)&&!a.isNull(t)}}],validate:function(){var t,i={},n=this,o=function(e,o){var l=n.get(e);return a.isUndefined(l)||null===l||""==String(l).replace(/^\s+|\s+$/g,"")?(i[e]=o,t=t||o,!0):(n.errorModel.unset(e),!1)},l=function(e){var t=["^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|","(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|","2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|","(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|",":((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|","(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|","2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|","(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|","[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|","((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|","(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|","1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|","((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$"];return new RegExp(t.join("")).test(e.trim())};return!n.isNew()&&"id"in n.sessAttrs?(i.id=e("The ID cannot be changed."),t=i.id):n.errorModel.unset("id"),o("name",e("Name must be specified.")),o("host",e("Either Host name or Host address must be specified."))&&o("hostaddr",e("Either Host name or Host address must be specified."))?t=t||e("Either Host name or Host address must be specified"):(t=void 0,delete i.host,delete i.hostaddr),o("db",e("Maintenance database must be specified.")),o("username",e("Username must be specified.")),o("port",e("Port must be specified.")),function(e,a){var o=new RegExp("(^\\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\\s*$)"),r=n.get(e);r&&!o.test(r.trim())?l(r)||(i[e]=a,t=a):n.errorModel.unset(e)}("hostaddr",e("Host address must be valid IPv4 or IPv6 address.")),this.errorModel.set(i),a.size(i)?t:null},isConnected:function(e){return e.get("connected")},isfgColorSet:function(e){var t=e.get("bgcolor"),i=e.get("fgcolor");return!!e.get("connected")||((a.isUndefined(t)||a.isNull(t)||!t)&&i&&e.set("bgcolor","#ffffff"),!1)},isSSL:function(e){var t=e.get("sslmode");return!!e.get("connected")||-1==a.indexOf(u,t)},isConnectedWithValidLib:function(e){return!!e.get("connected")||r.utils.pg_libpq_version<1e5}}),connection_lost:function(t,i){if(r.tree){for(var n=r.tree,o=(t&&this.getTreeNodeHierarchy(t),t&&n.itemData(t)),l=this;o&&"server"!=o._type;)t=n.parent(t),o=t&&n.itemData(t);if(t&&o&&"server"==o._type&&(a.isUndefined(o.is_connecting)||!o.is_connecting)){o.is_connecting=!0;var s=function e(t){o._id==t&&(o.is_connecting=!1,r.Events.off("pgadmin:server:connect:cancelled",e),r.Events.trigger("pgadmin:database:connect:cancelled",t,i.data.database||o.db),r.Events.trigger("pgadmin:server:disconnect",{item:_i,data:_d},!1))};r.Events.on("pgadmin:server:connect:cancelled",s),c.confirm(e("Connection lost"),e("Would you like to reconnect to the database?"),function(){p(l,o,n,t,!0)},function(){o.is_connecting=!1,n.unload(t),n.setInode(t),n.addIcon(t,{icon:"icon-database-not-connected"}),r.Events.trigger("pgadmin:server:connect:cancelled",t,o,l),n.select(t)})}}}})}return r.Nodes.server}.apply(t,a))&&(e.exports=o)}).call(t,i(10))},function(e,t){e.exports=l},,function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(o=function(e,t,i,a,o,l,r,s){if(!r.Nodes["coll-function"]){r.Nodes["coll-function"]=r.Collection.extend({node:"function",label:e("Functions"),type:"coll-function",columns:["name","funcowner","description"],hasStatistics:!0})}var d=r.Node.Model.extend({idAttribute:"argid",defaults:{argid:void 0,argtype:void 0,argmode:void 0,argname:void 0,argdefval:void 0},schema:[{id:"argid",visible:!1,type:"text",mode:["properties","edit","create"]},{id:"argtype",label:e("Data Type"),cell:"node-ajax-options",cellHeaderClasses:"width_percent_30",control:"node-ajax-options",type:"text",url:"get_types",editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!a.isUndefined(e.isNew)||e.isNew())},first_empty:!0},{id:"argmode",label:e("Mode"),type:"options",control:"node-ajax-options",cellHeaderClasses:"width_percent_20",options:[{label:"IN",value:"IN"},{label:"OUT",value:"OUT"},{label:"INOUT",value:"INOUT"},{label:"VARIADIC",value:"VARIADIC"}],editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!a.isUndefined(e.isNew)||e.isNew())}},{id:"argname",label:e("Argument Name"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_30"},{id:"argdefval",label:e("Default Value"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_20"}],toJSON:n.Model.prototype.toJSON,isInCatalog:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&!!(a.isUndefined(e.get("argmode"))||a.isUndefined(this.get("name"))||"argdefval"!=this.get("name")||"INOUT"!=e.get("argmode")&&"OUT"!=e.get("argmode"))},validate:function(){}});return r.Nodes.function||(r.Nodes.function=r.Node.extend({type:"function",sqlAlterHelp:"sql-alterfunction.html",sqlCreateHelp:"sql-createfunction.html",dialogHelp:t("help.static",{filename:"function_dialog.html"}),label:e("Function"),collection_type:"coll-function",hasSQL:!0,hasDepends:!0,hasStatistics:!0,hasScriptTypes:["create","select"],parent_type:["schema","catalog"],Init:function(t){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_function_on_coll",node:"coll-function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:r.Nodes.schema.canChildDrop,canDropCascade:r.Nodes.schema.canChildDrop,model:r.Node.Model.extend({initialize:function(e,t){if(0===a.size(e)){var i=t.node_info.schema._id;this.set({pronamespace:i},{silent:!0});var n=r.serverInfo[t.node_info.server._id].user;this.set({funcowner:n.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,proparallel:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,arguments:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",control:Backform.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:e("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:e("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:e("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:e("Return type"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_types",disabled:"isDisabled",first_empty:!0,mode:["create"],visible:"isVisible"},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:e("Language"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_languages",disabled:"isDisabled"},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["lanname"],control:Backform.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:e("Object file"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:e("Link symbol"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:e("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:e("Returns a set?"),type:"switch",disabled:"isDisabled",group:e("Options"),visible:"isVisible"},{id:"proisstrict",label:e("Strict?"),type:"switch",group:e("Options"),disabled:"isDisabled",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"prosecdef",label:e("Security of definer?"),group:e("Options"),type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:e("Window?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"proparallel",label:e("Parallel"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),options:[{label:"UNSAFE",value:"u"},{label:"RESTRICTED",value:"r"},{label:"SAFE",value:"s"}],disabled:"isDisabled",min_version:90600,select2:{allowClear:!1}},{id:"procost",label:e("Estimated cost"),group:e("Options"),cell:"string",type:"text",disabled:"isDisabled"},{id:"prorows",label:e("Estimated rows"),type:"text",deps:["proretset"],visible:"isVisible",disabled:"isDisabled",group:e("Options")},{id:"proleakproof",label:e("Leak proof?"),group:e("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled"},{id:"proacl",label:e("Privileges"),type:"text",mode:["properties"],group:e("Security")},{id:"arguments",label:e("Arguments"),cell:"string",group:e("Arguments"),type:"collection",canAdd:function(e){return e.isNew()},canDelete:!0,model:d,mode:["create","edit"],columns:["argtype","argmode","argname","argdefval"],disabled:"isDisabled",canDeleteRow:function(e){return e.isNew()}},{id:"variables",label:e("Parameters"),type:"collection",group:e("Parameters"),control:"variable-collection",model:r.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},r.SecurityGroupSchema,{id:"acl",label:e("Privileges"),editable:!1,model:r.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"isDisabled"},{id:"seclabels",label:e("Security Labels"),canAdd:!0,model:r.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canEdit:!1,canDelete:!0,uniqueCol:["provider"],disabled:"isDisabled",control:"unique-col-collection",visible:function(){return this.node&&"procedure"!=this.node.type}}],validate:function(){var t,i={},n=this.get("seclabels");if((a.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(a.isUndefined(this.get("funcowner"))||""==String(this.get("funcowner")).replace(/^\s+|\s+$/g,""))&&(i.funcowner=e("Owner cannot be empty."),t=t||i.funcowner),(a.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(i.pronamespace=e("Schema cannot be empty."),t=t||i.pronamespace),(a.isUndefined(this.get("prorettypename"))||""==String(this.get("prorettypename")).replace(/^\s+|\s+$/g,""))&&(i.prorettypename=e("Return type cannot be empty."),t=t||i.prorettypename),(a.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(i.lanname=e("Language cannot be empty."),t=t||i.lanname),"c"==String(this.get("lanname"))?((a.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(i.probin=e("Object File cannot be empty."),t=t||i.probin),(a.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(i.prosrc_c=e("Link Symbol cannot be empty."),t=t||i.prosrc_c)):(a.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(i.prosrc=e("Code cannot be empty."),t=t||i.prosrc),n)for(var o,l=0;l<n.models.length&&!o;l++)(o=n.models[l].validate.apply(n.models[l]))&&(i.seclabels=o,t=t||o);return this.errorModel.clear().set(i),a.size(i)?(this.trigger("on-status",{msg:t}),t):null},isVisible:function(e){return"sysproc"!=this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(name=this.name,name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();case"prorows":return 1!=e.get("proretset");default:return!1}return!1},canVarAdd:function(e){return!(this.node_info&&"catalog"in this.node_info)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=r.tree,o=t,l=e;o;){if(a.indexOf(["schema"],l._type)>-1)return!0;if("coll-function"==l._type){var s=n.hasParent(o)?n.parent(o):null;return"catalog"!=(s?n.itemData(s):null)._type}o=n.hasParent(o)?n.parent(o):null,l=o?n.itemData(o):null}return!0}})),r.Nodes.function}.apply(t,a))&&(e.exports=o)}).call(t,i(10))},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r){return l.Nodes["coll-edbfunc"]||(l.Nodes["coll-edbfunc"]=l.Collection.extend({node:"edbfunc",label:e("Functions"),type:"coll-edbfunc",columns:["name","funcowner","description"]})),l.Nodes.edbfunc||(l.Nodes.edbfunc=l.Node.extend({type:"edbfunc",dialogHelp:t("help.static",{filename:"edbfunc_dialog.html"}),label:e("Function"),collection_type:"coll-edbfunc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(e){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:l.Node.Model.extend({defaults:{name:void 0,oid:void 0,funcowner:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",prosrc:void 0,proacl:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:!0},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:!0},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),disabled:!0,mode:["properties"],visible:"isVisible"},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"lanname",label:e("Language"),cell:"string",type:"text",group:e("Definition"),disabled:!0},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),control:Backform.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:!0}],validate:function(){return null},isVisible:function(e){return"sysproc"!=this.name}})})),l.Nodes.edbfunc}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(13)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-rule"]){o.Browser.Nodes["coll-rule"]=o.Browser.Collection.extend({node:"rule",label:e("Rules"),type:"coll-rule",getTreeNodeHierarchy:l.tableChildTreeNodeHierarchy,columns:["name","owner","comment"]})}return l.Nodes.rule||(o.Browser.Nodes.rule=l.Node.extend({getTreeNodeHierarchy:l.tableChildTreeNodeHierarchy,parent_type:["table","view","partition"],type:"rule",sqlAlterHelp:"sql-alterrule.html",sqlCreateHelp:"sql-createrule.html",dialogHelp:t("help.static",{filename:"rule_dialog.html"}),label:e("rule"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,canDrop:function(e,t,i){return l.Nodes.schema.canChildDrop.apply(this,[e,t,i]),!n.has(e,"label")||"_RETURN"!==e.label},canDropCascade:function(e,t,i){return l.Nodes.schema.canChildDrop.apply(this,[e,t,i]),!n.has(e,"label")||"_RETURN"!==e.label},Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_rule_on_coll",node:"coll-rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({schema:[{id:"name",label:e("Name"),type:"text",disabled:function(e){return!(!e||"_RETURN"!=e.get("name"))||!e.isNew()&&!(e.node_info.server.version>=90400)}},{id:"oid",label:e("OID"),type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:"",type:"text",visible:!1,disabled:function(e){e.set("schema",e.node_info.schema.label)}},{id:"view",label:"",type:"text",visible:!1,disabled:function(e){e.set("view",this.node_data.label)}},{id:"event",label:e("Event"),control:"select2",group:e("Definition"),type:"text",select2:{width:"100%",allowClear:!1},options:[{label:"Select",value:"Select"},{label:"Insert",value:"Insert"},{label:"Update",value:"Update"},{label:"Delete",value:"Delete"}]},{id:"do_instead",label:e("Do Instead"),group:e("Definition"),type:"switch"},{id:"condition",label:e("Condition"),type:"text",group:e("Definition"),control:Backform.SqlFieldControl},{id:"statements",label:e("Commands"),type:"text",group:e("Definition"),control:Backform.SqlFieldControl},{id:"system_rule",label:e("System rule?"),type:"switch",mode:["properties"]},{id:"enabled",label:e("Enabled?"),type:"switch",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline"}],validate:function(){var t,i={},a=this.get("name");return n.isUndefined(a)||n.isNull(a)||""===String(a).replace(/^\s+|\s+$/g,"")?(i.name=e("Please specify name."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),null)}}),canCreate:function(e,t,i){if(i&&!1===i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-rule"==r._type){var s=a.hasParent(o)?a.parent(o):null,d=(s&&a.itemData(s),a.hasParent(s)?a.parent(s):null),c=d?a.itemData(d):null,p=a.hasParent(d)?a.parent(d):null;return"catalog"!=(p?a.itemData(p):null)._type}if("view"==r._type||"table"==r._type)return s=a.hasParent(o)?a.parent(o):null,s?a.itemData(s):null,d=a.hasParent(s)?a.parent(s):null,c=d?a.itemData(d):null,"schema"==c._type;o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes["coll-rule"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(0),i(1),i(6),i(17),i(11),i(9)],void 0!==(o=function(e,t,i,a,o,l){l.PartitionRow=l.Row.extend({modelDuplicateColor:"lightYellow",modelUniqueColor:"#fff",initialize:function(){l.Row.prototype.initialize.apply(this,arguments);var e=this;e.model.on("change:is_attach",function(){setTimeout(function(){e.columns.each(function(t){if("partition_name"==t.get("name")){var i=e.columns.indexOf(t),n=t.get("cellFunction"),a=new(n.apply(t,[e.model]))({column:t,model:e.model});e.cells[i].remove(),e.cells[i]=a,e.render()}})},10)}),e.listenTo(e.model,"pgadmin-session:model:duplicate",e.modelDuplicate),e.listenTo(e.model,"pgadmin-session:model:unique",e.modelUnique)},modelDuplicate:function(){t(this.el).removeClass("new"),this.el.style.backgroundColor=this.modelDuplicateColor},modelUnique:function(){this.el.style.backgroundColor=this.modelUniqueColor}});var r=function(e){if(e.get("is_attach")){var t=[];return e.set({partition_name:void 0},{silent:!0}),i.each(e.top.table_options,function(e){t.push([e.label,e.value])}),l.Extension.Select2Cell.extend({optionValues:t})}return l.StringCell};o.PartitionKeyModel=a.Node.Model.extend({defaults:{key_type:"column",pt_column:void 0,expression:void 0},keys:["pt_column"],schema:[{id:"key_type",label:e("Key type"),type:"select2",editable:!0,cell:"select2",cellHeaderClasses:"width_percent_25",select2:{allowClear:!1},options:[{label:e("Column"),value:"column"},{label:e("Expression"),value:"expression"}]},{id:"pt_column",label:e("Column"),type:"text",cell:l.Extension.Select2DepCell.extend({keyPathAccessor:function(e,t){var n=e;if(i.isArray(n))return i.map(n,function(e){return e.pt_column});t=t.split(".");for(var a=0;a<t.length;a++){if(i.isNull(n))return null;i.isEmpty(t[a])||(i.isUndefined(n[t[a]])||(n=n[t[a]]))}return i.isObject(n)&&!i.isArray(n)?null:n},initialize:function(){var e=this;if(this.model.handler){if(l.Extension.Select2DepCell.prototype.initialize.apply(this,arguments),i.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}},resetColOptions:function(e){var t=this;setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=this.model.top.get("typname"),n=this.model.top.of_types_tables,a=[];e.length>0?i.each(e.models,function(e){var t=e.get("name");i.isUndefined(t)||i.isNull(t)||a.push({label:t,value:t,image:"icon-column"})}):!i.isUndefined(t)&&!i.isNull(t)&&!i.isUndefined(n)&&n.length>0&&i.each(n,function(e){e.label==t&&i.each(e.oftype_columns,function(e){a.push({label:e.name,value:e.name,image:"icon-column"})})}),this.column.set("options",a)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),l.Extension.Select2DepCell.prototype.remove.apply(this,arguments)}}}),deps:["key_type"],cellHeaderClasses:"width_percent_30",transform:function(e){var t=[];return e&&i.isArray(e)&&i.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},editable:function(e){return"expression"!=e.get("key_type")||(setTimeout(function(){e.set("pt_column",void 0)},10),!1)}},{id:"expression",label:e("Expression"),type:"text",cell:l.Extension.StringDepCell,cellHeaderClasses:"width_percent_45",deps:["key_type"],editable:function(e){return"column"!=e.get("key_type")||(setTimeout(function(){e.set("expression",void 0)},10),!1)}}],validate:function(t){var n=this.get("key_type"),a=this.get("pt_column"),o=this.get("expression");if(this.errorModel.clear(),i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")){var l=e("Partition key type cannot be empty.");return this.errorModel.set("key_type",l),l}if("column"==n&&i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var l=e("Partition key column cannot be empty.");return this.errorModel.set("pt_column",l),l}if("expression"==n&&i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")){var l=e("Partition key expression cannot be empty.");return this.errorModel.set("expression",l),l}return null}}),o.PartitionsModel=a.Node.Model.extend({defaults:{oid:void 0,is_attach:!1,partition_name:void 0,values_from:void 0,values_to:void 0,values_in:void 0},keys:["partition_name"],schema:[{id:"oid",label:e("OID"),type:"text"},{id:"is_attach",label:e("Operation"),cell:"switch",type:"switch",options:{onText:e("Attach"),offText:e("Create")},cellHeaderClasses:"width_percent_5",editable:function(e){return!(!(e instanceof n.Model&&e.isNew())||e.top.isNew())}},{id:"partition_name",label:e("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_25",editable:function(e){return!!(e instanceof n.Model&&e.isNew())},cellFunction:r},{id:"values_from",label:e("From"),type:"text",cell:l.Extension.StringDepCell,cellHeaderClasses:"width_percent_20",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"==e.handler.top.attributes.partition_type&&e instanceof n.Model&&e.isNew())}},{id:"values_to",label:e("To"),type:"text",cell:l.Extension.StringDepCell,cellHeaderClasses:"width_percent_20",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"range"==e.handler.top.attributes.partition_type&&e instanceof n.Model&&e.isNew())}},{id:"values_in",label:e("In"),type:"text",cell:l.Extension.StringDepCell,cellHeaderClasses:"width_percent_25",editable:function(e){return!!(e.handler&&e.handler.top&&e.handler.top.attributes&&"list"==e.handler.top.attributes.partition_type&&e instanceof n.Model&&e.isNew())}}],validate:function(t){var n=this.get("partition_name"),a=this.get("values_from"),o=this.get("values_to"),l=this.get("values_in");if(this.errorModel.clear(),i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")){var r=e("Partition name cannot be empty.");return this.errorModel.set("partition_name",r),r}if("range"==this.top.get("partition_type")){if(i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var r=e("For range partition From field cannot be empty.");return this.errorModel.set("values_from",r),r}if(i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")){var r=e("For range partition To field cannot be empty.");return this.errorModel.set("values_to",r),r}}else if("list"==this.top.get("partition_type")&&(i.isUndefined(l)||i.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,""))){var r=e("For list partition In field cannot be empty.");return this.errorModel.set("values_in",r),r}return null}})}.apply(t,a))&&(e.exports=o)}).call(t,i(10))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";(function(n){var a,o;a=[i(182),i(3),i(230),i(265)],void 0!==(o=function(){var e=function(e){for(var t in e){var i=e[t];i.init&&"function"==typeof i.init?i.init():i.Init&&"function"==typeof i.Init&&i.Init()}};e(n),e(n.Browser),e(n.Tools),n.Browser.create_menus()}.apply(t,a))&&(e.exports=o)}).call(t,i(3))},function(e,t,i){"use strict";var n,a,o=o||{};o.about=i(231);var o=o||{};o.preferences=i(232);var o=o||{};o.file_manager=i(186);var o=o||{};o.settings=i(254);var o=o||{};o.tools={},o.tools.backup=i(255);var o=o||{};o.tools={},o.tools.restore=i(256);var o=o||{};o.tools={},o.tools.grant_wizard=i(257);var o=o||{};o.tools={},o.tools.maintenance=i(259);var o=o||{};o.tools={},o.tools.import_export=i(260);var o=o||{};o.tools={},o.tools.debugger={},o.tools.debugger.controller=i(261);var o=o||{};o.tools={},o.tools.debugger={},o.tools.debugger.direct=i(157);var o=o||{};o.node={},o.node.pga_job=i(262),n=[i(6)],void 0!==(a=function(e){e.init()}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(0),i(8),i(3),i(4),i(2),i(5)],void 0!==(a=function(e,t,i,n,a,o){if(i=i||window.pgAdmin||{},!i.About)return i.About={about_show:function(){t.aboutDialog||t.dialog("aboutDialog",function(){return{main:function(e,t){this.set("title",e),this.message=t},setup:function(){return{buttons:[{text:a("OK"),key:27,className:"btn btn-primary"}],options:{modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},build:function(){t.pgDialogBuild.apply(this)},prepare:function(){this.setContent(this.message)}}});e.get(o("about.index"),function(e){t.aboutDialog(n(a("About %s")).sprintf(i.Browser.utils.app_name).value(),e).resizeTo(800,450)})}},i.About}.apply(t,n))&&(e.exports=a)},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(15),i(6),i(10),i(11),i(17),i(30)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c,p){if(r.Backup)return r.Backup;var u=(c.CustomSwitchControl=c.SwitchControl.extend({template:a.template(['<label class="<%=Backform.controlLabelClassName%> custom_switch_label_class"><%=label%></label>','<div class="<%=Backform.controlsClassName%> custom_switch_control_class">','  <div class="checkbox">',"    <label>",'      <input type="checkbox" class="<%=extraClasses.join(\' \')%>"','        name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%>','        <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    </label>","  </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>"].join("\n")),className:"pgadmin-control-group form-group pg-el-md-6 pg-el-xs-12"}),s.Model.extend({idAttribute:"id",defaults:{file:void 0,role:void 0,dqoute:!1,verbose:!0,type:void 0},schema:[{id:"file",label:e("Filename"),type:"text",disabled:!1,control:c.FileControl,dialog_type:"create_file",supp_types:["*","sql","backup"]},{id:"role",label:e("Role name"),control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{type:"nested",control:"fieldset",label:e("Miscellaneous"),schema:[{id:"verbose",label:e("Verbose messages"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous")},{id:"dqoute",label:e("Force double quote on identifiers"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous")}]},{id:"server_note",label:e("Note"),text:e("The backup format will be PLAIN"),type:"note",visible:function(e){return"server"===e.get("type")}},{id:"globals_note",label:e("Note"),text:e("Only objects global to the entire database will be backed up in PLAIN format"),type:"note",visible:function(e){return"globals"===e.get("type")}},{}],validate:function(){return null}})),m=s.Model.extend({idAttribute:"id",defaults:{file:void 0,role:void 0,format:"custom",verbose:!0,blobs:!0,encoding:void 0,schemas:[],tables:[],database:void 0},schema:[{id:"file",label:e("Filename"),type:"text",disabled:!1,control:c.FileControl,dialog_type:"create_file",supp_types:["*","sql","backup"]},{id:"format",label:e("Format"),type:"text",disabled:!1,control:"select2",select2:{allowClear:!1,width:"100%"},options:[{label:e("Custom"),value:"custom"},{label:e("Tar"),value:"tar"},{label:e("Plain"),value:"plain"},{label:e("Directory"),value:"directory"}]},{id:"ratio",label:e("Compression ratio"),type:"int",min:0,max:9,disabled:!1},{id:"encoding",label:e("Encoding"),type:"text",disabled:!1,node:"database",control:"node-ajax-options",url:"get_encodings"},{id:"no_of_jobs",label:e("Number of jobs"),type:"int",deps:["format"],disabled:function(e){return!("Directory"===e.get("format"))}},{id:"role",label:e("Role name"),control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{type:"nested",control:"fieldset",label:e("Sections"),group:e("Dump options"),schema:[{id:"pre_data",label:e("Pre-data"),control:c.CustomSwitchControl,group:e("Sections"),deps:["only_data","only_schema"],disabled:function(e){return e.get("only_data")||e.get("only_schema")}},{id:"data",label:e("Data"),control:c.CustomSwitchControl,group:e("Sections"),deps:["only_data","only_schema"],disabled:function(e){return e.get("only_data")||e.get("only_schema")}},{id:"post_data",label:e("Post-data"),control:c.CustomSwitchControl,group:e("Sections"),deps:["only_data","only_schema"],disabled:function(e){return e.get("only_data")||e.get("only_schema")}}]},{type:"nested",control:"fieldset",label:e("Type of objects"),group:e("Dump options"),schema:[{id:"only_data",label:e("Only data"),control:c.CustomSwitchControl,group:e("Type of objects"),deps:["pre_data","data","post_data","only_schema"],disabled:function(e){return e.get("pre_data")||e.get("data")||e.get("post_data")||e.get("only_schema")}},{id:"only_schema",label:e("Only schema"),control:c.CustomSwitchControl,group:e("Type of objects"),deps:["pre_data","data","post_data","only_data"],disabled:function(e){return e.get("pre_data")||e.get("data")||e.get("post_data")||e.get("only_data")}},{id:"blobs",label:e("Blobs"),control:c.CustomSwitchControl,disabled:!1,group:e("Type of objects")}]},{type:"nested",control:"fieldset",label:e("Do not save"),group:e("Dump options"),schema:[{id:"dns_owner",label:e("Owner"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")},{id:"dns_privilege",label:e("Privilege"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")},{id:"dns_tablespace",label:e("Tablespace"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")},{id:"dns_unlogged_tbl_data",label:e("Unlogged table data"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")}]},{type:"nested",control:"fieldset",label:e("Queries"),group:e("Dump options"),schema:[{id:"use_column_inserts",label:e("Use Column Inserts"),control:c.CustomSwitchControl,disabled:!1,group:e("Queries")},{id:"use_insert_commands",label:e("Use Insert Commands"),control:c.CustomSwitchControl,disabled:!1,group:e("Queries")},{id:"include_create_database",label:e("Include CREATE DATABASE statement"),control:c.CustomSwitchControl,disabled:!1,group:e("Queries")},{id:"include_drop_database",label:e("Include DROP DATABASE statement"),control:c.CustomSwitchControl,disabled:!1,group:e("Queries")}]},{type:"nested",control:"fieldset",label:e("Disable"),group:e("Dump options"),schema:[{id:"disable_trigger",label:e("Trigger"),control:c.CustomSwitchControl,group:e("Disable"),deps:["only_data"],disabled:function(e){return!e.get("only_data")}},{id:"disable_quoting",label:e("$ quoting"),control:c.CustomSwitchControl,disabled:!1,group:e("Disable")}]},{type:"nested",control:"fieldset",label:e("Miscellaneous"),group:e("Dump options"),schema:[{id:"with_oids",label:e("With OID(s)"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous")},{id:"verbose",label:e("Verbose messages"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous")},{id:"dqoute",label:e("Force double quote on identifiers"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous")},{id:"use_set_session_auth",label:e("Use SET SESSION AUTHORIZATION"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous")}]}],validate:function(){return null}});return r.Backup={init:function(){if(!this.initialized){this.initialized=!0;for(var t=["database","schema","table","partition"],i=function(e,i,n){var o=r.tree,l=i,s=e,d=o.hasParent(l)?o.parent(l):null,c=d?o.itemData(d):null;return!(a.isUndefined(s)||a.isNull(s)||a.isNull(c))&&(-1!==a.indexOf(t,s._type)&&"catalog"!=c._type&&(!("database"!=s._type||!s.allowConn)||"database"!=s._type))},o=function(e,t,i){var n=r.tree,o=t,l=e,s=n.hasParent(o)?n.parent(o):null;s&&n.itemData(s);if(!a.isUndefined(l)&&!a.isNull(l))return"server"===l._type&&l.connected},l=[{name:"backup_global",module:this,applies:["tools"],callback:"start_backup_global",priority:12,label:e("Backup Globals..."),icon:"fa fa-floppy-o",enable:o},{name:"backup_server",module:this,applies:["tools"],callback:"start_backup_server",priority:12,label:e("Backup Server..."),icon:"fa fa-floppy-o",enable:o},{name:"backup_global_ctx",module:this,node:"server",applies:["context"],callback:"start_backup_global",priority:12,label:e("Backup Globals..."),icon:"fa fa-floppy-o",enable:o},{name:"backup_server_ctx",module:this,node:"server",applies:["context"],callback:"start_backup_server",priority:12,label:e("Backup Server..."),icon:"fa fa-floppy-o",enable:o},{name:"backup_object",module:this,applies:["tools"],callback:"backup_objects",priority:11,label:e("Backup..."),icon:"fa fa-floppy-o",enable:i}],s=0;s<t.length;s++)l.push({name:"backup_"+t[s],node:t[s],module:this,applies:["context"],callback:"backup_objects",priority:11,label:e("Backup..."),icon:"fa fa-floppy-o",enable:i});return n.Browser.add_menus(l),this}},start_backup_global:function(e,t){var i={globals:!0};this.start_backup_global_server.apply(this,[e,t,i])},start_backup_server:function(e,t){var i={server:!0};this.start_backup_global_server.apply(this,[e,t,i])},start_backup_global_server:function(n,s,d){for(var p=s||r.tree.selected(),m=null;p;){var g=r.tree.itemData(p);if("server"==g._type){m=g;break}if(!r.tree.hasParent(p)){l.alert(e("Backup Error"),e("Please select server or child node from the browser tree."));break}p=i(r.tree.parent(p))}if(m){var h="pg_bin_dir",b=e("Please configure the PostgreSQL Binary Path in the Preferences dialog.");(m.type&&"ppas"==m.type||"ppas"==m.server_type)&&(h="ppas_bin_dir",b=e("Please configure the EDB Advanced Server Binary Path in the Preferences dialog."));var f=r.get_preference("paths",h);if(!f)return void l.alert(e("Backup Error"),o(e("Failed to load preference %s of module %s")).sprintf(h,"paths").value());if(!f.value)return void l.alert(e("Configuration required"),b);var _=void 0;_=!a.isUndefined(d.globals)&&d.globals?"globals":"server";var v="BackupDialog_"+_,y=e("globals"==_?"Backup Globals...":"Backup Server...");l[v]||l.dialog(v,function(){return{main:function(e){this.set("title",e)},build:function(){l.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",className:"btn btn-default pull-left fa fa-lg fa-info",attrs:{name:"object_help",type:"button",url:"backup.html",label:e("Backup")}},{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Backup"),url:t("help.static",{filename:"backup_dialog.html"})}},{text:e("Backup"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button","data-btn-name":"backup"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button","data-btn-name":"cancel"}],options:{title:y,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this;this.__internal.buttons[2].element.disabled=!0;var n=i("<div class='backup_dialog'></div>"),o=r.tree,l=o.selected(),s=l&&1==l.length?o.itemData(l):void 0,d=s&&r.Nodes[s._type];if(s){var p=d.getTreeNodeHierarchy.apply(d,[l]),m=new u({type:_},{node_info:p}),g=c.generateViewSchema(p,m,"create",d,p.server,!0),h=this.view=new c.Dialog({el:n,model:m,schema:g});i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),h.render(),this.elements.content.appendChild(n.get(0)),this.view.model.on("change",function(){a.isUndefined(this.get("file"))||""===this.get("file")?(t.__internal.buttons[2].element.disabled=!0,this.errorModel.set("file",e("Please provide a filename"))):(this.errorModel.clear(),t.__internal.buttons[2].element.disabled=!1)})}},callback:function(n){var a=r.tree,o=a.selected(),s=o&&1==o.length?a.itemData(o):void 0,d=s&&r.Nodes[s._type];if("dialog_help"==n.button.element.name||"object_help"==n.button.element.name)return n.cancel=!0,void r.showHelp(n.button.element.name,n.button.element.getAttribute("url"),d,o,n.button.element.getAttribute("label"));if("backup"===n.button["data-btn-name"]){if(!s)return;var c=d.getTreeNodeHierarchy.apply(d,[o]),p=this,u=t("backup.create_server_job",{sid:c.server._id}),m=this.view.model.toJSON();i.ajax({url:u,method:"POST",data:{data:JSON.stringify(m)},success:function(t){t.success&&(l.success(e("Backup job created."),5),r.Events.trigger("pgadmin-bgprocess:created",p))},error:function(t,n,a){try{var o=i.parseJSON(t.responseText);l.alert(e("Backup job failed."),o.errormsg)}catch(e){}}})}}}}),l[v](!0).resizeTo("60%","50%")}},backup_objects:function(n,s){for(var d=s||r.tree.selected(),p=null;d;){var u=r.tree.itemData(d);if("server"==u._type){p=u;break}if(!r.tree.hasParent(d)){l.alert(e("Backup Error"),e("Please select server or child node from tree."));break}d=i(r.tree.parent(d))}if(p){var g="pg_bin_dir",h=e("Please set binary path for PostgreSQL Server from preferences.");(p.type&&"ppas"==p.type||"ppas"==p.server_type)&&(g="ppas_bin_dir",h=e("Please set binary path for EDB Postgres Advanced Server from preferences."));var b=r.get_preference("paths",g);if(!b)return void l.alert(e("Backup Error"),o(e("Failed to load preference %s of module %s")).sprintf(g,"paths").value());if(!b.value)return void l.alert(e("Configuration required"),h);var f=o(e("Backup (%s: %s)")),_=r.tree,v=s||_.selected(),y=v&&1==v.length&&_.itemData(v),w=y&&y._type&&r.Nodes[y._type];w&&(f=f.sprintf(w.label,y.label).value(),l.backup_objects||l.dialog("backup_objects",function(){return{main:function(e){this.set("title",e)},build:function(){l.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",className:"btn btn-default pull-left fa fa-lg fa-info",attrs:{name:"object_help",type:"button",url:"backup.html",label:e("Backup")}},{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Backup"),url:t("help.static",{filename:"backup_dialog.html"})}},{text:e("Backup"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button","data-btn-name":"backup"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button","data-btn-name":"cancel"}],options:{title:f,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this;this.__internal.buttons[2].element.disabled=!0;var n=i("<div class='backup_dialog'></div>"),o=r.tree,l=o.selected(),s=l&&1==l.length?o.itemData(l):void 0,d=s&&r.Nodes[s._type];if(s){var p=d.getTreeNodeHierarchy.apply(d,[l]),u=new m({},{node_info:p}),g=c.generateViewSchema(p,u,"create",d,p.server,!0),h=this.view=new c.Dialog({el:n,model:u,schema:g});i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),h.render(),this.elements.content.appendChild(n.get(0)),this.view.model.on("change",function(){a.isUndefined(this.get("file"))||""===this.get("file")?(t.__internal.buttons[2].element.disabled=!0,this.errorModel.set("file",e("Please provide filename"))):(this.errorModel.clear(),t.__internal.buttons[2].element.disabled=!1)})}},callback:function(n){var o=r.tree,s=o.selected(),d=s&&1==s.length?o.itemData(s):void 0,c=d&&r.Nodes[d._type];if("dialog_help"==n.button.element.name||"object_help"==n.button.element.name)return n.cancel=!0,void r.showHelp(n.button.element.name,n.button.element.getAttribute("url"),c,s,n.button.element.getAttribute("label"));if("backup"===n.button["data-btn-name"]){if(!d)return;var p=c.getTreeNodeHierarchy.apply(c,[s]);if(this.view.model.set("database",p.database._label),"schema"==d._type){var u=[];u.push(d._label),this.view.model.set("schemas",u)}"table"==d._type&&this.view.model.set("tables",[[p.schema._label,d._label]]),a.isEmpty(this.view.model.get("ratio"))&&this.view.model.unset("ratio");var m=this,g=t("backup.create_object_job",{sid:p.server._id}),h=this.view.model.toJSON();i.ajax({url:g,method:"POST",data:{data:JSON.stringify(h)},success:function(t){t.success&&(l.success(e("Backup job created."),5),r.Events.trigger("pgadmin-bgprocess:created",m))},error:function(t,n,a){try{var o=i.parseJSON(t.responseText);l.alert(e("Backup job failed."),o.errormsg)}catch(e){}}})}}}}),l.backup_objects(f).resizeTo("65%","60%"))}}},r.Backup}.apply(t,a))&&(e.exports=o)}).call(t,i(3))},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(15),i(6),i(10),i(11),i(17),i(30)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c,p){if(r.Restore)return r.Restore;var u=(c.CustomSwitchControl=c.SwitchControl.extend({template:a.template(['<label class="<%=Backform.controlLabelClassName%> custom_switch_label_class"><%=label%></label>','<div class="<%=Backform.controlsClassName%> custom_switch_control_class">','  <div class="checkbox">',"    <label>",'      <input type="checkbox" class="<%=extraClasses.join(\' \')%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    </label>","  </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>"].join("\n")),className:"pgadmin-control-group form-group pg-el-xs-4"}),s.Model.extend({idAttribute:"id",defaults:{custom:!1,file:void 0,role:void 0,format:"custom",verbose:!0,blobs:!0,encoding:void 0,database:void 0,schemas:void 0,tables:void 0,functions:void 0,triggers:void 0,trigger_funcs:void 0,indexes:void 0},initialize:function(e,t){var i=e.node_data.type;i&&("function"!==i&&"index"!==i&&"trigger"!==i||this.set({only_schema:!0},{silent:!0}),"table"===i&&this.set({only_data:!0},{silent:!0}),"function"!==i&&"trigger_function"!==i||this.set({clean:!0},{silent:!0})),s.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"format",label:e("Format"),type:"text",disabled:!1,control:"select2",select2:{allowClear:!1,width:"100%"},options:[{label:e("Custom or tar"),value:"custom"},{label:e("Directory"),value:"directory"}]},{id:"file",label:e("Filename"),type:"text",disabled:!1,control:c.FileControl,dialog_type:"select_file",supp_types:["*","backup","sql","patch"]},{id:"no_of_jobs",label:e("Number of jobs"),type:"int"},{id:"role",label:e("Role name"),control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{type:"nested",control:"fieldset",label:e("Sections"),group:e("Restore options"),schema:[{id:"pre_data",label:e("Pre-data"),control:c.CustomSwitchControl,group:e("Sections"),deps:["only_data","only_schema"],disabled:function(e){return"function"!==this.node.type&&"table"!==this.node.type&&"trigger"!==this.node.type&&"trigger_function"!==this.node.type&&(e.get("only_data")||e.get("only_schema"))}},{id:"data",label:e("Data"),control:c.CustomSwitchControl,group:e("Sections"),deps:["only_data","only_schema"],disabled:function(e){return"function"!==this.node.type&&"table"!==this.node.type&&"trigger"!==this.node.type&&"trigger_function"!==this.node.type&&(e.get("only_data")||e.get("only_schema"))}},{id:"post_data",label:e("Post-data"),control:c.CustomSwitchControl,group:e("Sections"),deps:["only_data","only_schema"],disabled:function(e){return"function"!==this.node.type&&"table"!==this.node.type&&"trigger"!==this.node.type&&"trigger_function"!==this.node.type&&(e.get("only_data")||e.get("only_schema"))}}]},{type:"nested",control:"fieldset",label:e("Type of objects"),group:e("Restore options"),schema:[{id:"only_data",label:e("Only data"),control:c.CustomSwitchControl,group:e("Type of objects"),deps:["pre_data","data","post_data","only_schema"],disabled:function(e){return"database"!==this.node.type&&"schema"!==this.node.type||e.get("pre_data")||e.get("data")||e.get("post_data")||e.get("only_schema")}},{id:"only_schema",label:e("Only schema"),control:c.CustomSwitchControl,group:e("Type of objects"),deps:["pre_data","data","post_data","only_data"],disabled:function(e){return"database"!==this.node.type&&"schema"!==this.node.type||e.get("pre_data")||e.get("data")||e.get("post_data")||e.get("only_data")}}]},{type:"nested",control:"fieldset",label:e("Do not save"),group:e("Restore options"),schema:[{id:"dns_owner",label:e("Owner"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")},{id:"dns_privilege",label:e("Privilege"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")},{id:"dns_tablespace",label:e("Tablespace"),control:c.CustomSwitchControl,disabled:!1,group:e("Do not save")}]},{type:"nested",control:"fieldset",label:e("Queries"),group:e("Restore options"),schema:[{id:"include_create_database",label:e("Include CREATE DATABASE statement"),control:c.CustomSwitchControl,disabled:!1,group:e("Queries")},{id:"clean",label:e("Clean before restore"),control:c.CustomSwitchControl,group:e("Queries"),disabled:function(e){return"function"===this.node.type||"trigger_function"===this.node.type}},{id:"single_transaction",label:e("Single transaction"),control:c.CustomSwitchControl,disabled:!1,group:e("Queries")}]},{type:"nested",control:"fieldset",label:e("Disable"),group:e("Restore options"),schema:[{id:"disable_trigger",label:e("Trigger"),control:c.CustomSwitchControl,group:e("Disable")},{id:"no_data_fail_table",label:e("No data for Failed Tables"),control:c.CustomSwitchControl,disabled:!1,group:e("Disable")}]},{type:"nested",control:"fieldset",label:e("Miscellaneous / Behavior"),group:e("Restore options"),schema:[{id:"verbose",label:e("Verbose messages"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous / Behavior")},{id:"use_set_session_auth",label:e("Use SET SESSION AUTHORIZATION"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous / Behavior")},{id:"exit_on_error",label:e("Exit on error"),control:c.CustomSwitchControl,disabled:!1,group:e("Miscellaneous / Behavior")}]}],validate:function(){return null}}));return r.Restore={init:function(){if(!this.initialized){this.initialized=!0;for(var t=["database","schema","table","function","trigger","index","partition"],i=function(e,i,n){var l=r.tree,s=i,d=e,c=l.hasParent(s)?l.parent(s):null,p=c?l.itemData(c):null;return!(a.isUndefined(d)||a.isNull(d)||a.isNull(p))&&(!(-1===a.indexOf(t,d._type)||!o(e,i,n))&&(!("database"!=d._type||!d.allowConn)||"database"!=d._type))},o=function(e,t,i){for(var n=r.tree,o=t,l=e;o;){if(a.indexOf(["catalog"],l._type)>-1)return!1;o=n.hasParent(o)?n.parent(o):null,l=o?n.itemData(o):null}return!0},l=[{name:"restore_object",module:this,applies:["tools"],callback:"restore_objects",priority:13,label:e("Restore..."),icon:"fa fa-upload",enable:i}],s=0;s<t.length;s++)l.push({name:"restore_"+t[s],node:t[s],module:this,applies:["context"],callback:"restore_objects",priority:13,label:e("Restore..."),icon:"fa fa-upload",enable:i});return n.Browser.add_menus(l),this}},restore_objects:function(n,s){for(var d=s||r.tree.selected(),p=null;d;){var m=r.tree.itemData(d);if("server"==m._type){p=m;break}if(!r.tree.hasParent(d)){l.alert(e("Restore Error"),e("Please select server or child node from tree."));break}d=i(r.tree.parent(d))}if(p){var g="pg_bin_dir",h=e("Please configure the PostgreSQL Binary Path in the Preferences dialog.");(p.type&&"ppas"==p.type||"ppas"==p.server_type)&&(g="ppas_bin_dir",h=e("Please configure the EDB Advanced Server Binary Path in the Preferences dialog."));var b=r.get_preference("paths",g);if(!b)return void l.alert(e("Restore Error"),o(e("Failed to load preference %s of module %s")).sprintf(g,"paths").value());if(!b.value)return void l.alert(e("Configuration required"),h);var f=o(e("Restore (%s: %s)")),_=r.tree,v=s||_.selected(),y=v&&1==v.length&&_.itemData(v),w=y&&y._type&&r.Nodes[y._type];w&&(f=f.sprintf(w.label,y.label).value(),l.pg_restore||l.dialog("pg_restore",function(){return{main:function(e,t,i,n){this.set("title",e),this.setting("pg_node",n),this.setting("pg_item",t),this.setting("pg_item_data",i)},build:function(){l.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",className:"btn btn-default pull-left fa fa-lg fa-info",attrs:{name:"object_help",type:"button",url:"backup.html",label:e("Restore")}},{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Restore"),url:t("help.static",{filename:"restore_dialog.html"})}},{text:e("Restore"),key:13,className:"btn btn-primary fa fa-upload pg-alertify-button",restore:!0,"data-btn-name":"restore"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button",restore:!1,"data-btn-name":"cancel"}],options:{title:f,padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},settings:{pg_node:null,pg_item:null,pg_item_data:null},prepare:function(){var t=this;this.__internal.buttons[2].element.disabled=!0;var n=i("<div class='restore_dialog'></div>"),o=r.tree,l=o.selected(),s=l&&1==l.length?o.itemData(l):void 0,d=s&&r.Nodes[s._type];if(s){var p=d.getTreeNodeHierarchy.apply(d,[l]),m=new u({node_data:d},{node_info:p}),g=c.generateViewSchema(p,m,"create",d,p.server,!0),h=this.view=new c.Dialog({el:n,model:m,schema:g});i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),h.render(),this.elements.content.appendChild(n.get(0)),this.view.model.on("change",function(){a.isUndefined(this.get("file"))||""===this.get("file")?(t.__internal.buttons[2].element.disabled=!0,this.errorModel.set("file",e("Please provide filename"))):(this.errorModel.clear(),t.__internal.buttons[2].element.disabled=!1)})}},callback:function(n){var a=r.tree,o=this.settings.pg_item||a.selected(),s=this.settings.pg_item_data||(o&&1==o.length?a.itemData(o):void 0),d=this.settings.pg_node||s&&r.Nodes[s._type];if("dialog_help"==n.button.element.name||"object_help"==n.button.element.name)return n.cancel=!0,void r.showHelp(n.button.element.name,n.button.element.getAttribute("url"),d,o,n.button.element.getAttribute("label"));if("restore"===n.button["data-btn-name"]){if(!s)return;var c=d.getTreeNodeHierarchy.apply(d,[o]),p=this.view.model;if(p.set("database",c.database._label),!p.get("custom"))switch(s._type){case"schema":p.set("schemas",[s._label]);break;case"table":p.set("schemas",[c.schema._label]),p.set("tables",[s._label]);break;case"function":p.set("schemas",[c.schema._label]),p.set("functions",[s._label]);break;case"index":p.set("schemas",[c.schema._label]),p.set("indexes",[s._label]);break;case"trigger":p.set("schemas",[c.schema._label]),p.set("triggers",[s._label]);break;case"trigger_func":p.set("schemas",[c.schema._label]),p.set("trigger_funcs",[s._label])}var u=this,m=t("restore.create_job",{sid:c.server._id}),g=this.view.model.toJSON();i.ajax({url:m,method:"POST",data:{data:JSON.stringify(g)},success:function(t){t.success&&(l.success(e("Restore job created."),5),r.Events.trigger("pgadmin-bgprocess:created",u))},error:function(t,n,a){try{var o=i.parseJSON(t.responseText);l.alert(e("Restore failed."),o.errormsg)}catch(e){}}})}}}}),l.pg_restore(f,v,y,w).resizeTo("65%","60%"))}}},r.Restore}.apply(t,a))&&(e.exports=o)}).call(t,i(3))},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(8),i(6),i(10),i(11),i(30),i(187),i(156),i(21),i(258)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c){if(r.GrantWizard)return r.GrantWizard;var p=c.Model.extend({defaults:{selected:!1,icon:"icon-unknown",name:void 0,name_with_args:void 0,nspname:void 0,proargs:void 0,object_type:void 0,object_id:void 0},idAttribute:"object_id",toJSON:function(e){var t=c.Model.prototype.toJSON.apply(this);return delete t.icon,t},parse:function(e){return e.object_id=e.name_with_args,a.isUndefined(e.object_type)||"Function"!=e.object_type&&"Trigger Function"!=e.object_type&&"Procedure"!=e.object_type?e.name_with_args=e.name:e.name_with_args=e.name+"("+(void 0!==e.proargs?e.proargs:"")+")",e},validate:function(){var t,i={},n=this.get("objects").toJSON();return a.isEmpty(n)?(i.selected=e("Please select any database object type."),t=t||i.selected,this.errorModel.set("selected",t),t):(this.errorModel.unset("selected"),null)}}),u=[{name:"selected",cell:d.Extension.SelectRowCell.extend({render:function(){d.Extension.SelectRowCell.prototype.render.apply(this,arguments);var e=this.column.get("name");return this.model&&this.model.has(e)&&this.model.get(e)&&(this.$el.parent().toggleClass("selected",!0),this.model.trigger("backgrid:selected",this.model,!0)),this}}),headerCell:"select-all"},{name:"object_type",label:e("Object Type"),editable:!1,cell:d.Cell.extend({render:function(){return d.Cell.prototype.render.apply(this,arguments),this.$el.addClass(this.model.get("icon")).css({"padding-left":"24px"}),this}})},{name:"nspname",label:e("Schema"),cell:"string",editable:!1},{name:"name_with_args",label:e("Name"),cell:"string",editable:!1}];return r.GrantWizard={init:function(){if(!this.initialized){this.initialized=!0;for(var t=["schema","coll-function","coll-sequence","coll-table","coll-view","coll-procedure","coll-mview","database","coll-trigger_function"],i=function(e,i,n){var o=r.tree,l=i,s=e,d=o.hasParent(l)?o.parent(l):null,c=d?o.itemData(d):null;return!(a.isUndefined(s)||a.isNull(s)||a.isNull(c))&&(-1!==a.indexOf(t,s._type)&&"catalog"!=c._type&&(!("database"!=s._type||!s.allowConn)||"database"!=s._type))},o=[{name:"grant_wizard_schema",module:this,applies:["tools"],callback:"start_grant_wizard",priority:14,label:e("Grant Wizard..."),icon:"fa fa-unlock-alt",enable:i}],l=0;l<t.length;l++)o.push({name:"grant_wizard_schema_context_"+t[l],node:t[l],module:this,applies:["context"],callback:"start_grant_wizard",priority:14,label:e("Grant Wizard..."),icon:"fa fa-unlock-alt",enable:i});return n.Browser.add_menus(o),this}},start_grant_wizard:function(o,m){l.wizardDialog||l.dialog("wizardDialog",function(){var o=i("<div class='wizard_dlg'></div>");return{main:function(e){this.set("title",e)},setup:function(){return{options:{frameless:!0,resizable:!0,autoReset:!1,maximizable:!1,closable:!1,closableByDimmer:!1,modal:!1,pinnable:!1}}},hooks:{onshow:function(){i(this.elements.body).addClass("pgadmin_grant_wizard_body")}},DbPaginator:function(e){return this.paginator=new d.Extension.Paginator({collection:e,windowSize:8})},DbObjectFilter:function(e){return this.clientSideFilter=new d.Extension.ClientSideFilter({collection:e,placeholder:a("Search by object type or name"),fields:["object_type","name"],wait:150})},updateButtons:function(e){e?i(".wizard-next").prop("disabled",!1):i(".wizard-next").prop("disabled",!0)},onSessionInvalid:function(e){return i(".pg-prop-status-bar .alert-text").html(e),i(".pg-prop-status-bar").css("visibility","visible"),this.updateButtons(!1),!0},onSessionValidated:function(e){i(".pg-prop-status-bar .alert-text").empty(),i(".pg-prop-status-bar").css("visibility","hidden"),this.updateButtons(e)},releaseObjects:function(){var e=this;a.isUndefined(e.dbObjectFilter)||(e.dbObjectFilter.remove(),e.dbObjectFilter=void 0),a.isUndefined(e.clientSideFilter)||(e.clientSideFilter.remove(),e.clientSideFilter=void 0),a.isNull(e.obj_priv)||a.isUndefined(e.obj_priv)||(e.obj_priv=[],delete e.obj_priv),a.isUndefined(e.dbObjectTypePage)||a.isNull(e.dbObjectTypePage)||a.isUndefined(e.dbObjectTypePage.get("model"))||a.isNull(e.dbObjectTypePage.get("model"))||(e.dbObjectTypePage.get("model").clear(),e.dbObjectTypePage.get("view").cleanup(),e.dbObjectTypePage=void 0),a.isUndefined(e.privilegePage)||a.isNull(e.privilegePage)||a.isUndefined(e.privilegePage.get("model"))||a.isNull(e.privilegePage.get("model"))||(e.privilegePage.get("model").clear(),e.privilegePage.get("view").cleanup(),e.privilegePage=void 0),a.isUndefined(e.reviewSQLPage)||a.isNull(e.reviewSQLPage)||a.isUndefined(e.reviewSQLPage.get("model"))||a.isNull(e.reviewSQLPage.get("model"))||(e.reviewSQLPage.get("model").clear(),e.reviewSQLPage=void 0),a.isUndefined(e.sqlControl)||e.sqlControl.remove(),a.isNull(e.privModel)||a.isUndefined(e.privModel)||e.privModel.clear(),a.isNull(e.coll)||a.isUndefined(e.coll)||(e.coll.reset(),e.coll=void 0),a.isNull(e.wizard)||a.isUndefined(e.wizard)||(e.wizard.collection.reset(),e.wizard.curr_page=void 0)},build:function(){this.elements.content.appendChild(o.get(0)),l.pgDialogBuild.apply(this)},get_json_data:function(e,n,a){return i.ajax({async:!1,url:t("grant_wizard.acl",{sid:encodeURI(n),did:encodeURI(a)}),dataType:"jsonp"})},prepare:function(){var m=this;o.empty().append("<div class='grant_wizard_container'></div>");var g=i(".grant_wizard_container"),h=r.tree,b=h.selected(),f=this.d=b&&1==b.length?h.itemData(b):void 0,_=this.info=r.Node.getTreeNodeHierarchy(b),v=(f.icon,_.server_group._id),y=_.server._id,w=_.database._id,x=f._id,C=f._type.replace("coll-","").replace("materialized_",""),N=(f.label,this.get_json_data(v,y,w)),D=JSON.parse(N.responseText),k=t("grant_wizard.objects",{sid:encodeURI(y),did:encodeURI(w),node_id:encodeURI(x),node_type:encodeURI(C)}),S=t("grant_wizard.apply",{sid:encodeURI(y),did:encodeURI(w)}),T=(this.msql_url=t("grant_wizard.modified_sql",{sid:encodeURI(y),did:encodeURI(w)}),s.Collection.extend({model:p,url:k})),j=this.coll=new T,M=this;j.comparator=function(e){return e.get("object_type")},j.sort();this.dbObjectFilter=this.DbObjectFilter(j);M.privArray=[],j.on("backgrid:selected",function(e,t){e.set("selected",t);var i=e.get("object_type");switch(i){case"Function":case"Trigger Function":i="function";break;case"Procedure":i="procedure";break;case"Table":i="table";break;case"Sequence":i="sequence";break;case"View":case"Materialized View":i="table"}if(t)-1==a.indexOf(M.privArray,i)&&M.privArray.push(i),P.get("objects").add(e,{silent:!0});else{var n=M.privArray.indexOf(i);-1!=n&&M.privArray.splice(n,1),P.get("objects").remove(e)}var o=e.validate.call(P);o?M.onSessionInvalid.call(M,o):M.onSessionValidated.call(M,!0)});var E=c.Model.extend({defaults:{objects:void 0,acl:void 0},schema:[{id:"objects",label:e("Objects"),model:p,type:"collection",group:e("Objects")},{id:"acl",label:e("Privileges"),model:n.Browser.Node.PrivilegeRoleModel,type:"collection",canAdd:!0,canDelete:!0,control:"unique-col-collection"}],urlRoot:S}),P=new E({},{node_info:_});i(".wizard-progress-bar p").show(),j.fetch({success:function(e,t){i(".wizard-progress-bar p").html(""),i(".wizard-progress-bar").hide()},reset:!0},this);var U=M.dbObjectTypePage=new r.WizardPage({id:1,page_title:a("Object Selection (step 1 of 3)"),disable_prev:!0,disable_next:!0,show_description:a("Please select objects from the list below."),show_progress_bar:a("Please wait while fetching records..."),model:P,view:new function(){var e=this;a.extend(e,{cleanup:function(){this.grid&&(this.grid.remove(),delete this.grid,this.grid=null),this.el&&(i(this.el).remove(),delete this.el)},grid:null,render:function(){var e=i('<div class="db_objects_container pg-el-xs-12"></div>');return this.grid&&this.cleanup(),this.grid=new d.Grid({columns:a.clone(u),collection:j,className:"backgrid table-bordered object_type_table pg-el-xs-12"}),e.append(this.grid.render().$el),e.prepend(M.clientSideFilter.render().el),this.el=e,P.get("objects").each(function(e){var t=j.get(e.get("object_id"));t&&j.trigger("backgrid:selected",t,!0)}),j.trigger("backgrid:refresh"),this}})},beforeNext:function(e){var t=this;return e.options.disable_next=!0,a.isNull(P.get("acl"))||a.isUndefined(P.get("acl"))||P.get("acl").length>0&&e.collection.at(1).set("disable_next",!1),t.view&&(t.view.cleanup(),delete t.view,t.view=null),!0}}),I=M.privilegePage=new r.WizardPage({id:2,page_title:a("Privileges Selection (step 2 of 3)"),show_description:a("Please select privileges for the selected objects."),disable_next:!0,model:P,view:new function(){var t=this;a.extend(t,{render:function(){var t=[];M.privArray=a.uniq(M.privArray),a.each(M.privArray,function(e){M.obj_priv=t=a.union(t,D[e].acl)});var i=M.privModel,o=c.Model.extend({defaults:{acl:void 0},schema:[{id:"acl",label:e("Privileges"),model:n.Browser.Node.PrivilegeRoleModel.extend({privileges:t}),uniqueCol:["grantee","grantor"],editable:!0,type:"collection",canAdd:!0,canDelete:!0,control:"unique-col-collection"}]}),l={};if(i){l=i.toJSON();var r=l.acl;if(!a.isUndefined(r)&&r.length>0)for(var s in r){var d,p=r[s].privileges,u=[];for(d in p){var m=p[d];-1==a.indexOf(t,m.privilege_type)&&u.push(d)}for(d in u)p.splice(d,1)}}i=M.privModel=new o(l,{node_info:M.info}),M.privModel.startNewSession(),M.privModel.on("pgadmin-session:valid",M.onSessionValidated.bind(M)),M.privModel.on("pgadmin-session:invalid",M.onSessionInvalid.bind(M));var g=Backform.generateViewSchema(M.info,M.privModel,"create",M.d._type,M.d),h=new Backform.Field(g[0].fields[0]);return this.privControl=new(h.get("control"))({field:h,model:M.privModel}),{el:this.privControl.render().$el}},cleanup:function(){this.privControl&&(this.privControl.remove(),delete this.privControl,this.privControl=null)}})},beforePrev:function(e){this.view&&(this.view.cleanup(),delete this.view,this.view=null);var t=P.get("objects");return!a.isUndefined(t)&&!a.isEmpty(t)&&t.length>0&&(e.collection.at(0).set("disable_next",!1),e.collection.at(0).set("show_progress_bar","")),P.trigger("backgrid:refresh",P,!1),M.clientSideFilter.render(),!0},beforeNext:function(){return!0},onNext:function(e){a.isUndefined(M.privModel)||P.set({acl:M.privModel.get("acl")}),this.view&&(this.view.cleanup(),delete this.view,this.view=null),M.wizard.options.disable_finish=!1,P.trigger("pgadmin-wizard:nextpage:sql",{node_type:C})}}),O=new Backform.Field({id:"sqltab",label:a("Sql Tab"),control:Backform.SqlTabControl.extend({initialize:function(){Backform.SqlTabControl.prototype.initialize.apply(this,arguments),this.msql_url=M.msql_url,this.model.on("pgadmin-wizard:nextpage:sql",this.onWizardNextPageChange,this),this.model.on("pgadmin-wizard:prevpage:sql",this.onWizardPrevPageChange,this)},onWizardNextPageChange:function(){var e=this;i.ajax({url:this.msql_url,type:"GET",cache:!1,data:e.model.toJSON(!0,"GET"),dataType:"json",contentType:"application/json"}).done(function(t){e.sqlCtrl.clearHistory(),e.sqlCtrl.setValue(t.data),e.sqlCtrl.refresh()}).fail(function(){e.model.trigger("pgadmin-view:msql:error")}).always(function(){e.model.trigger("pgadmin-view:msql:fetched")})},remove:function(){M.sqlControl.unbind();var e=M.sqlControl.sqlCtrl.getWrapperElement();i(e).remove(),M.sqlControl.sqlCtrl=void 0}})}),A=M.sqlControl=new(O.get("control"))({field:O,model:P}),q=M.reviewSQLPage=new r.WizardPage({id:3,page_title:a("Final (Review Selection) (step 3 of 3)"),show_description:a("The SQL below will be executed on the database server to grant the selected privileges. Please click on <b>Finish</b> to complete the process."),model:P,view:new function(){var e=A.render().$el;this.render=function(){return{el:e}}},beforePrev:function(e){var t=P.get("acl");if(!a.isUndefined(e.collection)&&e.collection.models.length>0)return!a.isUndefined(t)&&!a.isEmpty(t)&&t.length>0?e.collection.at(1).set("disable_next",!1):e.collection.at(1).set("disable_next",!0),!0}}),B=s.Collection.extend({model:r.WizardPage});this.wizardCollection=new B([U,I,q]),M.wizard=new(r.Wizard.extend({options:{title:a("Grant Wizard"),width:"",height:"",curr_page:0,show_left_panel:!1,show_header_cancel_btn:!0,show_header_maximize_btn:!0,disable_finish:!0,dialog_api:m,wizard_help:t("help.static",{filename:"grant_wizard.html"})},onFinish:function(){var t=P,i=t.toJSON("GET");!i||a.isEmpty(i)||a.isUndefined(i.objects)||t.save({},{attrs:i,validate:!1,cache:!1,success:function(e){M.releaseObjects(),M.close()},error:function(t,i){l.pgNotifier("error",i,e("Error saving properties")),M.releaseObjects(),M.close()}})},onCancel:function(){M.releaseObjects(),M.close()}}))({collection:this.wizardCollection,el:g,model:P}),M.wizard.render()}}}),l.wizardDialog(!0).resizeTo("55%","75%")}},r.GrantWizard}.apply(t,a))&&(e.exports=o)}).call(t,i(3))},,function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(15),i(3),i(6),i(10),i(11),i(17),i(22),i(26),i(51)],void 0!==(a=function(e,t,i,n,a,o,l,r,s,d,c){l=l||window.pgAdmin||{};var p=l.Tools=l.Tools||{};if(l.Tools.maintenance)return l.Tools.maintenance;var u=(c.CustomSwitchControl=c.SwitchControl.extend({template:n.template(['<label class="<%=Backform.controlLabelClassName%> custom_switch_label_class"><%=label%></label>','<div class="<%=Backform.controlsClassName%> custom_switch_control_class">','  <div class="checkbox">',"    <label>",'      <input type="checkbox" class="<%=extraClasses.join(\' \')%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    </label>","  </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>"].join("\n")),className:"pgadmin-control-group form-group col-xs-6"}),s.Model.extend({defaults:{op:"VACUUM",vacuum_full:!1,vacuum_freeze:!1,vacuum_analyze:!1,verbose:!0},initialize:function(){var e=arguments[1].node_info;("primary_key"in e||"unique_constraint"in e||"index"in e)&&(this.set("op","REINDEX"),this.set("verbose",!1))},schema:[{id:"op",label:e("Maintenance operation"),cell:"string",type:"text",group:e("Options"),options:[{label:"VACUUM",value:"VACUUM"},{label:"ANALYZE",value:"ANALYZE"},{label:"REINDEX",value:"REINDEX"},{label:"CLUSTER",value:"CLUSTER"}],control:c.RadioControl.extend({template:n.template(['<label class="control-label col-sm-4 col-xs-12"><%=label%></label>','<div class="pgadmin-controls col-xs-12 col-sm-8 btn-group pg-maintenance-op" data-toggle="buttons">'," <% for (var i=0; i < options.length; i++) { %>"," <% var option = options[i]; %>",' <label class="btn btn-primary<% if (i == 0) { %> active<%}%>">','  <input type="radio" name="op" id="op" autocomplete="off" value=<%-formatter.fromRaw(option.value)%><% if (i == 0) { %> selected<%}%> > <%-option.label%>'," </label>"," <% } %>","</div>"].join("\n"))}),select2:{allowClear:!1,width:"100%",placeholder:e("Select from list...")}},{type:"nested",control:"fieldset",label:e("Vacuum"),group:e("Options"),schema:[{id:"vacuum_full",group:e("Vacuum"),disabled:"isDisabled",control:c.CustomSwitchControl,label:e("FULL"),deps:["op"]},{id:"vacuum_freeze",deps:["op"],disabled:"isDisabled",control:c.CustomSwitchControl,label:e("FREEZE"),group:e("Vacuum")},{id:"vacuum_analyze",deps:["op"],disabled:"isDisabled",control:c.CustomSwitchControl,label:e("ANALYZE"),group:e("Vacuum")}]},{id:"verbose",group:e("Options"),deps:["op"],control:c.CustomSwitchControl,label:e("Verbose Messages"),disabled:"isDisabled"}],isDisabled:function(e){var t=this.name,i=this.node_info;switch(t){case"vacuum_full":case"vacuum_freeze":case"vacuum_analyze":return"VACUUM"!=e.get("op");case"verbose":return("primary_key"in i||"unique_constraint"in i||"index"in i)&&"REINDEX"==e.get("op")?(setTimeout(function(){e.set("verbose",!1)},10),!0):"REINDEX"==e.get("op");default:return!1}return!1}}));return p.maintenance={init:function(){if(!this.initialized){this.initialized=!0;for(var t=["database","table","primary_key","unique_constraint","index","partition"],i=function(e,i,a){var o=r.tree,l=i,s=e,d=o.hasParent(l)?o.parent(l):null,c=d?o.itemData(d):null;return!(n.isUndefined(s)||n.isNull(s)||n.isNull(c))&&(-1!==n.indexOf(t,s._type)&&"catalog"!=c._type&&(!("database"!=s._type||!s.allowConn)||"database"!=s._type))},a=[{name:"maintenance",module:this,applies:["tools"],callback:"callback_maintenance",priority:10,label:e("Maintenance..."),icon:"fa fa-wrench",enable:i}],o=0;o<t.length;o++)a.push({name:"maintenance_context_"+t[o],node:t[o],module:this,applies:["context"],callback:"callback_maintenance",priority:10,label:e("Maintenance..."),icon:"fa fa-wrench",enable:i});r.add_menus(a)}},callback_maintenance:function(n,l){for(var s=l||r.tree.selected(),d=null;s;){var p=r.tree.itemData(s);if("server"==p._type){d=p;break}if(!r.tree.hasParent(s)){o.alert(e("Please select server or child node from tree."));break}s=i(r.tree.parent(s))}if(d){var m="pg_bin_dir",g=e("Please configure the PostgreSQL Binary Path in the Preferences dialog.");(d.type&&"ppas"==d.type||"ppas"==d.server_type)&&(m="ppas_bin_dir",g=e("Please configure the EDB Advanced Server Binary Path in the Preferences dialog."));var h=r.get_preference("paths",m);if(!h)return void o.alert(a(e("Failed to load preference %s of module %s")).sprintf(m,"paths").value());if(!h.value)return void o.alert(e("Configuration required"),g);var b=this,f=r.tree,s=l||f.selected(),_=s&&1==s.length?f.itemData(s):void 0,v=_&&r.Nodes[_._type];if(_){_.label,v.getTreeNodeHierarchy.apply(v,[s]);o.MaintenanceDialog||o.dialog("MaintenanceDialog",function(){return{main:function(e){this.set("title",e)},setup:function(){return{buttons:[{text:"",className:"btn btn-default pull-left fa fa-lg fa-info",attrs:{name:"object_help",type:"button",url:"maintenance.html",label:e("Maintenance")}},{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Maintenance"),url:t("help.static",{filename:"maintenance_dialog.html"})}},{text:e("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button","data-btn-name":"ok"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button","data-btn-name":"cancel"}],options:{modal:0,pinnable:!1}}},callback:function(n){var a=r.tree.selected(),l=a&&1==a.length?r.tree.itemData(a):void 0,s=l&&r.Nodes[l._type];if("dialog_help"==n.button.element.name||"object_help"==n.button.element.name)return n.cancel=!0,void r.showHelp(n.button.element.name,n.button.element.getAttribute("url"),s,a,n.button.element.getAttribute("label"));if("ok"===n.button["data-btn-name"]){var d=void 0,c=void 0,p=void 0,u=void 0,m=void 0;if(!l)return;var g=s.getTreeNodeHierarchy.apply(s,[a]);void 0!=g.schema&&(d=g.schema._label),void 0!=g.partition?c=g.partition._label:void 0!=g.table&&(c=g.table._label),void 0!=g.primary_key?p=g.primary_key._label:void 0!=g.unique_constraint?u=g.unique_constraint._label:void 0!=g.index&&(m=g.index._label),this.view.model.set({database:g.database._label,schema:d,table:c,primary_key:p,unique_constraint:u,index:m}),i.ajax({url:t("maintenance.create_job",{sid:g.server._id,did:g.database._id}),method:"POST",data:{data:JSON.stringify(this.view.model.toJSON())},success:function(e){e.data&&e.data.status?(o.success(e.data.info),r.Events.trigger("pgadmin-bgprocess:created",b)):o.error(e.data.errmsg)},error:function(t){o.alert(e("Maintenance job creation failed."))}})}},build:function(){o.pgDialogBuild.apply(this)},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var e=i("<div class='maintenance_dlg'></div>"),t=r.tree,n=t.selected(),a=n&&1==n.length?t.itemData(n):void 0,o=a&&r.Nodes[a._type];if(a){var l=o.getTreeNodeHierarchy.apply(o,[n]),s=new u({},{node_info:l}),d=c.generateViewSchema(l,s,"create",o,l.server,!0),p=this.view=new c.Dialog({el:e,model:s,schema:d});if(i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),p.render(),"primary_key"==a._type||"unique_constraint"==a._type||"index"==a._type){var m=e.find(".pgadmin-controls label:lt(2)").removeClass("active").addClass("disabled"),g=m[1].nextElementSibling;i(g).addClass("active")}this.elements.content.appendChild(e.get(0))}}}}),o.MaintenanceDialog("Maintenance...").set("resizable",!0).resizeTo("60%","80%")}}}},l.Tools.maintenance}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(15),i(3),i(6),i(10),i(11),i(17),i(22),i(26),i(51)],void 0!==(a=function(e,t,i,n,a,o,l,r,s,d,c){l=l||window.pgAdmin||{};var p=l.Tools=l.Tools||{};if(l.Tools.import_utility)return l.Tools.import_utility;var u=s.Model.extend({defaults:{is_import:!1,filename:void 0,format:"csv",encoding:void 0,oid:void 0,header:void 0,delimiter:"",quote:'"',escape:"'",null_string:void 0,columns:null,icolumns:[],database:void 0,schema:void 0,table:void 0},schema:[{id:"is_import",label:e("Import/Export"),cell:"switch",type:"switch",group:e("Options"),options:{onText:e("Import"),offText:e("Export"),onColor:"success",offColor:"primary"}},{type:"nested",control:"fieldset",label:e("File Info"),group:e("Options"),schema:[{id:"filename",label:e("Filename"),deps:["is_import"],type:"text",control:c.FileControl,group:e("File Info"),dialog_type:"select_file",supp_types:["csv","txt","*"],visible:"importing"},{id:"filename",label:e("Filename"),deps:["is_import"],type:"text",control:c.FileControl,group:e("File Info"),dialog_type:"create_file",supp_types:["csv","txt","*"],visible:"exporting"},{id:"format",label:e("Format"),cell:"string",control:"select2",group:e("File Info"),options:[{label:"binary",value:"binary"},{label:"csv",value:"csv"},{label:"text",value:"text"}],disabled:"isDisabled",select2:{allowClear:!1,width:"100%"}},{id:"encoding",label:e("Encoding"),cell:"string",control:"node-ajax-options",node:"database",url:"get_encodings",first_empty:!0,group:e("File Info")}]},{id:"columns",label:e("Columns to import"),cell:"string",deps:["is_import"],type:"array",first_empty:!1,control:c.NodeListByNameControl.extend({initialize:function(){c.NodeListByNameControl.prototype.initialize.apply(this,arguments);var e=this,t=e.field.get("options"),i=[];if(n.isFunction(t))try{var a=t.apply(e);for(var o in a)i.push(a[o].value)}catch(e){t=[]}else for(o in t)i.push(t[o].value);e.model.set("columns",i)}}),transform:function(e){var t=this,i=t.field.get("schema_node"),a=[];return n.each(e,function(e){var o=n.isFunction(i.node_label)?i.node_label.apply(i,[e,t.model,t]):e.label,l=n.isFunction(i.node_image)?i.node_image.apply(i,[e,t.model,t]):i.node_image||"icon-"+i.type;a.push({value:e.label,image:l,label:o})}),a},node:"column",url:"nodes",group:e("Columns"),select2:{multiple:!0,allowClear:!1,placeholder:e("Columns for importing..."),first_empty:!1},visible:"importing",helpMessage:e("An optional list of columns to be copied. If no column list is specified, all columns of the table will be copied.")},{id:"columns",label:e("Columns to export"),cell:"string",deps:["is_import"],type:"array",control:"node-list-by-name",first_empty:!1,node:"column",url:"nodes",group:e("Columns"),select2:{multiple:!0,allowClear:!0,placeholder:e("Colums for exporting...")},visible:"exporting",transform:function(e){var t=this,i=t.field.get("schema_node"),a=[];return n.each(e,function(e){var o=n.isFunction(i.node_label)?i.node_label.apply(i,[e,t.model,t]):e.label,l=n.isFunction(i.node_image)?i.node_image.apply(i,[e,t.model,t]):i.node_image||"icon-"+i.type;a.push({value:e.label,image:l,label:o})}),a},helpMessage:e("An optional list of columns to be copied. If no column list is specified, all columns of the table will be copied.")},{id:"null_string",label:e("NULL Strings"),cell:"string",type:"text",group:e("Columns"),disabled:"isDisabled",deps:["format"],helpMessage:e("Specifies the string that represents a null value. The default is \\N (backslash-N) in text format, and an unquoted empty string in CSV format. You might prefer an empty string even in text format for cases where you don't want to distinguish nulls from empty strings. This option is not allowed when using binary format.")},{id:"icolumns",label:e("Not null columns"),cell:"string",control:"node-list-by-name",node:"column",group:e("Columns"),deps:["format","is_import"],disabled:"isDisabled",type:"array",first_empty:!1,select2:{multiple:!0,allowClear:!0,first_empty:!0,placeholder:e("Not null columns...")},helpMessage:e("Do not match the specified column values against the null string. In the default case where the null string is empty, this means that empty values will be read as zero-length strings rather than nulls, even when they are not quoted. This option is allowed only in import, and only when using CSV format.")},{type:"nested",control:"fieldset",label:e("Miscellaneous"),group:e("Options"),schema:[{id:"oid",label:e("OID"),cell:"string",type:"switch",group:e("Miscellaneous")},{id:"header",label:e("Header"),cell:"string",type:"switch",group:e("Miscellaneous"),deps:["format"],disabled:"isDisabled"},{id:"delimiter",label:e("Delimiter"),cell:"string",first_empty:!0,type:"text",control:"node-ajax-options",group:e("Miscellaneous"),disabled:"isDisabled",deps:["format"],options:[{label:";",value:";"},{label:",",value:","},{label:"|",value:"|"},{label:"[tab]",value:"[tab]"}],select2:{tags:!0,allowClear:!1,width:"100%",placeholder:e("Select from list...")},helpMessage:e("Specifies the character that separates columns within each row (line) of the file. The default is a tab character in text format, a comma in CSV format. This must be a single one-byte character. This option is not allowed when using binary format.")},{id:"quote",label:e("Quote"),cell:"string",first_empty:!0,deps:["format"],type:"text",control:"node-ajax-options",group:e("Miscellaneous"),disabled:"isDisabled",options:[{label:'"',value:'"'},{label:"'",value:"'"}],select2:{tags:!0,allowClear:!1,width:"100%",placeholder:e("Select from list...")},helpMessage:e("Specifies the quoting character to be used when a data value is quoted. The default is double-quote. This must be a single one-byte character. This option is allowed only when using CSV format.")},{id:"escape",label:e("Escape"),cell:"string",first_empty:!0,deps:["format"],type:"text",control:"node-ajax-options",group:e("Miscellaneous"),disabled:"isDisabled",options:[{label:'"',value:'"'},{label:"'",value:"'"}],select2:{tags:!0,allowClear:!1,width:"100%",placeholder:e("Select from list...")},helpMessage:e("Specifies the character that should appear before a data character that matches the QUOTE value. The default is the same as the QUOTE value (so that the quoting character is doubled if it appears in the data). This must be a single one-byte character. This option is allowed only when using CSV format.")}]}],isDisabled:function(e){switch(name=this.name,name){case"quote":case"escape":case"header":return"csv"!=e.get("format");case"icolumns":return"csv"!=e.get("format")||!e.get("is_import");case"null_string":case"delimiter":return"binary"==e.get("format");default:return!1}},importing:function(e){return e.get("is_import")},exporting:function(e){return!e.importing.apply(this,arguments)}});return p.import_utility={init:function(){if(!this.initialized){this.initialized=!0;var t=function(e,t,i){var a=r.tree,o=t,l=e,s=a.hasParent(o)?a.parent(o):null,d=s?a.itemData(s):null;return!(n.isUndefined(l)||n.isNull(l)||n.isNull(d))&&(-1!==n.indexOf(["table"],l._type)&&"catalog"!=d._type)};r.add_menus([{name:"import",node:"table",module:this,applies:["tools","context"],callback:"callback_import_export",category:"import",priority:10,label:e("Import/Export..."),icon:"fa fa-shopping-cart",enable:t}])}},callback_import_export:function(l,s){for(var d=s||r.tree.selected(),p=null;d;){var m=r.tree.itemData(d);if("server"==m._type){p=m;break}if(!r.tree.hasParent(d)){o.alert(e("Please select server or child node from tree."));break}d=i(r.tree.parent(d))}if(p){var g="pg_bin_dir",h=e("Please configure the PostgreSQL Binary Path in the Preferences dialog.");(p.type&&"ppas"==p.type||"ppas"==p.server_type)&&(g="ppas_bin_dir",h=e("Please configure the EDB Advanced Server Binary Path in the Preferences dialog."));var b=r.get_preference("paths",g);if(!b)return void o.alert(a(e("Failed to load preference %s of module %s")).sprintf(g,"paths").value());if(!b.value)return void o.alert(e("Configuration required"),h);var f=r.tree,d=s||f.selected(),_=d&&1==d.length?f.itemData(d):void 0,v=_&&r.Nodes[_._type];if(_){var y=(_.label,v.getTreeNodeHierarchy.apply(v,[d]));o.ImportDialog||o.dialog("ImportDialog",function(){return{main:function(e,t,i,n){this.set("title",e),this.setting("pg_node",t),this.setting("pg_item",i),this.setting("pg_item_data",n)},build:function(){o.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:e("OK"),key:13,disable:!0,"data-btn-name":"ok",className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"},{text:e("Cancel"),key:27,"data-btn-name":"cancel",className:"btn btn-danger fa fa-lg fa-times pg-alertify-button"}],options:{modal:!0}}},settings:{pg_node:null,pg_item:null,pg_item_data:null},callback:function(n){if("ok"===n.button["data-btn-name"]){var a=this.settings.pg_node,l=this.settings.pg_item,s=a.getTreeNodeHierarchy.apply(a,[l]);this.view.model.set({database:s.database._label,schema:s.schema._label,table:s.table._label});var d=this;i.ajax({url:t("import_export.create_job",{sid:s.server._id}),method:"POST",data:{data:JSON.stringify(this.view.model.toJSON())},success:function(t){t.success&&(o.success(e("Import/export job created."),5),r.Events.trigger("pgadmin-bgprocess:created",d))},error:function(t,n,a){try{var l=i.parseJSON(t.responseText);o.alert(e("Import/export job failed."),l.errormsg)}catch(e){}}})}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})},onupdate:function(e,t,i){switch(e){case"resizable":i?this.elements.content.removeAttribute("style"):this.elements.content.style.minHeight="inherit"}}},prepare:function(){var t=this;this.__internal.buttons[0].element.disabled=!0;var a=i("<div class='import_dlg'></div>"),o=this.settings.pg_node,l=this.settings.pg_item,r=o.getTreeNodeHierarchy.apply(o,[l]),s=new u({},{node_info:r}),d=c.generateViewSchema(r,s,"create",v,r.server,!0),p=this.view=new c.Dialog({el:a,model:s,schema:d});i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),p.render(),this.elements.content.appendChild(a.get(0)),this.view.model.on("change",function(){n.isUndefined(this.get("filename"))||""===this.get("filename")?(t.__internal.buttons[0].element.disabled=!0,this.errorModel.set("filename",e("Please provide filename"))):(this.errorModel.clear(),n.isUndefined(this.get("delimiter"))||n.isNull(this.get("delimiter"))?(t.__internal.buttons[0].element.disabled=!0,this.errorModel.set("delimiter",e("Delimiter should contain only one character"))):(this.errorModel.clear(),n.isUndefined(this.get("quote"))||""===this.get("quote")||1!=this.get("quote").length?(t.__internal.buttons[0].element.disabled=!0,this.errorModel.set("quote",e("Quote should contain only one character"))):(this.errorModel.clear(),n.isUndefined(this.get("escape"))||""===this.get("escape")||1!=this.get("escape").length?(t.__internal.buttons[0].element.disabled=!0,this.errorModel.set("escape",e("Escape should contain only one character"))):(this.errorModel.clear(),t.__internal.buttons[0].element.disabled=!1))))}),this.elements.dialog.style.minHeight="80%",this.elements.dialog.style.minWidth="70%"}}}),o.ImportDialog(a(e("Import/Export data - table '%s'")).sprintf(y.table.label).value(),v,d,_).set("resizable",!0).resizeTo("70%","80%")}}}},l.Tools.import_utility}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(8),i(3),i(6),i(10),i(11),i(13),i(17),i(97),i(29),i(22),i(26),i(185)],void 0!==(a=function(e,t,i,n,a,o,l,r,s,d,c,p,u){l=l||window.pgAdmin||{};var m=l.Tools=l.Tools||{};return l.Tools.Debugger?l.Tools.Debugger:(m.Debugger={init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"direct_debugger",node:"function",module:this,applies:["object","context"],callback:"get_function_information",category:e("Debugging"),priority:10,label:e("Debug"),data:{object:"function"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"global_debugger",node:"function",module:this,applies:["object","context"],callback:"check_func_debuggable",category:e("Debugging"),priority:10,label:e("Set breakpoint"),data:{object:"function",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"procedure_direct_debugger",node:"procedure",module:this,applies:["object","context"],callback:"get_function_information",category:e("Debugging"),priority:10,label:e("Debug"),data:{object:"procedure"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"procedure_indirect_debugger",node:"procedure",module:this,applies:["object","context"],callback:"check_func_debuggable",category:e("Debugging"),priority:10,label:e("Set breakpoint"),data:{object:"procedure",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"trigger_function_indirect_debugger",node:"trigger_function",module:this,applies:["object","context"],callback:"check_func_debuggable",priority:10,label:e("Set breakpoint"),category:e("Debugging"),icon:"fa fa-arrow-circle-right",data:{object:"trigger_function",debug_type:"indirect"},enable:"can_debug"},{name:"trigger_indirect_debugger",node:"trigger",module:this,applies:["object","context"],callback:"check_func_debuggable",priority:10,label:e("Set breakpoint"),category:e("Debugging"),icon:"fa fa-arrow-circle-right",data:{object:"trigger",debug_type:"indirect"},enable:"can_debug"},{name:"package_function_direct_debugger",node:"edbfunc",module:this,applies:["object","context"],callback:"get_function_information",category:e("Debugging"),priority:10,label:e("Debug"),data:{object:"edbfunc"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"package_function_global_debugger",node:"edbfunc",module:this,applies:["object","context"],callback:"check_func_debuggable",category:e("Debugging"),priority:10,label:e("Set breakpoint"),data:{object:"edbfunc",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"package_procedure_direct_debugger",node:"edbproc",module:this,applies:["object","context"],callback:"get_function_information",category:e("Debugging"),priority:10,label:e("Debug"),data:{object:"edbproc"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"package_procedure_global_debugger",node:"edbproc",module:this,applies:["object","context"],callback:"check_func_debuggable",category:e("Debugging"),priority:10,label:e("Set breakpoint"),data:{object:"edbproc",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"}]),this.frame=new r.Frame({name:"frm_debugger",title:e("Debugger"),width:500,isCloseable:!0,isPrivate:!0,icon:"fa fa-arrow-circle-right",url:"about:blank"}),this.frame.load(r.docker))},can_debug:function(e,t,i){for(var n=r.tree,a=t,o=e;a;){if("catalog"==o._type)return!1;a=n.hasParent(a)?n.parent(a):null,o=a?n.itemData(a):null}var l=r.tree,s=l.selected(),d=s&&1==s.length?l.itemData(s):void 0,c=d&&r.Nodes[d._type];if(!d)return!1;var p=c.getTreeNodeHierarchy.apply(c,[s]);if(i&&i.debug_type&&"indirect"==i.debug_type&&!p.server.user.is_superuser)return!1;var u=p.function&&p.function.funcowner||p.procedure&&p.procedure.funcowner||p.edbfunc&&p.edbfunc.funcowner||p.edbproc&&p.edbproc.funcowner;return!(!p.server.user.is_superuser&&u!=p.server.user.name)&&(void 0==d.language&&"trigger"==d._type||void 0==d.language&&"edbfunc"==d._type||void 0==d.language&&"edbproc"==d._type||("plpgsql"==d.language||"edbspl"==d.language))},generate_url:function(e,i,o){var l="{BASEURL}{URL}/{OBJTYPE}{REF}",r="";n.each(n.sortBy(n.values(n.pick(i,function(e,t,i){return"server_group"!=t})),function(e){return e.priority}),function(e){r=a("%s/%s").sprintf(r,encodeURI(e._id)).value()});var s={URL:e,BASEURL:t("debugger.index"),REF:r,OBJTYPE:encodeURI(o.type)};return l.replace(/{(\w+)}/g,function(e,t){return s[t]})},check_func_debuggable:function(t,n){var a=r.tree,l=n||a.selected(),s=l&&1==l.length?a.itemData(l):void 0,d=s&&r.Nodes[s._type];if(s){var c=(s.label,d.getTreeNodeHierarchy.apply(d,[l])),p=this.generate_url("init",c,d),u=this;i.ajax({url:p,cache:!1,success:function(e){u.start_global_debugger()},error:function(t,n,a){try{var l=i.parseJSON(t.responseText);0==l.success&&o.alert(e("Debugger Error"),l.errormsg)}catch(e){}}})}},start_global_debugger:function(n,a){var l=r.tree,s=l.selected(),d=s&&1==s.length?l.itemData(s):void 0,c=d&&r.Nodes[d._type];if(d){var p=c.getTreeNodeHierarchy.apply(c,[s]);if("function"==d._type)var u=t("debugger.initialize_target_for_function",{debug_type:"indirect",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.function._id});else if("procedure"==d._type)var u=t("debugger.initialize_target_for_function",{debug_type:"indirect",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.procedure._id});else if("trigger_function"==d._type)var u=t("debugger.initialize_target_for_function",{debug_type:"indirect",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.trigger_function._id});else if("trigger"==d._type&&"table"in p)var u=t("debugger.initialize_target_for_trigger",{debug_type:"indirect",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.table._id,tri_id:p.trigger._id});else if("trigger"==d._type&&"view"in p)var u=t("debugger.initialize_target_for_trigger",{debug_type:"indirect",sid:p.server._id,did:p.database._id,scid:p.schema._id,func_id:p.view._id,tri_id:p.trigger._id});i.ajax({url:u,method:"GET",success:function(e){var n=t("debugger.direct",{trans_id:e.data.debuggerTransId});if(e.data.newBrowserTab)window.open(n,"_blank");else{r.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",function(e){e.openURL(n)});var a=r.docker.findPanels("properties"),o=r.docker.addPanel("frm_debugger",wcDocker.DOCK.STACKED,a[0]);o.focus(),o.on(wcDocker.EVENT.CLOSED,function(){var n=t("debugger.close",{trans_id:e.data.debuggerTransId});i.ajax({url:n,method:"DELETE"})})}},error:function(t,n,a){try{var l=i.parseJSON(t.responseText);0==l.success&&o.alert(e("Debugger Error"),l.errormsg)}catch(e){}}})}},get_function_information:function(n,a){var l=r.tree,s=a||l.selected(),d=s&&1==s.length?l.itemData(s):void 0,c=d&&r.Nodes[d._type];if(d){var p=(d.label,c.getTreeNodeHierarchy.apply(c,[s])),m=this.generate_url("init",p,c);i.ajax({url:m,cache:!1,success:function(n){if(n.data[0].require_input)u(n.data[0],0);else{var a=r.tree,l=a.selected(),s=l&&1==l.length?a.itemData(l):void 0,d=s&&r.Nodes[s._type];if(!s)return;var c=d.getTreeNodeHierarchy.apply(d,[l]);if("function"==s._type)var p=t("debugger.initialize_target_for_function",{debug_type:"direct",sid:c.server._id,did:c.database._id,scid:c.schema._id,func_id:c.function._id});else var p=t("debugger.initialize_target_for_function",{debug_type:"direct",sid:c.server._id,did:c.database._id,scid:c.schema._id,func_id:c.procedure._id});i.ajax({url:p,method:"GET",success:function(e){var n=t("debugger.direct",{trans_id:e.data.debuggerTransId});if(e.data.newBrowserTab)window.open(n,"_blank");else{r.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",function(e){e.openURL(n)});var a=r.docker.findPanels("properties"),o=r.docker.addPanel("frm_debugger",wcDocker.DOCK.STACKED,a[0]);o.focus(),o.on(wcDocker.EVENT.CLOSED,function(){var n=t("debugger.close",{trans_id:e.data.debuggerTransId});i.ajax({url:n,method:"DELETE"})})}},error:function(t){o.alert(e("Debugger Target Initialization Error"),t.responseJSON.errormsg)}})}},error:function(t,n,a){try{var l=i.parseJSON(t.responseText);0==l.success&&o.alert(e("Debugger Error"),l.errormsg)}catch(e){}}})}}},l.Tools.Debugger)}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(263),i(264)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-pga_job"]){l.Nodes["coll-pga_job"]=l.Collection.extend({node:"pga_job",label:e("pga_jobs"),type:"coll-pga_job",columns:["jobid","jobname","jobenabled","jlgstatus","jobnextrun","joblastrun","jobdesc"],hasStatistics:!1})}return l.Nodes.pga_job||(l.Nodes.pga_job=l.Node.extend({parent_type:"server",type:"pga_job",dialogHelp:t("help.static",{filename:"pgagent_jobs.html"}),hasSQL:!0,hasDepends:!1,hasStatistics:!0,hasCollectiveStatistics:!0,width:"80%",height:"80%",canDrop:function(e){return!0},label:e("pgAgent Job"),node_image:function(){return"icon-pga_job"},Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_pga_job_on_coll",node:"coll-pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("pgAgent Job..."),icon:"wcTabIcon icon-pga_job",data:{action:"create"}},{name:"create_pga_job",node:"pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("pgAgent Job..."),icon:"wcTabIcon icon-pga_job",data:{action:"create"}},{name:"run_now_pga_job",node:"pga_job",module:this,applies:["object","context"],callback:"run_pga_job_now",priority:4,label:e("Run now"),data:{action:"create"},icon:"fa fa-play-circle"}]))},model:l.Node.Model.extend({defaults:{jobname:"",jobid:void 0,jobenabled:!0,jobhostagent:"",jobjclid:1,jobcreated:void 0,jobchanged:void 0,jobnextrun:void 0,joblastrun:void 0,jlgstatus:void 0,jobrunningat:void 0,jobdesc:"",jsteps:[],jschedules:[]},idAttribute:"jobid",parse:function(){var t=l.Node.Model.prototype.parse.apply(this,arguments);return t&&(t.jobrunningat=t.jaghostagent||e("Not running currently."),t.jlgstatus=t.jlgstatus||e("Unknown")),t},schema:[{id:"jobname",label:e("Name"),type:"text",cellHeaderClasses:"width_percent_30"},{id:"jobid",label:e("ID"),mode:["properties"],type:"int"},{id:"jobenabled",label:e("Enabled?"),type:"switch",cellHeaderClasses:"width_percent_5"},{id:"jobclass",label:e("Job class"),type:"text",mode:["properties"]},{id:"jobjclid",label:e("Job class"),type:"int",control:"node-ajax-options",url:"classes",url_with_id:!1,cache_node:"server",mode:["create","edit"],select2:{allowClear:!1},helpMessage:e("Please select a class to categorize the job. This option will not affect the way the job runs.")},{id:"jobhostagent",label:e("Host agent"),type:"text",mode:["edit","create"],helpMessage:e("Enter the hostname of a machine running pgAgent if you wish to ensure only that machine will run this job. Leave blank if any host may run the job.")},{id:"jobhostagent",label:e("Host agent"),type:"text",mode:["properties"]},{id:"jobcreated",type:"text",mode:["properties"],label:e("Created")},{id:"jobchanged",type:"text",mode:["properties"],label:e("Changed")},{id:"jobnextrun",type:"text",mode:["properties"],label:e("Next run"),cellHeaderClasses:"width_percent_20"},{id:"joblastrun",type:"text",mode:["properties"],label:e("Last run"),cellHeaderClasses:"width_percent_20"},{id:"jlgstatus",type:"text",label:e("Last result"),cellHeaderClasses:"width_percent_5",mode:["properties"]},{id:"jobrunningat",type:"text",mode:["properties"],label:e("Running at")},{id:"jobdesc",label:e("Comment"),type:"multiline",cellHeaderClasses:"width_percent_15"},{id:"jsteps",label:"",group:e("Steps"),type:"collection",mode:["edit","create"],model:l.Nodes.pga_jobstep.model,canEdit:!0,control:"sub-node-collection",canAdd:!0,canDelete:!0,columns:["jstname","jstenabled","jstkind","jstconntype","jstonerror"]},{id:"jschedules",label:"",group:e("Schedules"),type:"collection",mode:["edit","create"],control:"sub-node-collection",canAdd:!0,canDelete:!0,canEdit:!0,model:l.Nodes.pga_schedule.model,columns:["jscname","jscenabled","jscstart","jscend"]}],validate:function(t){var i=this.get("jobname");if(n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var a=e("Name cannot be empty.");return this.errorModel.set("jobname",a),a}return this.errorModel.unset("jobname"),null}}),run_pga_job_now:function(t){var a=t||{},o=this,s=l.tree,d=a.item||s.selected(),c=d&&1==d.length?s.itemData(d):void 0;return!!c&&(i.ajax({url:o.generate_url(d,"run_now",c,!0),method:"PUT",success:function(e){s.unload(d)},error:function(t,a,o){if(0==t.readyState)r.error(e("Not connected to the server or the connection to the server has been closed."));else if(n.isUndefined(t.responseText))r.error("Unable to run pgagent job.");else{var l=i.parseJSON(t.responseText);0==l.success&&r.error(l.errormsg)}s.unload(d)}}),!1)}})),l.Nodes.pga_job}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(17),i(11),i(22),i(26)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c){r.Nodes["coll-pga_jobstep"]||(r.Nodes["coll-pga_jobstep"]=r.Collection.extend({node:"pga_jobstep",label:e("Steps"),type:"coll-pga_jobstep",columns:["jstid","jstname","jstenabled","jstkind","jstconntype","jstonerror"],hasStatistics:!1}));var p=c.Extension.SwitchCell.extend({initialize:function(){c.Extension.SwitchCell.prototype.initialize.apply(this,arguments),c.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e,t=this.model,i=this.column,n=this.column.get("editable"),o=this.$el.find("input[type=checkbox]").first(),l=i.get("name");return e=a.isFunction(n)?!!n.apply(i,[t]):!!n,e?(this.$el.addClass("editable"),o.bootstrapSwitch("disabled",!1)):(this.$el.removeClass("editable"),o.bootstrapSwitch("disabled",!0),setTimeout(function(){t.set(l,!0)},10)),this.delegateEvents(),this},remove:c.Extension.DependentCell.prototype.remove});return r.Nodes.pga_jobstep||(r.Nodes.pga_jobstep=r.Node.extend({parent_type:"pga_job",type:"pga_jobstep",dialogHelp:t("help.static",{filename:"pgagent_jobs.html"}),hasSQL:!0,hasDepends:!1,hasStatistics:!0,hasCollectiveStatistics:!0,width:"70%",height:"80%",canDrop:function(e){return!0},label:e("Step"),node_image:function(){return"icon-pga_jobstep"},Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_pga_jobstep_on_job",node:"pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Job Step..."),data:{action:"create"},icon:"wcTabIcon icon-pga_jobstep"},{name:"create_pga_jobstep_on_coll",node:"coll-pga_jobstep",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Job Step..."),data:{action:"create"},icon:"wcTabIcon icon-pga_jobstep"},{name:"create_pga_jobstep",node:"pga_jobstep",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Job Step..."),data:{action:"create"},icon:"wcTabIcon icon-pga_jobstep"}]))},model:r.Node.Model.extend({defaults:{jstid:null,jstjobid:null,jstname:"",jstdesc:"",jstenabled:!0,jstkind:!0,jstconntype:!0,jstcode:"",jstconnstr:null,jstdbname:null,jstonerror:"f",jstnextrun:""},initialize:function(){if(r.Node.Model.prototype.initialize.apply(this,arguments),this.isNew()&&this.get("jstconntype")){var e=arguments&&arguments.length>1&&arguments[1];e&&this.set("jstdbname",(e.node_info||e.collection.top.node_info).server.db)}},idAttribute:"jstid",schema:[{id:"jstid",label:e("ID"),type:"int",cellHeaderClasses:"width_percent_5",mode:["properties"]},{id:"jstname",label:e("Name"),type:"text",disabled:function(e){return!1},cellHeaderClasses:"width_percent_60"},{id:"jstenabled",label:e("Enabled?"),type:"switch",disabled:function(e){return!1}},{id:"jstkind",label:e("Kind"),type:"switch",options:{onText:e("SQL"),offText:e("Batch"),onColor:"primary",offColor:"primary"},control:d.SwitchControl,disabled:function(e){return!1}},{id:"jstconntype",label:e("Connection type"),type:"switch",deps:["jstkind"],mode:["properties"],disabled:function(e){return!e.get("jstkind")},options:{onText:e("Local"),offText:e("Remote"),onColor:"primary",offColor:"primary"}},{id:"jstconntype",label:e("Connection type"),type:"switch",deps:["jstkind"],mode:["create","edit"],disabled:function(e){return!e.get("jstkind")},cell:p,editable:function(e){return e.get("jstkind")},options:{onText:e("Local"),offText:e("Remote"),onColor:"primary",offColor:"primary"},helpMessage:e("Select <b>Local</b> if the job step will execute on the local database server, or <b>Remote</b> to specify a remote database server.")},{id:"jstdbname",label:e("Database"),type:"text",mode:["properties"],disabled:function(e){return!1}},{id:"jstconnstr",type:"text",mode:["properties"],label:e("Connection string")},{id:"jstdbname",label:e("Database"),type:"text",control:"node-list-by-name",node:"database",cache_node:"database",select2:{allowClear:!0,placeholder:""},disabled:function(e){return!e.get("jstkind")||!e.get("jstconntype")},deps:["jstkind","jstconntype"],mode:["create","edit"],helpMessage:e("Please select the database on which the job step will run.")},{id:"jstconnstr",label:e("Connection string"),type:"text",deps:["jstkind","jstconntype"],disabled:function(e){return!e.get("jstkind")||e.get("jstconntype")},helpMessage:o(e("Please specify the connection string for the remote database server. Each parameter setting is in the form keyword = value. Spaces around the equal sign are optional. To write an empty value, or a value containing spaces, surround it with single quotes, e.g., keyword = 'a value'. Single quotes and backslashes within the value must be escaped with a backslash, i.e., ' and \\.<br>For more information, please see the documentation on %s")).sprintf('<a href="https://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-CONNSTRING" target="_blank">libpq connection strings</a>').value(),mode:["create","edit"]},{id:"jstonerror",label:e("On error"),cell:"select2",control:"select2",options:[{label:e("Fail"),value:"f"},{label:e("Success"),value:"s"},{label:e("Ignore"),value:"i"}],select2:{allowClear:!1},disabled:function(e){return!1}},{id:"jstdesc",label:e("Comment"),type:"multiline"},n({id:"jstcode",label:"",cell:"string",deps:["jstkind"],type:"text",control:"sql-field",group:e("Code")},"control",d.SqlFieldControl.extend({render:function(){return this.model.get("jstkind")?this.field.set("label",e("SQL query")):this.field.set("label",e("Script")),d.SqlFieldControl.prototype.render.apply(this,arguments)}}))],validate:function(t){var i=this.get("jstname"),n=null;if(a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(n=e("Name cannot be empty."),this.errorModel.set("jstname",n)):this.errorModel.unset("jstname"),this.get("jstkind"))if(this.get("jstconntype"))if(this.errorModel.unset("jstconnstr"),i=this.get("jstdbname"),a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var l=e("Please select a database.");n=n||l,this.errorModel.set("jstdbname",l)}else this.errorModel.unset("jstdbname");else{this.errorModel.unset("jstdbname");var l,r=/\s*\b(\w+)\s*=\s*('([^'\\]*(?:\\.[^'\\]*)*)'|[\w|\.]*)/g;if(i=this.get("jstconnstr"),a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,""))l=e("Please enter a connection string.");else if(""!=String(i).replace(r,""))l=e("Please enter a valid connection string.");else for(var s,d={host:!0,hostaddr:!0,port:!0,dbname:!0,user:!0,password:!0,connect_timeout:!0,client_encoding:!0,application_name:!0,options:!0,fallback_application_name:!0,sslmode:!0,sslcert:!0,sslkey:!0,sslrootcert:!0,sslcrl:!0,keepalives:!0,service:!0,keepalives_idle:!0,keepalives_interval:!0,keepalives_count:!0,sslcompression:!0,requirepeer:!0,krbsrvname:!0,gsslib:!0};s=r.exec(i);){if(d[s[1]]){if(s[2])continue;l=e("Please enter a valid connection string.");break}l=o(e("Invalid parameter in the connection string - %s.")).sprintf(s[1]).value();break}l?(n=n||l,this.errorModel.set("jstconnstr",l)):this.errorModel.unset("jstconnstr")}else this.errorModel.unset("jstconnstr"),this.errorModel.unset("jstdbname");if(i=this.get("jstcode"),a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var l=e("Please specify code to execute.");n=n||l,this.errorModel.set("jstcode",l)}else this.errorModel.unset("jstcode");return n}})})),r.Nodes.pga_job}.apply(t,a))&&(e.exports=o)},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(46),i(6),i(8),i(17),i(22)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c){if(s.Nodes["coll-pga_schedule"]||(s.Nodes["coll-pga_schedule"]=s.Collection.extend({node:"pga_schedule",label:e("Schedules"),type:"coll-pga_schedule",columns:["jscid","jscname","jscenabled"],hasStatistics:!1})),!s.Nodes.pga_schedule){var p=[e("Sunday"),e("Monday"),e("Tuesday"),e("Wednesday"),e("Thursday"),e("Friday"),e("Saturday")],u=[e("1st"),e("2nd"),e("3rd"),e("4th"),e("5th"),e("6th"),e("7th"),e("8th"),e("9th"),e("10th"),e("11th"),e("12th"),e("13th"),e("14th"),e("15th"),e("16th"),e("17th"),e("18th"),e("19th"),e("20th"),e("21st"),e("22nd"),e("23rd"),e("24th"),e("25th"),e("26th"),e("27th"),e("28th"),e("29th"),e("30th"),e("31st"),e("Last day")],m=[e("January"),e("February"),e("March"),e("April"),e("May"),e("June"),e("July"),e("August"),e("September"),e("October"),e("November"),e("December")],g=[e("00"),e("01"),e("02"),e("03"),e("04"),e("05"),e("06"),e("07"),e("08"),e("09"),e("10"),e("11"),e("12"),e("13"),e("14"),e("15"),e("16"),e("17"),e("18"),e("19"),e("20"),e("21"),e("22"),e("23")],h=[e("00"),e("01"),e("02"),e("03"),e("04"),e("05"),e("06"),e("07"),e("08"),e("09"),e("10"),e("11"),e("12"),e("13"),e("14"),e("15"),e("16"),e("17"),e("18"),e("19"),e("20"),e("21"),e("22"),e("23"),e("24"),e("25"),e("26"),e("27"),e("28"),e("29"),e("30"),e("31"),e("32"),e("33"),e("34"),e("35"),e("36"),e("37"),e("38"),e("39"),e("40"),e("41"),e("42"),e("43"),e("44"),e("45"),e("46"),e("47"),e("48"),e("49"),e("50"),e("51"),e("52"),e("53"),e("54"),e("55"),e("56"),e("57"),e("58"),e("59")],b=n.Extension.MomentCell.extend({editor:n.Extension.DatetimePickerEditor,render:function(){this.$el.empty();var t=this.model;return this.$el.text(this.formatter.fromRaw(t.get(this.column.get("name")),t)||e("<any>")),this.delegateEvents(),this}}),f=n.Extension.MomentCell.extend({editor:n.Extension.DatetimePickerEditor}),_=function(e,t){var i=this;return i.selector=e,i.indexes=t,this.fromRaw=function(e){if(!a.isArray(e))return e;for(var t=[],n=0,o=[];n<e.length;n++)e[n]&&(t.push(i.selector[n]),o.push(n+1));return i.indexes?o:t.join(", ")},this.toRaw=function(e){if(!i.indexes)return e;for(var t=[],n=0,o=i.selector.length;n<o;n++)t.push(-1!=a.indexOf(e,String(n+1)));return t},i},v=function(e){var t=e.field.get("selector"),i=e.model.get(e.field.get("name")),n=[];return t&&(n=a.map(t,function(e,t){return{label:e,value:t+1,selected:i[t]}})),n},y=s.Node.Model.extend({defaults:{jexid:void 0,jexdate:null,jextime:null},idAttribute:"jexid",schema:[{id:"jexdate",type:"text",label:e("Date"),editable:!0,placeholder:e("<any>"),cell:b,options:{format:"YYYY-MM-DD"},displayFormat:"YYYY-MM-DD",modelFormat:"YYYY-MM-DD",cellHeaderClasses:"width_percent_50",allowEmpty:!0},{id:"jextime",type:"text",placeholder:e("<any>"),label:e("Time"),editable:!0,cell:b,options:{format:"HH:mm"},displayFormat:"HH:mm",modelFormat:"HH:mm:ss",displayInUTC:!1,allowEmpty:!0,cellHeaderClasses:"width_percent_50",modalInUTC:!1}],validate:function(){var t,i=this,n=this.collection,a=!1,o=this.get("jexdate")||"<any>",l=this.get("jextime")||"<any>",r=this.get("jexid")||this.cid;return i.errorModel.unset("jscdate"),o==l&&"<any>"==o?(t=e("Please specify date/time."),i.errorModel.set("jscdate",t),t):(n.each(function(n){a||r==(n.get("jexid")||n.cid)||o==(n.get("jexdate")||"<any>")&&l==(n.get("jextime")||"<any>")&&(t=e("Please specify unique set of exceptions."),n.errorModel.get("jscdate")!=t&&i.errorModel.set("jscdate",t),a=!0)}),t)}});s.Nodes.pga_schedule=s.Node.extend({parent_type:"pga_job",type:"pga_schedule",dialogHelp:t("help.static",{filename:"pgagent_jobs.html"}),hasSQL:!0,hasDepends:!1,hasStatistics:!1,canDrop:function(e){return!0},label:e("Schedule"),node_image:"icon-pga_schedule",Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_pga_schedule_on_job",node:"pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schedule..."),icon:"wcTabIcon icon-pga_schedule",data:{action:"create"}},{name:"create_pga_schedule_on_coll",node:"coll-pga_schedule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schedule..."),icon:"wcTabIcon icon-pga_schedule",data:{action:"create"}},{name:"create_pga_schedule",node:"pga_schedule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schedule..."),icon:"wcTabIcon icon-pga_schedule",data:{action:"create"}}]))},model:s.Node.Model.extend({defaults:{jscid:null,jscjobid:null,jscname:"",jscdesc:"",jscenabled:!0,jscstart:null,jscend:null,jscweekdays:a.map(p,function(){return!1}),jscmonthdays:a.map(u,function(){return!1}),jscmonths:a.map(m,function(){return!1}),jschours:a.map(g,function(){return!1}),jscminutes:a.map(h,function(){return!1}),jscexceptions:[]},idAttribute:"jscid",parse:function(e){if(e.jscexceptions=[],e.jexid&&e.jexid.length)for(var t=0;t<e.jexid.length;t++)e.jscexceptions.push({jexid:e.jexid[t],jexdate:e.jexdate[t],jextime:e.jextime[t]});return delete e.jexid,delete e.jexdate,delete e.jextime,s.Node.Model.prototype.parse.apply(this,arguments)},schema:[{id:"jscid",label:e("ID"),type:"int",cellHeaderClasses:"width_percent_5",mode:["properties"]},{id:"jscname",label:e("Name"),type:"text",cellHeaderClasses:"width_percent_45",disabled:function(){return!1}},{id:"jscenabled",label:e("Enabled?"),type:"switch",disabled:function(){return!1},cellHeaderClasses:"width_percent_5"},{id:"jscstart",label:e("Start"),type:"text",control:"datetimepicker",cell:f,disabled:function(){return!1},displayInUTC:!1,displayFormat:"YYYY-MM-DD HH:mm:ss Z",modelFormat:"YYYY-MM-DD HH:mm:ss Z",options:{format:"YYYY-MM-DD HH:mm:ss Z",minDate:r().add(0,"m")},cellHeaderClasses:"width_percent_25"},{id:"jscend",label:e("End"),type:"text",control:"datetimepicker",cell:f,disabled:function(){return!1},displayInUTC:!1,displayFormat:"YYYY-MM-DD HH:mm:ss Z",options:{format:"YYYY-MM-DD HH:mm:ss Z",useCurrent:!1,minDate:r().add(0,"m")},cellHeaderClasses:"width_percent_25",modelFormat:"YYYY-MM-DD HH:mm:ss Z"},{id:"jscweekdays",label:e("Week days"),type:"text",control:c.Control.extend({formatter:new _(p,!1)}),mode:["properties"]},{id:"jscmonthdays",label:e("Month days"),type:"text",control:c.Control.extend({formatter:new _(u,!1)}),mode:["properties"]},{id:"jscmonths",label:e("Months"),type:"text",control:c.Control.extend({formatter:new _(m,!1)}),mode:["properties"]},{id:"jschours",label:e("Hours"),type:"text",control:c.Control.extend({formatter:new _(g,!1)}),mode:["properties"]},{id:"jscminutes",label:e("Minutes"),type:"text",control:c.Control.extend({formatter:new _(h,!1)}),mode:["properties"]},{id:"jscexceptions",label:e("Exceptions"),type:"text",control:c.Control.extend({formatter:new function(){return this.fromRaw=function(e){var t,i="",n=0;if(!e)return i;for(;n<e.length;n++)t=e[n],n&&(i+=", "),i+="["+String((t.jexdate||"")+" "+(t.jextime||"")).replace(/^\s+|\s+$/g,"")+"]";return i},this.toRaw=function(e){return e},this}}),mode:["properties"]},{type:"nested",label:e("Days"),group:e("Repeat"),mode:["create","edit"],control:c.FieldsetControl.extend({render:function(){var t=c.FieldsetControl.prototype.render.apply(this,arguments);return this.$el.prepend('<div class="set-group pg-el-xs-12 '+c.helpMessageClassName+'">'+e("Schedules are specified using a <b>cron-style</b> format.<br/><ul><li>For each selected time or date element, the schedule will execute.<br/>e.g. To execute at 5 minutes past every hour, simply select ‘05’ in the Minutes list box.<br/></li><li>Values from more than one field may be specified in order to further control the schedule.<br/>e.g. To execute at 12:05 and 14:05 every Monday and Thursday, you would click minute 05, hours 12 and 14, and weekdays Monday and Thursday.</li><li>For additional flexibility, the Month Days check list includes an extra Last Day option. This matches the last day of the month, whether it happens to be the 28th, 29th, 30th or 31st.</li></ul>")+"</div>"),t}}),schema:[{id:"jscweekdays",label:e("Week Days"),cell:"select2",group:e("Days"),control:"select2",select2:{first_empty:!1,multiple:!0,allowClear:!0,placeholder:e("Select the weekdays..."),width:"style",dropdownAdapter:i.fn.select2.amd.require("select2/selectAllAdapter")},selector:p,formatter:new _(p,!0),options:v},{id:"jscmonthdays",label:e("Month Days"),cell:"select2",group:e("Days"),control:"select2",select2:{first_empty:!1,multiple:!0,allowClear:!0,placeholder:e("Select the month days..."),width:"style",dropdownAdapter:i.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(u,!0),selector:u,options:v},{id:"jscmonths",label:e("Months"),cell:"select2",group:e("Days"),control:"select2",select2:{first_empty:!1,multiple:!0,allowClear:!0,placeholder:e("Select the months..."),width:"style",dropdownAdapter:i.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(m,!0),selector:m,options:v}]},{type:"nested",control:"fieldset",label:e("Times"),group:e("Repeat"),mode:["create","edit"],schema:[{id:"jschours",label:e("Hours"),cell:"select2",group:e("Times"),control:"select2",select2:{first_empty:!1,multiple:!0,allowClear:!0,placeholder:e("Select the hours..."),width:"style",dropdownAdapter:i.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(g,!0),selector:g,options:v},{id:"jscminutes",label:e("Minutes"),cell:"select2",group:e("Times"),control:"select2",select2:{first_empty:!1,multiple:!0,allowClear:!0,placeholder:e("Select the minutes..."),width:"style",dropdownAdapter:i.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(h,!0),selector:h,options:v}]},{id:"jscexceptions",type:"collection",mode:["edit","create"],label:"",canEdit:!1,model:y,canAdd:!0,group:e("Exceptions"),canDelete:!0,cols:["jexdate","jextime"],control:"sub-node-collection"},{id:"jscdesc",label:e("Comment"),type:"multiline"}],validate:function(t){var i=this.get("jscname"),n=null;if(a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var o=e("Name cannot be empty.");this.errorModel.set("jscname",o),n=o}else this.errorModel.unset("jscname");if(i=this.get("jscstart"),a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var o=e("Please enter the start time.");this.errorModel.set("jscstart",o),n=n||o}else this.errorModel.unset("jscstart");if(i=this.get("jscend"),a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var o=e("Please enter the end time.");this.errorModel.set("jscend",o),n=n||o}else this.errorModel.unset("jscend");if(!n){var l=this.get("jscstart"),s=this.get("jscend"),d=l.split(" "),c=s.split(" ");d=r(d[0]+" "+d[1]),c=r(c[0]+" "+c[1]),c.isBefore(d)&&(n=e("Start time must be less than end time"),this.errorModel.set("jscstart",n))}return n}})})}return s.Nodes.pga_schedule}.apply(t,a))&&(e.exports=o)}).call(t,i(11))},function(e,t,i){"use strict";var n,a,o=o||{};o.dashboard=i(266);var o=o||{};o.tools={},o.tools.user_management=i(270);var o=o||{};o.browser={},o.browser.object_statistics=i(271);var o=o||{};o.browser={},o.browser.object_depends=i(273);var o=o||{};o.browser={},o.browser.object_sql=i(274);var o=o||{};o.browser={},o.browser.bgprocess=i(275);var o=o||{};o.node={},o.node.server_group=i(276);var o=o||{};o.node={},o.node.server=i(188);var o=o||{};o.node={},o.node.database=i(277);var o=o||{};o.node={},o.node.role=i(278);var o=o||{};o.node={},o.node.cast=i(279);var o=o||{};o.node={},o.node.tablespace=i(280);var o=o||{};o.node={},o.node.resource_group=i(281);var o=o||{};o.node={},o.node.event_trigger=i(282);var o=o||{};o.node={},o.node.extension=i(283);var o=o||{};o.node={},o.node.language=i(284);var o=o||{};o.node={},o.node.foreign_data_wrapper=i(285);var o=o||{};o.node={},o.node.foreign_server=i(286);var o=o||{};o.node={},o.node.user_mapping=i(287);var o=o||{};o.node={},o.node.schema=i(288);var o=o||{};o.node={},o.node.catalog=i(289);var o=o||{};o.node={},o.node.catalog_object=i(290);var o=o||{};o.node={},o.node.collation=i(291);var o=o||{};o.node={},o.node.domain=i(292);var o=o||{};o.node={},o.node.domain_constraints=i(293);var o=o||{};o.node={},o.node.foreign_table=i(294);var o=o||{};o.node={},o.node.fts_configuration=i(295);var o=o||{};o.node={},o.node.fts_dictionary=i(296);var o=o||{};o.node={},o.node.fts_parser=i(297);var o=o||{};o.node={},o.node.fts_template=i(298);var o=o||{};o.node={},o.node.function=i(191);var o=o||{};o.node={},o.node.procedure=i(299);var o=o||{};o.node={},o.node.edbfunc=i(192);var o=o||{};o.node={},o.node.edbproc=i(300);var o=o||{};o.node={},o.node.edbvar=i(301);var o=o||{};o.node={},o.node.trigger_function=i(302);var o=o||{};o.node={},o.node.package=i(303);var o=o||{};o.node={},o.node.sequence=i(304);var o=o||{};o.node={},o.node.synonym=i(305);var o=o||{};o.node={},o.node.type=i(306);var o=o||{};o.node={},o.node.rule=i(193);var o=o||{};o.node={},o.node.index=i(307);var o=o||{};o.node={},o.node.trigger=i(308);var o=o||{};o.node={},o.node.catalog_object_column=i(309);var o=o||{};o.node={},o.node.view=i(310);var o=o||{};o.node={},o.node.mview=i(311);var o=o||{};o.node={},o.node.table=i(312);var o=o||{};o.node={},o.node.partition=i(320),n=[i(2),i(5),i(0),i(1),i(15),i(3),i(28),i(158),i(29)],void 0!==(a=function(e,t,i,n,a,o,l,r){var s=window.wcDocker,d=o.Browser,c=l.default;return o.DataGrid?o.DataGrid:(o.DataGrid={init:function(){if(!this.initialized){this.initialized=!0,this.title_index=1,this.spinner_el='<div class="wcLoadingContainer"><div class="wcLoadingBackground"></div><div class="wcLoadingIconContainer"><i class="wcLoadingIcon fa fa-spinner fa-pulse"></i></div></div>';for(var t=["table","view","mview","foreign_table","catalog_object","partition"],i=function(e){return!n.isUndefined(e)&&!n.isNull(e)&&-1!==n.indexOf(t,e._type)},a=function(e){return!n.isUndefined(e)&&!n.isNull(e)&&(-1==n.indexOf(o.unsupported_nodes,e._type)&&(!("database"!=e._type||!e.allowConn)||"database"!=e._type))},l=[{name:"query_tool",module:this,applies:["tools"],callback:"show_query_tool",enable:a,priority:1,label:e("Query Tool"),icon:"fa fa-bolt"}],r=0;r<t.length;r++)l.push({name:"view_all_rows_context_"+t[r],node:t[r],module:this,data:{mnuid:3},applies:["context","object"],callback:"show_data_grid",enable:i,category:"view_data",priority:101,label:e("All Rows")},{name:"view_first_100_rows_context_"+t[r],node:t[r],module:this,data:{mnuid:1},applies:["context","object"],callback:"show_data_grid",enable:i,category:"view_data",priority:102,label:e("First 100 Rows")},{name:"view_last_100_rows_context_"+t[r],node:t[r],module:this,data:{mnuid:2},applies:["context","object"],callback:"show_data_grid",enable:i,category:"view_data",priority:103,label:e("Last 100 Rows")},{name:"view_filtered_rows_context_"+t[r],node:t[r],module:this,data:{mnuid:4},applies:["context","object"],callback:"show_filtered_row",enable:i,category:"view_data",priority:104,label:e("Filtered Rows...")});o.Browser.add_menu_category("view_data",e("View/Edit Data"),100,""),o.Browser.add_menus(l);new o.Browser.Frame({name:"frm_datagrid",showTitle:!0,isCloseable:!0,isPrivate:!0,url:"about:blank"}).load(d.docker)}},show_data_grid:function(i,n){var l=this,r=o.Browser.tree.itemData(n);if(void 0===r)return void a.alert(e("Data Grid Error"),e("No object selected."));var s=d.Nodes[r._type],c=s.getTreeNodeHierarchy(n);if(void 0!==c.server&&void 0!==c.database&&(void 0!==c.schema||void 0!==c.view||void 0!==c.catalog)){var p="";void 0!=c.schema?p=c.schema.label:void 0!=c.view?p=c.view.label:void 0!=c.catalog&&(p=c.catalog.label);var u={cmd_type:i.mnuid,obj_type:r._type,sid:c.server._id,did:c.database._id,obj_id:r._id},m=t("datagrid.initialize_datagrid",u),g=c.server.label+" - "+c.database.label+" - "+p+"."+r.label;l.initialize_data_grid(m,g,"",c.server.server_type)}},show_filtered_row:function(n,l){var r=this,s=o.Browser.tree.itemData(l);if(void 0===s)return void a.alert(e("Data Grid Error"),e("No object selected."));var p=d.Nodes[s._type],u=p.getTreeNodeHierarchy(l);if(void 0!==u.server&&void 0!==u.database&&(void 0!==u.schema||void 0!==u.view||void 0!==u.catalog)){var m="";void 0!=u.schema?m=u.schema.label:void 0!=u.view?m=u.view.label:void 0!=u.catalog&&(m=u.catalog.label);var g={cmd_type:n.mnuid,obj_type:s._type,sid:u.server._id,did:u.database._id,obj_id:s._id},h=t("datagrid.initialize_datagrid",g),b=t("datagrid.filter_validate",{sid:g.sid,did:g.did,obj_id:g.obj_id}),f=u.server.label+"-"+u.database.label+"-"+m+"."+s.label;a.filterDialog||a.dialog("filterDialog",function(){return{main:function(e,t,i,n){this.set("title",e),this.message=t,this.baseUrl=i,this.validateUrl=n},setup:function(){return{buttons:[{text:"OK",className:"btn btn-primary"},{text:"Cancel",className:"btn btn-danger"}],options:{modal:0,resizable:!0,maximizable:!1,pinnable:!1}}},build:function(){a.pgDialogBuild.apply(this)},prepare:function(){var e=this,t=i(this.message),n=t.find("#sql_filter");i(this.elements.body.childNodes[0]).addClass("dataview_filter_dialog"),this.setContent(t.get(0)),this.filter_obj=c.fromTextArea(n.get(0),{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:d.editor_shortcut_keys,indentWithTabs:o.Browser.editor_options.indent_with_tabs,indentUnit:o.Browser.editor_options.tabSize,tabSize:d.editor_options.tabSize,lineWrapping:o.Browser.editor_options.wrapCode,autoCloseBrackets:o.Browser.editor_options.insert_pair_brackets,matchBrackets:o.Browser.editor_options.brace_matching}),setTimeout(function(){e.filter_obj.focus()},500)},callback:function(t){if(t.button.text==e("OK")){var n=this.filter_obj.getValue(),o=this;i.ajax({url:o.validateUrl,method:"POST",async:!1,contentType:"application/json",data:JSON.stringify(n),success:function(t){t.data.status?r.initialize_data_grid(o.baseUrl,f,n,u.server.server_type):a.alert(e("Validation Error"),t.data.result)},error:function(t){a.alert(e("Validation Error"),t)}})}}}});i.get(t("datagrid.filter"),function(e){a.filterDialog("Data Filter",e,h,b).resizeTo(300,200)})}},get_panel_title:function(){var e=o.Browser.tree,t=e.selected(),i=e.itemData(t),n=d.Nodes[i._type],a=n.getTreeNodeHierarchy(t);if(void 0!==a.server){return(a.database?a.database.label:a.server.db)+" on "+a.server.user.name+"@"+a.server.label}},initialize_data_grid:function(n,o,l,r){var c=this;c.grid_title=o,i.ajax({url:n,method:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(l),success:function(n){var a={trans_id:n.data.gridTransId,is_query_tool:"false",editor_title:encodeURIComponent(c.grid_title)},o=t("datagrid.panel",a)+"?query_url=&server_type="+encodeURIComponent(r),l=e("Edit Data - ")+c.grid_title;if(n.data.newBrowserTab){var p=window.open(o,"_blank");p.addEventListener("load",function(){p.document.title=l})}else{var u=d.docker.findPanels("properties"),m=d.docker.addPanel("frm_datagrid",s.DOCK.STACKED,u[0]);m.title('<span title="'+l+'">'+l+"</span>"),m.icon("fa fa-bolt"),m.focus(),m.on(s.EVENT.CLOSED,function(){i.ajax({url:t("datagrid.close",{trans_id:n.data.gridTransId}),method:"GET"})});!function e(t){i(t).data("embeddedFrame").$container.append(c.spinner_el),setTimeout(function(){if(i(t).data("frameInitialized")){var n=i(t).data("embeddedFrame");n&&(n.openURL(o),n.$container.find(".wcLoadingContainer").hide(1))}else e(t)},100)}(m)}},error:function(t){a.alert(e("Error"),e("Query Tool Initialization Error"))}})},show_query_tool:function(n,l,c){var p=this,u=n||"",c=c||"",m=o.Browser.tree.itemData(l);if(void 0===m)return void a.alert(e("Query Tool Error"),e("No object selected."));var g=d.Nodes[m._type],h=g.getTreeNodeHierarchy(l);if(void 0!==h.server){var b={sid:h.server._id},f="datagrid.initialize_query_tool";h.database&&(b.did=h.database._id,f="datagrid.initialize_query_tool_with_did");var _=t(f,b);i.ajax({url:_,method:"POST",dataType:"json",contentType:"application/json",success:function(n){var a=p.get_panel_title(),l={trans_id:n.data.gridTransId,is_query_tool:"true",editor_title:encodeURIComponent(a)},m=t("datagrid.panel",l)+"?query_url="+encodeURI(u)+"&server_type="+encodeURIComponent(h.server.server_type);if(c=c?r.capitalizeFirstLetter(c)+" script":e("Query - ")+a,n.data.newBrowserTab){var g=window.open(m,"_blank");g.addEventListener("load",function(){g.document.title=c})}else{var b=d.docker.findPanels("properties"),f=d.docker.addPanel("frm_datagrid",s.DOCK.STACKED,b[0]);f.title('<span title="'+c+'">'+c+"</span>"),f.icon("fa fa-bolt"),f.focus(),f.on(s.EVENT.CLOSED,function(){i.ajax({url:t("datagrid.close",{trans_id:n.data.gridTransId}),method:"GET"})});!function e(t){i(t).data("embeddedFrame").$container.append(o.DataGrid.spinner_el),setTimeout(function(){if(i(t).data("frameInitialized")){var n=i(t).data("embeddedFrame");n&&(n.openURL(m),n.$container.find(".wcLoadingContainer").delay(1e3).hide(1))}else e(t)},100)}(f)}},error:function(t){a.alert(e("Query Tool Initialize Error"))}})}}},o.DataGrid)}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(5),i(2),i,i(0),i(1),i(3),i(10),i(11),i(267),i(15),i(156),i(6),i(183),i(29)],void 0!==(a=function(e,t,n,a,o,l,r,s,d,c){var p=(window.wcDocker,l.Browser);if(!l.Dashboard){var u,m,g=!0,h="",b="",f=!1,_=!1,v=!1,y=s.Extension.DeleteCell.extend({render:function(){return this.$el.empty(),"cancel"===this.column.get("cell_action")?this.$el.html("<i class='fa fa-stop' data-toggle='tooltip' title='"+t("Cancel the active query")+"'></i>"):this.$el.html("<i class='fa fa-times-circle' data-toggle='tooltip' title='"+t("Terminate the session")+"'></i>"),this.delegateEvents(),this},deleteRow:function(e){var i,n,o,l,r,d=this,p=d.column.get("cell_action");if(e.preventDefault(),s.callByNeed(d.column.get("canDeleteRow"),d.column,d.model)){var u=function(){_?a("#btn_server_activity_refresh").click():v&&a("#btn_database_activity_refresh").click()};"cancel"===p?(i=t("Cancel Active Query?"),n=t("Are you sure you wish to cancel the active query?"),o=t("Active query cancelled successfully."),l=t("An error occurred whilst cancelling the active query."),r=h+d.model.get("pid")):(i=t("Terminate Session?"),n=t("Are you sure you wish to terminate the session?"),o=t("Session terminated successfully."),l=t("An error occurred whilst terminating the active query."),r=b+d.model.get("pid")),c.confirm(i,n,function(e){a.ajax({url:r,type:"DELETE",success:function(e){e==t("Success")?(c.success(o),u()):c.error(l)},error:function(e,t,i){try{var n=a.parseJSON(e.responseText);0==n.success&&c.error(n.errormsg)}catch(e){}}})},function(e){return!0})}}}),w=s.Extension.ObjectCell.extend({enterEditMode:function(){this.model.trigger("enteringEditMode",[this]),s.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents(),s.callByNeed(this.column.editable(),this.column,this.model)&&(this.$el.html("<i class='fa fa-caret-down subnode-edit-in-process'></i>"),this.model.trigger("pg-sub-node:opened",this.model,this))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-caret-right' data-toggle='tooltip' title='"+t("View the active session details")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.focus(),this}}),x=r.Model.extend({defaults:{version:null},schema:[{id:"backend_type",label:t("Backend type"),type:"text",editable:!0,disabled:!0,group:t("Details"),visible:function(e){return this.version>=1e5}},{id:"query_start",label:t("Query started at"),type:"text",editable:!1,disabled:!0,group:t("Details")},{id:"state_change",label:t("Last state changed at"),type:"text",editable:!0,disabled:!0,group:t("Details")},{id:"query",label:t("SQL"),type:"text",editable:!0,disabled:!0,control:Backform.SqlFieldControl,group:t("Details")}]});return l.Dashboard={init:function(){if(!this.initialized){this.initialized=!0;var i=this.object_selected.bind(this),n=this.object_disconnected.bind(this);p.Events.on("pgadmin-browser:tree:selected",i),p.Events.on("pgadmin:server:disconnect",n);var o=e("dashboard.index"),l=p.panels.dashboard.panel;if(l){var r=l.layout().scene().find(".pg-panel-content");r&&(a.ajax({url:o,type:"GET",dataType:"html",success:function(e){a(r).html(e)},error:function(e,i){a(r).html('<div class="alert alert-danger pg-panel-message" role="alert">'+t("An error occurred whilst loading the dashboard.")+"</div>")}}),a(l).data("sid",-1),a(l).data("did",-1))}}},object_disconnected:function(e){this.object_selected(e.item,e.data,p.Nodes[e.data._type])},object_selected:function(i,n,r){if(n&&n._type&&g){var s=r.getTreeNodeHierarchy(i),d=e("dashboard.index"),c=-1,y=-1,w=l.Browser,x=w&&w.Nodes[n._type];h=e("dashboard.index")+"cancel_query/",b=e("dashboard.index")+"terminate_session/";var C=s.server;m=C&&C.db||null,C&&C.user&&C.user.is_superuser?f=!0:(f=!1,u=C&&C.user?C.user.name:null),x&&x.dashboard?d=o.isFunction(x.dashboard)?x.dashboard.apply(i,n,r,s):x.dashboard:"database"in s?(c=s.server._id,y=s.database._id,_=!1,v=!0,d+=c+"/"+y,h+=c+"/"+y+"/",b+=c+"/"+y+"/"):"server"in s&&(c=s.server._id,_=!0,v=!1,d+=c,h+=c+"/",b+=c+"/");var N=p.panels.dashboard.panel;if(N){var D=N.layout().scene().find(".pg-panel-content");D&&(n.connected||o.isUndefined(n.connected)?(d!=a(N).data("dashboard_url")||d==a(N).data("dashboard_url")&&0==a(N).data("server_status"))&&(a(D).empty(),a.ajax({url:d,type:"GET",dataType:"html",success:function(e){a(D).html(e)},error:function(e,i){a(D).html('<div class="alert alert-danger pg-panel-message" role="alert">'+t("An error occurred whilst loading the dashboard.")+"</div>")}}),a(N).data("server_status",!0)):(a(D).empty(),a(D).html('<div class="alert alert-info pg-panel-message" role="alert">'+t("Please connect to the selected server to view the dashboard.")+"</div>"),a(N).data("server_status",!1)),a(N).data("dashboard_url",d))}}},render_chart:function(e,i,n,r,s,c,u,m,h){if(g){var b=0;if(0==n.length)if(1==m)if(o.isUndefined(a(e).data("counter_previous_vals")))a(e).data("counter_previous_vals",i[0]);else for(var f in i[0])n.push({data:[[0,i[0][f]-a(e).data("counter_previous_vals")[f]]],label:f});else for(var f in i[0])n.push({data:[[0,i[0][f]]],label:f});else{for(var f in i[0]){if(0==m)n[b].data.unshift([0,i[0][f]]);else{if(o.isUndefined(a(e).data("counter_previous_vals")))return;n[b].data.unshift([0,i[0][f]-a(e).data("counter_previous_vals")[f]])}for(var _=0;_<n[b].data.length;_++)n[b].data[_][0]=_;b++}a(e).data("counter_previous_vals",i[0])}for(f=0;f<n.length;f++)n[f].data.length>101&&n[f].data.pop();var v=p.panels.dashboard.panel,y=v.layout().scene().find(".pg-panel-content");if(a(y).find(e).length){e.clientHeight>0&&e.clientWidth>0&&d.draw(e,n,u);var w=function d(){var p=c+r;-1!=s&&(p+="/"+s),a.ajax({url:p,type:"GET",dataType:"html",success:function(t){a(e).removeClass("graph-error"),i=JSON.parse(t),l.Dashboard.render_chart(e,i,n,r,s,c,u,m,h)},error:function(i,n,l){var r,s=a.parseJSON(i.responseText),l=s.errormsg;428==i.status?((o.isUndefined(l)||o.isNull(l))&&(l=t("Please connect to the selected server to view the graph.")),r="info"):(l=t("An error occurred whilst rendering the graph."),r="danger"),a(e).addClass("graph-error"),a(e).html('<div class="alert alert-'+r+' pg-panel-message" role="alert">'+l+"</div>"),e.clientHeight>0&&e.clientWidth>0&&setTimeout(d,1e3*h)}})};setTimeout(w,1e3*h)}}},add_new_server:function(){if(p&&p.tree){for(var e=0!=p.tree.selected().length?p.tree.selected():p.tree.first(null,!1),t=i(188),n=p.tree.itemData(e);n&&"server_group"!=n._type;)e=p.tree.next(e),n=p.tree.itemData(e);if(!n)return;t&&t.callbacks.show_obj_properties.apply(t,[{action:"create"},e])}},render_grid:function(e,t,i,n,o){var l=r.Model.extend({}),d=n+t;-1!=i&&(d+="/"+i);var c=r.Collection.extend({model:l,url:d,mode:"client"}),p=new c,u=new s.Grid({columns:o,collection:p,className:"backgrid table-bordered presentation table backgrid-striped"});a(e).append(u.render().el);var m=new s.Extension.ClientSideFilter({collection:p});a("#"+e.id+"_filter").before(m.render().el),a(m.el).css({float:"right",margin:"5px","margin-right":"2px","margin-top":"3px"}),a(e).data("data",p),a(e).data("grid",u),a(e).data("filter",m)},render_grid_data:function(e){var i=a(e).data("data"),n=a(e).data("grid"),r=a(e).data("filter");if(o.isUndefined(i))return null;i.fetch({reset:!0,success:function(){a(e).hasClass("grid-error")&&(a(e).removeClass("grid-error"),a(e).html(n.render().el),a(r.el).show()),r.search()},error:function(n,s,d){var c,p=a.parseJSON(s.responseText),u=p.errormsg;428==s.status?((o.isUndefined(u)||o.isNull(u))&&(u=t("Please connect to the selected server to view the table.")),c="info"):(u=t("An error occurred whilst rendering the table."),c="danger"),a(e).hasClass("grid-error")||(a(r.el).hide(),a(e).addClass("grid-error")),a(e).html('<div class="alert alert-'+c+' pg-panel-message" role="alert">'+u+"</div>"),setTimeout(function(){l.Dashboard.render_grid_data(e,i)},5e3)}})},init_server_dashboard:function(i,n,r,s,d,c,p){var u=a(".dashboard-container").find("#graph-sessions")[0],m=a(".dashboard-container").find("#graph-tps")[0],g=a(".dashboard-container").find("#graph-ti")[0],h=a(".dashboard-container").find("#graph-to")[0],b=a(".dashboard-container").find("#graph-bio")[0],f=a(".dashboard-container").find("#server_activity"),_=a(".dashboard-container").find("#server_locks"),v=a(".dashboard-container").find("#server_prepared"),C=a(".dashboard-container").find("#server_config"),N=[],D=[],k=[],S=[],T=[],j=[],M=[],E=[],P=[],U=[],I={parseFloat:!1,xaxis:{min:100,max:0,autoscale:0},yaxis:{autoscale:1},legend:{position:"nw",backgroundColor:"#D2E8FF"}},O=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"datname",label:t("Database"),editable:!1,cell:"string"},{name:"usename",label:t("User"),editable:!1,cell:"string"},{name:"application_name",label:t("Application"),editable:!1,cell:"string"},{name:"client_addr",label:t("Client"),editable:!1,cell:"string"},{name:"backend_start",label:t("Backend start"),editable:!1,cell:"string"},{name:"state",label:t("State"),editable:!1,cell:"string"}];O=n<90600?O.concat([{name:"waiting",label:t("Waiting?"),editable:!1,cell:"string"}]):O.concat([{name:"wait_event",label:t("Wait Event"),editable:!1,cell:"string"},{name:"blocking_pids",label:t("Blocking PIDs"),editable:!1,cell:"string"}]);var A=new x,q=Backform.generateViewSchema(null,A,"create",null,null,!0);o.each(q[0].fields,function(e){e.version=n}),O.unshift({name:"pg-backform-expand",label:"",cell:w,cell_priority:-1,postgres_version:n,schema:q}),O.unshift({name:"pg-backform-delete",label:"",cell:y,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:n}),O.unshift({name:"pg-backform-delete",label:"",cell:y,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:n});var B=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"datname",label:t("Database"),editable:!1,cell:"string"},{name:"locktype",label:t("Lock type"),editable:!1,cell:"string"},{name:"relation",label:t("Target relation"),editable:!1,cell:"string"},{name:"page",label:t("Page"),editable:!1,cell:"string"},{name:"tuple",label:t("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:t("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:t("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:t("Class"),editable:!1,cell:"string"},{name:"objid",label:t("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:t("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:t("Mode"),editable:!1,cell:"string"},{name:"granted",label:t("Granted?"),editable:!1,cell:"string"}],z=[{name:"git",label:t("Name"),editable:!1,cell:"string"},{name:"database",label:t("Database"),editable:!1,cell:"string"},{name:"Owner",label:t("Owner"),editable:!1,cell:"string"},{name:"transaction",label:t("XID"),editable:!1,cell:"string"},{name:"prepared",label:t("Prepared at"),editable:!1,cell:"string"}],L=[{name:"name",label:t("Name"),editable:!1,cell:"string"},{name:"category",label:t("Category"),editable:!1,cell:"string"},{name:"setting",label:t("Setting"),editable:!1,cell:"string"},{name:"unit",label:t("Unit"),editable:!1,cell:"string"},{name:"short_desc",label:t("Description"),editable:!1,cell:"string"}];l.Dashboard.render_chart(u,D,N,i,-1,e("dashboard.session_stats"),I,!1,r),l.Dashboard.render_chart(m,S,k,i,-1,e("dashboard.tps_stats"),I,!0,s),l.Dashboard.render_chart(g,j,T,i,-1,e("dashboard.ti_stats"),I,!0,d),l.Dashboard.render_chart(h,E,M,i,-1,e("dashboard.to_stats"),I,!0,c),l.Dashboard.render_chart(b,U,P,i,-1,e("dashboard.bio_stats"),I,!0,p),a(f).addClass("pg-el-container"),a(f).attr("el","sm"),l.Dashboard.render_grid(f,i,-1,e("dashboard.activity"),O),l.Dashboard.render_grid(_,i,-1,e("dashboard.locks"),B),l.Dashboard.render_grid(v,i,-1,e("dashboard.prepared"),z),l.Dashboard.render_grid(C,i,-1,e("dashboard.config"),L),l.Dashboard.render_grid_data(f),a('a[data-toggle="tab"]').on("shown.bs.tab",function(e){switch(a(e.target).attr("aria-controls")){case"tab_server_activity":l.Dashboard.render_grid_data(f);break;case"tab_server_locks":l.Dashboard.render_grid_data(_);break;case"tab_server_prepared":l.Dashboard.render_grid_data(v);break;case"tab_server_config":l.Dashboard.render_grid_data(C)}}),a("button").click(function(e){switch(this.id){case"btn_server_activity_refresh":l.Dashboard.render_grid_data(f);break;case"btn_server_locks_refresh":l.Dashboard.render_grid_data(_);break;case"btn_server_prepared_refresh":l.Dashboard.render_grid_data(v);break;case"btn_server_config_refresh":l.Dashboard.render_grid_data(C)}})},init_database_dashboard:function(i,n,r,s,d,c,p,u){var m=document.getElementById("graph-sessions"),g=document.getElementById("graph-tps"),h=document.getElementById("graph-ti"),b=document.getElementById("graph-to"),f=document.getElementById("graph-bio"),_=document.getElementById("database_activity"),v=document.getElementById("database_locks"),C=document.getElementById("database_prepared"),N=[],D=[],k=[],S=[],T=[],j=[],M=[],E=[],P=[],U=[],I={parseFloat:!1,xaxis:{min:100,max:0,autoscale:0},yaxis:{autoscale:1},legend:{position:"nw",backgroundColor:"#D2E8FF"}},O=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"usename",label:t("User"),editable:!1,cell:"string"},{name:"application_name",label:t("Application"),editable:!1,cell:"string"},{name:"client_addr",label:t("Client"),editable:!1,cell:"string"},{name:"backend_start",label:t("Backend start"),editable:!1,cell:"string"},{name:"state",label:t("State"),editable:!1,cell:"string"}];O=r<90600?O.concat([{name:"waiting",label:t("Waiting?"),editable:!1,cell:"string"}]):O.concat([{name:"wait_event",label:t("Wait Event"),editable:!1,cell:"string"},{name:"blocking_pids",label:t("Blocking PIDs"),editable:!1,cell:"string"}]);var A=new x,q=Backform.generateViewSchema(null,A,"create",null,null,!0);o.each(q[0].fields,function(e){e.version=r}),O.unshift({name:"pg-backform-expand",label:"",cell:w,cell_priority:-1,postgres_version:r,schema:q}),O.unshift({name:"pg-backform-delete",label:"",cell:y,cell_action:"cancel",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:r}),O.unshift({name:"pg-backform-delete",label:"",cell:y,cell_action:"terminate",editable:!1,cell_priority:-1,canDeleteRow:l.Dashboard.can_take_action,postgres_version:r});var B=[{name:"pid",label:t("PID"),editable:!1,cell:"string"},{name:"locktype",label:t("Lock type"),editable:!1,cell:"string"},{name:"relation",label:t("Target relation"),editable:!1,cell:"string"},{name:"page",label:t("Page"),editable:!1,cell:"string"},{name:"tuple",label:t("Tuple"),editable:!1,cell:"string"},{name:"virtualxid",label:t("vXID (target)"),editable:!1,cell:"string"},{name:"transactionid",label:t("XID (target)"),editable:!1,cell:"string"},{name:"classid",label:t("Class"),editable:!1,cell:"string"},{name:"objid",label:t("Object ID"),editable:!1,cell:"string"},{name:"virtualtransaction",label:t("vXID (owner)"),editable:!1,cell:"string"},{name:"mode",label:t("Mode"),editable:!1,cell:"string"},{name:"granted",label:t("Granted?"),editable:!1,cell:"string"}],z=[{name:"git",label:t("Name"),editable:!1,cell:"string"},{name:"Owner",label:t("Owner"),editable:!1,cell:"string"},{name:"transaction",label:t("XID"),editable:!1,cell:"string"},{name:"prepared",label:t("Prepared at"),editable:!1,cell:"string"}];l.Dashboard.render_chart(m,D,N,i,n,e("dashboard.session_stats"),I,!1,s),l.Dashboard.render_chart(g,S,k,i,n,e("dashboard.tps_stats"),I,!0,d),l.Dashboard.render_chart(h,j,T,i,n,e("dashboard.ti_stats"),I,!0,c),l.Dashboard.render_chart(b,E,M,i,n,e("dashboard.to_stats"),I,!0,p),l.Dashboard.render_chart(f,U,P,i,n,e("dashboard.bio_stats"),I,!0,u),a(_).addClass("pg-el-container"),a(_).attr("el","sm"),l.Dashboard.render_grid(_,i,n,e("dashboard.activity"),O),l.Dashboard.render_grid(v,i,n,e("dashboard.locks"),B),l.Dashboard.render_grid(C,i,n,e("dashboard.prepared"),z),l.Dashboard.render_grid_data(_),a('a[data-toggle="tab"]').on("shown.bs.tab",function(e){switch(a(e.target).attr("aria-controls")){case"tab_database_activity":l.Dashboard.render_grid_data(_);break;case"tab_database_locks":l.Dashboard.render_grid_data(v);break;case"tab_database_prepared":l.Dashboard.render_grid_data(C)}}),a("button").click(function(e){switch(this.id){case"btn_database_activity_refresh":l.Dashboard.render_grid_data(_);break;case"btn_database_locks_refresh":l.Dashboard.render_grid_data(v);break;case"btn_database_prepared_refresh":l.Dashboard.render_grid_data(C)}})},toggleVisibility:function(e){g=e},can_take_action:function(e){var i=e.collection.where({state:"active"}),n=this.get("postgres_version")||null,a=this.get("cell_action")||null,o="cancel"===a,l=t(o?"cancel":"terminate");return n&&n>=1e5&&!e.get("datname")?(c.info(t("You cannot ")+l+t(" background worker processes.")),!1):m==e.get("datname")&&"active"==e.get("state")&&1==i.length?(c.error(t("You are not allowed to ")+l+t(" the main active session.")),!1):o&&"idle"==e.get("state")?(c.info(t("The session is already in idle state.")),!1):!!f||(!(!u||u!=e.get("usename"))||(c.error(t("Superuser privileges are required to ")+l+t(" another users query.")),!1))}},l.Dashboard}}.apply(t,n))&&(e.exports=a)},,,function(e,t){e.exports=r},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(15),i(6),i(10),i(11),i(17),i(30),i(189),i(187),i(156)],void 0!==(o=function(e,t,i,a,o,l,r,s,d,c,p,u){if(r.UserManagement)return r.UserManagement;var m=t("user_management.users"),g=t("user_management.roles"),h=function(e){return new d.Extension.ClientSideFilter({collection:e,placeholder:a("Filter by email"),fields:["email"],wait:150})};return r.UserManagement={init:function(){if(!this.initialized)return this.initialized=!0,this},change_password:function(i){var n=e("Change Password");l.ChangePassword||l.dialog("ChangePassword",function(){return{main:function(e,t){this.set({title:e,url:t})},build:function(){l.pgDialogBuild.apply(this)},settings:{url:void 0},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Change Password"),url:t("help.static",{filename:"change_user_password.html"})}},{text:e("Close"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){return setTimeout(function(){return l.ChangePassword().destroy()},500)}},prepare:function(){var e=document.createElement("iframe");e.frameBorder="no",e.width="100%",e.height="100%",e.src=this.setting("url"),this.elements.content.appendChild(e)},callback:function(e){if("dialog_help"==e.button.element.name)return e.cancel=!0,void r.showHelp(e.button.element.name,e.button.element.getAttribute("url"),null,null,e.button.element.getAttribute("label"))}}}),l.ChangePassword(n,i).resizeTo("75%","70%")},show_users:function(p,b,f){if(u.is_admin){var _=[],v=n.Browser.Node.Model.extend({idAttribute:"id",urlRoot:m,defaults:{id:void 0,email:void 0,active:!0,role:void 0,newPassword:void 0,confirmPassword:void 0},schema:[{id:"email",label:e("Email"),type:"text",cell:d.Extension.StringDepCell,cellHeaderClasses:"width_percent_30",deps:["id"],editable:function(e){return!(e instanceof s.Collection)&&!!e.isNew()}},{id:"role",label:e("Role"),type:"text",control:"Select2",cellHeaderClasses:"width_percent_20",cell:"select2",select2:{allowClear:!1,openOnEnter:!1},options:function(e){var t=[];return e instanceof c.Control?a.each(_,function(e){t.push({label:e.name,value:e.id.toString()})}):a.each(_,function(e){t.push([e.name,e.id.toString()])}),t},editable:function(e){return e instanceof s.Collection||e.get("id")!=u.id}},{id:"active",label:e("Active"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_10",options:{onText:e("Yes"),offText:e("No")},editable:function(e){return e instanceof s.Collection||e.get("id")!=u.id}},{id:"newPassword",label:e("New password"),type:"password",disabled:!1,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"},{id:"confirmPassword",label:e("Confirm password"),type:"password",disabled:!1,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"}],validate:function(){var t=null,i=this.changed||{},n=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;if(("email"in i||!this.isNew())&&(a.isUndefined(this.get("email"))||a.isNull(this.get("email"))||""==String(this.get("email")).replace(/^\s+|\s+$/g,"")))return t=e("Email address cannot be empty."),this.errorModel.set("email",t),t;if(this.get("email")&&!n.test(this.get("email")))return t=o(e("Invalid email address: %s.")).sprintf(this.get("email")).value(),this.errorModel.set("email",t),t;if(this.get("email")&&this.collection.where({email:this.get("email")}).length>1)return t=o(e("The email address %s already exists.")).sprintf(this.get("email")).value(),this.errorModel.set("email",t),t;if(this.errorModel.unset("email"),"role"in i&&(a.isUndefined(this.get("role"))||a.isNull(this.get("role"))||""==String(this.get("role")).replace(/^\s+|\s+$/g,"")))return t=o(e("Role cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("role",t),t;if(this.errorModel.unset("role"),this.isNew()){if("newPassword"in i&&(a.isUndefined(this.get("newPassword"))||a.isNull(this.get("newPassword"))||""==this.get("newPassword")))return t=o(e("Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("newPassword",t),t;if(!a.isUndefined(this.get("newPassword"))&&!a.isNull(this.get("newPassword"))&&this.get("newPassword").length<6)return t=o(e("Password must be at least 6 characters for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("newPassword",t),t;if(this.errorModel.unset("newPassword"),"confirmPassword"in i&&(a.isUndefined(this.get("confirmPassword"))||a.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))return t=o(e("Confirm Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;if(this.errorModel.unset("confirmPassword"),this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return t=o(e("Passwords do not match for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;this.errorModel.unset("confirmPassword")}else if((a.isUndefined(this.get("newPassword"))||a.isNull(this.get("newPassword"))||""==this.get("newPassword"))&&(a.isUndefined(this.get("confirmPassword"))||a.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword")))this.errorModel.unset("newPassword"),""==this.get("newPassword")&&this.set({newPassword:void 0}),this.errorModel.unset("confirmPassword"),""==this.get("confirmPassword")&&this.set({confirmPassword:void 0});else{if(!a.isUndefined(this.get("newPassword"))&&!a.isNull(this.get("newPassword"))&&""==!this.get("newPassword")&&this.get("newPassword").length<6)return t=o(e("Password must be at least 6 characters for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("newPassword",t),t;if(a.isUndefined(this.get("confirmPassword"))||a.isNull(this.get("confirmPassword"))||""==this.get("confirmPassword"))return t=o(e("Confirm Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;if(this.get("newPassword")&&this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword"))return t=o(e("Passwords do not match for user %s.")).sprintf(this.get("email")||"").value(),this.errorModel.set("confirmPassword",t),t;this.errorModel.unset("newPassword"),this.errorModel.unset("confirmPassword")}return null}}),y=c.generateGridColumnsFromModel(null,v,"edit"),w=d.Extension.DeleteCell.extend({deleteRow:function(t){if(self=this,t.preventDefault(),self.model.get("id")==u.id)return l.alert(e("Cannot delete user."),e("Cannot delete currently logged in user."),function(){return!0}),!0;!a.isUndefined(this.column.get("canDeleteRow"))&&a.isFunction(this.column.get("canDeleteRow"))&&!d.callByNeed(this.column.get("canDeleteRow"),this.column,this.model)?l.alert(e("Error"),e("This user cannot be deleted."),function(){return!0}):self.model.isNew()?self.model.destroy():l.confirm(e("Delete user?"),e("Are you sure you wish to delete this user?"),function(t){self.model.destroy({wait:!0,success:function(t){l.success(e("User deleted."))},error:function(t,i){l.error(e("Error during deleting user."))}})},function(e){return!0})}});y.columns.unshift({name:"pg-backform-delete",label:"",cell:w,editable:!1,cell_priority:-1,canDeleteRow:!0}),l.UserManagement||l.dialog("UserManagement",function(){return{main:function(e){this.set("title",e)},build:function(){l.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Users"),url:t("help.static",{filename:"pgadmin_user.html"})}},{text:e("Close"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button user_management_pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{title:e("User Management"),padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,closable:!1}}},hooks:{onclose:function(){this.view&&(this.view.remove({data:!0,internal:!0,silent:!0}),this.$content.remove())}},prepare:function(){var t=a.template(['<div class="pg-prop-footer" style="visibility:hidden;">','<div class="pg-prop-status-bar">','<div class="media error-in-footer bg-red-1 border-red-2 font-red-3 text-14">','<div class="media-body media-middle">','<div class="alert-icon error-icon">','<i class="fa fa-exclamation-triangle" aria-hidden="true"></i>',"</div>",'<div class="alert-text">',"</div>",'<div class="close-error-bar"><a class="close-error">x</a></div>',"</div>","</div>","</div>","</div>"].join("\n")),n=i(t()),r=d.Row.extend({userInvalidColor:"lightYellow",userValidColor:"#fff",initialize:function(){d.Row.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"pgadmin:user:invalid",this.userInvalid),this.listenTo(this.model,"pgadmin:user:valid",this.userValid)},userInvalid:function(){i(this.el).removeClass("new"),this.el.style.backgroundColor=this.userInvalidColor},userValid:function(){this.el.style.backgroundColor=this.userValidColor}}),c=s.Collection.extend({model:v,url:m,initialize:function(){s.Collection.prototype.initialize.apply(this,arguments);var e=this;e.changedUser=null,e.invalidUsers={},e.on("add",e.onModelAdd),e.on("remove",e.onModelRemove),e.on("pgadmin-session:model:invalid",function(t,i,a){e.invalidUsers[i.cid]=t,i.trigger("pgadmin:user:invalid",i),n.find(".alert-text").html(t),n.css("visibility","visible")}),e.on("pgadmin-session:model:valid",function(t,i){delete e.invalidUsers[t.cid],t.trigger("pgadmin:user:valid",t),this.updateErrorMsg(),this.saveUser(t)})},onModelAdd:function(e){e.startNewSession()},onModelRemove:function(e){delete this.invalidUsers[e.cid],this.updateErrorMsg()},updateErrorMsg:function(){var e=this,t=null;for(var i in e.invalidUsers)if(t=e.invalidUsers[i])break;t?(n.find(".alert-text").html(t),n.css("visibility","visible")):(n.find(".alert-text").empty(),n.css("visibility","hidden"))},saveUser:function(t){var i=t.toJSON(!0);return!(t.isNew()&&!(t.get("email")&&t.get("role")&&t.get("newPassword")&&t.get("confirmPassword")&&t.get("newPassword")==t.get("confirmPassword")))&&(!(!t.isNew()&&t.get("newPassword")!=t.get("confirmPassword"))&&void(t.sessChanged()&&i&&!a.isEmpty(i)&&(t.stopSession(),t.save({},{attrs:i,wait:!0,success:function(i){t.set({newPassword:void 0,confirmPassword:void 0}),t.startNewSession(),l.success(o(e("User '%s' saved.")).sprintf(t.get("email")).value())},error:function(i,n){t.startNewSession(),l.error(o(e("Error saving user: '%s'")).sprintf(n.responseJSON.errormsg).value())}}))))}}),p=this.userCollection=new c,u=['<div class="subnode-header">','  <button class="btn-sm btn-default add fa fa-plus" title="<%-add_title%>" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>','  <div class="control-label search_users"></div>',"</div>"].join("\n"),b=a.template(u),f={canAdd:!0,add_title:e("Add new user")},w=i("<div></div>",{class:"user_container"});i.ajax({url:g,method:"GET",async:!1,success:function(e){_=e},error:function(t){setTimeout(function(){l.alert(e("Error"),e("Cannot load user roles."))},100)}});var x=this.view=new d.Grid({row:r,columns:y.columns,collection:p,className:"backgrid table-bordered"});w.append(x.render().$el[0]),this.$content=i("<div class='user_management object subnode'></div>").append(b(f)).append(w).append(n),i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_backgrid_properties"),this.elements.content.appendChild(this.$content[0]),i(".search_users").append(h(p).render().el),p.fetch(),this.$content.find("a.close-error").click(function(e){n.find(".alert-text").empty(),n.css("visibility","hidden")}),this.$content.find("button.add").first().click(function(e){e.preventDefault();var t=!1,n=null;if(p.each(function(e){t||(t=e.isNew(),n=e)}),t){var a=p.indexOf(n),o=x.body.rows[a].$el;return o.addClass("new"),i(o).pgMakeVisible("backform-tab"),!1}i(x.body.$el.find(i("tr.new"))).removeClass("new");var l=new v(null,{handler:p,top:p,collection:p});p.add(l);var a=p.indexOf(l),r=x.body.rows[a].$el;return r.addClass("new"),i(r).pgMakeVisible("backform-tab"),!1})},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void r.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null,t.button.element.getAttribute("label"));if("close"==t.button.element.name){var i=this;a.all(this.userCollection.pluck("id"))&&a.isEmpty(this.userCollection.invalidUsers)||(t.cancel=!0,l.confirm(e("Discard unsaved changes?"),e("Are you sure you want to close the dialog? Any unsaved changes will be lost."),function(e){return i.close(),!0},function(e){return!0}))}}}}),l.UserManagement(!0).resizeTo("680px","400px")}}},r.UserManagement}.apply(t,a))&&(e.exports=o)}).call(t,i(3))},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(1),i(4),i(0),i(6),i(11),i(8),i(272)],void 0!==(o=function(e,t,i,a,o,l,r,s){if(o.NodeStatistics)return o.NodeStatistics;if(o.NodeStatistics=o.NodeStatistics||{},o.NodeStatistics.initialized)return o.NodeStatistics;var d=l.SizeFormatter=function(){};t.extend(d.prototype,{fromRaw:function(e,t){return s(e)},toRaw:function(e,t){return e}});var c=l.Extension.SwitchCell.extend({defaults:t.extend({},l.Extension.SwitchCell.prototype.defaults)}),p={16:c,20:l.IntegerCell,21:l.IntegerCell,23:l.IntegerCell,700:l.NumberCell,701:l.NumberCell,1700:l.NumberCell,702:l.DatetimeCell,703:l.DatetimeCell,1082:l.DatetimeCell.extend({includeDate:!0,includeTime:!1,includeMilli:!1}),1083:l.DatetimeCell.extend({includeDate:!1,includeTime:!0,includeMilli:!0}),1114:l.DatetimeCell.extend({includeDate:!0,includeTime:!0,includeMilli:!0}),1184:"string",1266:"string"},u=window.wcDocker;return t.extend(c.prototype.defaults.options,{onText:e("True"),offText:e("False"),onColor:"success",offColor:"primary",size:"mini"}),t.extend(o.NodeStatistics,{init:function(){if(!this.initialized){this.initialized=!0,t.bindAll(this,"showStatistics","panelVisibilityChanged","__createMultiLineStatistics","__createSingleLineStatistics"),t.extend(this,{initialized:!0,collection:new n.Collection(null),statistic_columns:[{editable:!1,name:"statistics",label:e("Statistics"),cell:"string",headerCell:l.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_25"},{editable:!1,name:"value",label:e("Value"),cell:"string"}],panel:o.docker.findPanels("statistics"),columns:null,grid:null});var i=this;o.Events.on("pgadmin-browser:panel-statistics:"+u.EVENT.VISIBILITY_CHANGED,this.panelVisibilityChanged),o.Events.on("pgadmin:browser:node:updated",function(){this.panel&&this.panel.length&&(a(this.panel[0]).data("node-prop",""),this.panelVisibilityChanged(this.panel[0]))},this),0==this.panel.length?o.Events.on("pgadmin-browser:panel-statistics:"+u.EVENT.INIT,function(){i.panel=o.docker.findPanels("statistics"),(i.panel[0].isVisible()||1!=i.panel.length)&&o.Events.on("pgadmin-browser:tree:selected",this.showStatistics)}.bind(this)):(i.panel[0].isVisible()||1!=i.panel.length)&&o.Events.on("pgadmin-browser:tree:selected",this.showStatistics),i.panel.length>0&&i.panel[0].isVisible()&&o.Events.on("pgadmin-browser:tree:selected",this.showStatistics)}},__updateCollection:function(n,s,d,c){var p=this.panel[0].layout().scene().find(".pg-panel-content"),u=p.find(".pg-panel-statistics-message"),m=p.find(".pg-panel-statistics-container"),g=(this.collection,this.panel),h=this,b="",f=c;if(s){b=e("No statistics are available for the selected object.");var _=s.getTreeNodeHierarchy(d),v={node_type:c,url:n};if(t.isEqual(a(g[0]).data("node-prop"),v))return;if(a(g[0]).data("node-prop",v),s.hasStatistics){b="";var y;a.ajax({url:n,type:"GET",beforeSend:function(t,i){y=setTimeout(function(){u.text(e("Retrieving data from the server...")),u.removeClass("hidden"),h.grid&&h.grid.remove()},1e3)},success:function(e){if(clearTimeout(y),u.text(""),e.data){var t=e.data;s.hasCollectiveStatistics||t.rows.length>1?h.__createMultiLineStatistics.call(h,t,s.statsPrettifyFields):h.__createSingleLineStatistics.call(h,t,s.statsPrettifyFields),h.grid&&(delete h.grid,h.grid=null),h.grid=new l.Grid({columns:h.columns,collection:h.collection,className:"backgrid presentation table backgrid-striped table-bordered table-hover"}),h.grid.render(),m.empty(),m.append(h.grid.$el),u.hasClass("hidden")||u.addClass("hidden"),m.removeClass("hidden")}else e.info&&(m.hasClass("hidden")||m.addClass("hidden"),u.text(e.info),u.removeClass("hidden"))},error:function(t,n,a){var l=_[f].label;o.Events.trigger("pgadmin:node:retrieval:error","statistics",t,n,a,d),r.pgHandleItemError(t,n,a,{item:d,info:_})||r.pgNotifier(n,t,i(e("Error retrieving the information - %s")).sprintf(a||l).value(),function(){}),u.text(e("Failed to retrieve data from the server."))}})}}""!=b&&(m.hasClass("hidden")||m.addClass("hidden"),u.removeClass("hidden"),u.text(b))},showStatistics:function(e,t,i){var n=this;i&&i&&(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(function(){n.__updateCollection.call(n,i.generate_url(e,"stats",t,!0),i,e,t._type)},400))},__createMultiLineStatistics:function(e,i){var n=e.rows,a=e.columns;this.columns=[];for(var o in a){var l=a[o],r=p[l.type_code]||"string";"PID"==l.name&&(r=r.extend({orderSeparator:""}));var s={editable:!1,name:l.name,cell:r};-1!=t.indexOf(i,l.name)&&(s.formatter=d),this.columns.push(s)}this.collection.reset(n)},__createSingleLineStatistics:function(e,i){var n=e.rows[0],a=e.columns,o=[];this.columns=this.statistic_columns;for(var l in a)name=a[l].name,o.push({statistics:name,value:n&&n[name]?-1!=t.indexOf(i,name)?s(n[name]):n[name]:null});this.collection.reset(o)},panelVisibilityChanged:function(e){if(e.isVisible()){var t=o.tree,i=t.selected(),n=i&&t.itemData(i),a=i&&n&&o.Nodes[n._type];o.NodeStatistics.showStatistics.apply(o.NodeStatistics,[i,n,a]),o.Events.on("pgadmin-browser:tree:selected",o.NodeStatistics.showStatistics)}else o.Events.off("pgadmin-browser:tree:selected",o.NodeStatistics.showStatistics)}}),o.NodeStatistics}.apply(t,a))&&(e.exports=o)}).call(t,i(10))},function(e,t,i){"use strict";var n,a;n=[],void 0!==(a=function(){return function(e){var t=Math.abs(e),i=0,n=["bytes","kB","MB","GB","TB","PB"];if(t<10240)return t+" "+n[i];do{t/=1024,i+=1}while(t>10239);return Math.round(t)+" "+n[i]}}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(1),i(4),i(0),i(6),i(8),i(15)],void 0!==(l=function(e,t,i,o,l,r){if(l.ShowNodeDepends)return l.ShowNodeDepends;var s=window.wcDocker;return l.ShowNodeDepends=l.ShowNodeDepends||{},t.extend(l.ShowNodeDepends,{init:function(){if(!this.initialized){this.initialized=!0;t.bindAll(this,"showDependents","dependentsPanelVisibilityChanged","showDependencies","dependenciesPanelVisibilityChanged","__updateCollection"),l.Events.on("pgadmin-browser:panel-dependencies:"+s.EVENT.VISIBILITY_CHANGED,this.dependenciesPanelVisibilityChanged),l.Events.on("pgadmin-browser:panel-dependents:"+s.EVENT.VISIBILITY_CHANGED,this.dependentsPanelVisibilityChanged);var r=n.Model.extend({defaults:{icon:"icon-unknown",type:void 0,name:void 0,field:void 0},parse:function(e){var n=l.Nodes[e.type];return e.icon=n?t.isFunction(n.node_image)?n.node_image.apply(n,[null,null]):n.node_image||"icon-"+e.type:"icon-"+e.type,e.type=i.titleize(e.type.replace(/_/g," "),!0),e}});this.dependentCollection=new(n.Collection.extend({model:r}))(null),this.dependenciesCollection=new(n.Collection.extend({model:r}))(null);var d=this,c=function(t,i,n){var l=i[0].layout().scene().find(".pg-panel-content"),r=l.find(".pg-panel-depends-container"),s=new a.Grid({columns:[{name:"type",label:e("Type"),cell:a.Cell.extend({render:function(){return a.Cell.prototype.render.apply(this,arguments),this.$el.prepend(o("<i>",{class:"wcTabIcon "+this.model.get("icon")})),this}}),editable:!1},{name:"name",label:e("Name"),cell:"string",editable:!1},{name:"field",label:"",cell:"string",editable:!1}],collection:t,className:"backgrid presentation table backgrid-striped table-bordered table-hover"});return n?d.dependentGrid=s:d.dependenciesGrid=s,r.append(s.render().el),!0};l.Events.on("pgadmin-browser:panel-dependencies:"+s.EVENT.VISIBILITY_CHANGED,this.dependenciesPanelVisibilityChanged),l.Events.on("pgadmin-browser:panel-dependents:"+s.EVENT.VISIBILITY_CHANGED,this.dependentsPanelVisibilityChanged),l.Events.on("pgadmin:browser:node:updated",function(){this.dependenciesPanels&&this.dependenciesPanels.length&&(o(this.dependenciesPanels[0]).data("node-prop",""),this.dependenciesPanelVisibilityChanged(this.dependenciesPanels[0])),this.dependentsPanels&&this.dependentsPanels.length&&(o(this.dependentsPanels[0]).data("node-prop",""),this.dependentsPanelVisibilityChanged(this.dependentsPanels[0]))},this);var p=this.dependenciesPanels=l.docker.findPanels("dependencies"),u=this.dependentsPanels=l.docker.findPanels("dependents");0==p.length?l.Events.on("pgadmin-browser:panel-dependencies:"+s.EVENT.INIT,function(){this.dependenciesPanels=l.docker.findPanels("dependencies"),c(this.dependenciesCollection,this.dependenciesPanels,!1),(p[0].isVisible()||1!=p.length)&&l.Events.on("pgadmin-browser:tree:selected",this.showDependencies)}.bind(this)):(c(this.dependenciesCollection,this.dependenciesPanels,!1),(p[0].isVisible()||1!=p.length)&&l.Events.on("pgadmin-browser:tree:selected",this.showDependencies)),0==u.length?l.Events.on("pgadmin-browser:panel-dependents:"+s.EVENT.INIT,function(){this.dependentsPanels=l.docker.findPanels("dependents"),c(this.dependentCollection,this.dependentsPanels,!0),(u[0].isVisible()||1!=u.length)&&l.Events.on("pgadmin-browser:tree:selected",this.showDependents)}.bind(this)):(c(this.dependentCollection,this.dependentsPanels,!0),(u[0].isVisible()||1!=u.length)&&l.Events.on("pgadmin-browser:tree:selected",this.showDependents))}},__updateCollection:function(n,a,s,d,c,p,u){var m=d[0],g=a[0].layout().scene().find(".pg-panel-content"),h=g.find(".pg-panel-depends-message"),b=g.find(".pg-panel-depends-container"),f=c.getTreeNodeHierarchy(p),_=u;if(!t.isEqual(o(a[0]).data("node-prop"),f)){if(o(a[0]).data("node-prop",f),b.hasClass("hidden")||b.addClass("hidden"),h.removeClass("hidden"),c&&(m=d[1],c.hasDepends)){m=d[2],h.text(m),!this.dependent||"tablespace"!=c.type&&"role"!=c.type?(this.dependenciesGrid.columns.models[2].set({label:e("Restriction")}),this.dependentGrid.columns.models[2].set({label:e("Restriction")})):this.dependentGrid.columns.models[2].set({label:e("Database")}),h.addClass("hidden"),b.removeClass("hidden");var v=setTimeout(function(){h.text(e("Retrieving data from the server...")),h.removeClass("hidden"),b&&b.addClass("hidden")},1e3);n.url=s,n.fetch({reset:!0,success:function(){clearTimeout(v),b.removeClass("hidden"),h.hasClass("hidden")||h.addClass("hidden")},error:function(t,n,a,o){var s=f[_].label;l.Events.trigger("pgadmin:node:retrieval:error","depends",n,a,o),r.pgHandleItemError(n,a,o,{item:p,info:f})||r.pgNotifier(a,n,i(e("Error retrieving the information - %s")).sprintf(o||s).value(),function(){}),h.text(e("Failed to retrieve data from the server."))}})}""!=m&&h.text(m)}},showDependents:function(t,i,n){var a=this;n&&(a.dependent=!0,a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.__updateCollection(a.dependentCollection,a.dependentsPanels,n.generate_url(t,"dependent",i,!0),[e("No object selected."),e("No dependent information is available for the current object."),e("Fetching dependent information from the server...")],n,t,i._type),400))},dependentsPanelVisibilityChanged:function(e){if(e.isVisible()){var t=l.tree,i=t.selected(),n=i&&t.itemData(i),a=i&&n&&l.Nodes[n._type];l.ShowNodeDepends.showDependents.apply(l.ShowNodeDepends,[i,n,a]),l.Events.on("pgadmin-browser:tree:selected",l.ShowNodeDepends.showDependents)}else l.Events.off("pgadmin-browser:tree:selected",l.ShowNodeDepends.showDependents)},showDependencies:function(t,i,n){var a=this;n&&(a.dependent=!1,a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.__updateCollection(a.dependenciesCollection,a.dependenciesPanels,n.generate_url(t,"dependency",i,!0),[e("Please select an object in the tree view."),e("No dependency information is available for the current object."),e("Fetching dependency information from the server...")],n,t,i._type),400))},dependenciesPanelVisibilityChanged:function(e){if(e.isVisible()){var t=l.tree,i=t.selected(),n=i&&t.itemData(i),a=i&&n&&l.Nodes[n._type];l.ShowNodeDepends.showDependencies.apply(l.ShowNodeDepends,[i,n,a]),l.Events.on("pgadmin-browser:tree:selected",l.ShowNodeDepends.showDependencies)}else l.Events.off("pgadmin-browser:tree:selected",l.ShowNodeDepends.showDependencies)}}),l.ShowNodeDepends}.apply(t,o))&&(e.exports=l)}).call(t,i(10),i(11))},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(1),i(4),i(0),i(6),i(8),i(15)],void 0!==(o=function(e,t,i,a,o,l){if(o.ShowNodeSQL=o.ShowNodeSQL||{},o.ShowNodeSQL.initialized)return o.ShowNodeSQL;var r=window.wcDocker;return t.extend(o.ShowNodeSQL,{init:function(){if(!this.initialized){this.initialized=!0,t.bindAll(this,"showSQL","sqlPanelVisibilityChanged");var e;this.sqlPanels=e=o.docker.findPanels("sql"),o.Events.on("pgadmin-browser:panel-sql:"+r.EVENT.VISIBILITY_CHANGED,this.sqlPanelVisibilityChanged),o.Events.on("pgadmin:browser:node:updated",function(){this.sqlPanels&&this.sqlPanels.length&&(a(this.sqlPanels[0]).data("node-prop",""),this.sqlPanelVisibilityChanged(this.sqlPanels[0]))},this),0==e.length?o.Events.on("pgadmin-browser:panel-sql:"+r.EVENT.INIT,function(){(e[0].isVisible()||1!=e.length)&&o.Events.on("pgadmin-browser:tree:selected",this.showSQL)}.bind(this)):(e[0].isVisible()||1!=e.length)&&o.Events.on("pgadmin-browser:tree:selected",this.showSQL)}},showSQL:function(r,s,d){this.timeout&&clearTimeout(this.timeout);var c=this;this.timeout=setTimeout(function(){var p="";if(d){p="-- "+e("No SQL could be generated for the selected object.");var u=s._type,m=d.getTreeNodeHierarchy(r);if(t.isEqual(a(c.sqlPanels[0]).data("node-prop"),m))return;if(a(c.sqlPanels[0]).data("node-prop",m),d.hasSQL){p="";var g,h=d.generate_url(r,"sql",s,!0);a.ajax({url:h,type:"GET",beforeSend:function(t,i){g=setTimeout(function(){n.Browser.editor.setValue(e("Retrieving data from the server..."))},1e3)},success:function(e){n.Browser.editor.getValue()!=e&&n.Browser.editor.setValue(e),clearTimeout(g)},error:function(t,n,a){var s=m[u].label;o.Events.trigger("pgadmin:node:retrieval:error","sql",t,n,a,r),l.pgHandleItemError(t,n,a,{item:r,info:m})||l.pgNotifier(n,t,i(e("Error retrieving the information - %s")).sprintf(a||s).value(),function(){})}})}}""!=p&&n.Browser.editor.setValue(p)},400)},sqlPanelVisibilityChanged:function(e){if(e.isVisible()){var t=o.tree,i=t.selected(),n=i&&t.itemData(i),a=i&&n&&o.Nodes[n._type];o.ShowNodeSQL.showSQL.apply(o.ShowNodeSQL,[i,n,a]),o.Events.on("pgadmin-browser:tree:selected",o.ShowNodeSQL.showSQL)}else o.Events.off("pgadmin-browser:tree:selected",o.ShowNodeSQL.showSQL)}}),o.ShowNodeSQL}.apply(t,a))&&(e.exports=o)}).call(t,i(3))},function(e,t,i){"use strict";var n,a;n=[i(3),i(2),i(5),i(1),i(4),i(0),i(6),i(8),i(95)],void 0!==(a=function(e,t,i,n,a,o,l,r,s){if(l.BackgroundProcessObsorver=l.BackgroundProcessObsorver||{},l.BackgroundProcessObsorver.initialized)return l.BackgroundProcessObsorver;var d=function(e,t){var i=this;setTimeout(function(){i.initialize.apply(i,[e,t])},1)};return n.extend(d.prototype,{initialize:function(e,t){n.extend(this,{details:!1,notify:n.isUndefined(t)||t,curr_status:null,state:0,completed:!1,id:e.id,desc:null,detailed_desc:null,stime:null,exit_code:null,acknowledge:e.acknowledge,execution_time:null,out:-1,err:-1,lot_more:!1,notifier:null,container:null,panel:null,logs:o("<ol></ol>",{class:"pg-bg-process-logs"})}),this.notify&&(l.Events&&l.Events.on("pgadmin-bgprocess:started:"+this.id,function(e){e.notifier||e.show.apply(e)}),l.Events&&l.Events.on("pgadmin-bgprocess:finished:"+this.id,function(e){e.notifier||e.show.apply(e)}));var i=this;setTimeout(function(){i.update.apply(i,[e])},1)},bgprocess_url:function(e){switch(e){case"status":return this.details&&-1!=this.out&&-1!=this.err?i("bgprocess.detailed_status",{pid:this.id,out:this.out,err:this.err}):i("bgprocess.status",{pid:this.id});case"acknowledge":return i("bgprocess.acknowledge",{pid:this.id});default:return i("bgprocess.list")}},update:function(i){var o=this,r=[],s=[];"stime"in i&&(o.stime=new Date(i.stime)),"execution_time"in i&&(o.execution_time=parseFloat(i.execution_time)),"desc"in i&&(o.desc=i.desc),"details"in i&&(o.detailed_desc=i.details),"exit_code"in i&&(o.exit_code=i.exit_code),"out"in i&&(o.out=i.out&&i.out.pos,i.out&&i.out.lines&&(r=i.out.lines)),"err"in i&&(o.err=i.err&&i.err.pos,i.err&&i.err.lines&&(s=i.err.lines)),o.completed=o.completed||"err"in i&&"out"in i&&i.err.done&&i.out.done||!o.details&&!n.isNull(o.exit_code);for(var d=0,c=0,p=[],u=document.createElement("textarea"),m=function(e){return u.textContent=e,u.innerHTML};d<r.length&&c<s.length;)e.natural_sort(r[d][0],s[c][0])<=0?p.push('<li class="pg-bg-res-out">'+m(r[d++][1])+"</li>"):p.push('<li class="pg-bg-res-err">'+m(s[c++][1])+"</li>");for(;d<r.length;)p.push('<li class="pg-bg-res-out">'+m(r[d++][1])+"</li>");for(;c<s.length;)p.push('<li class="pg-bg-res-err">'+m(s[c++][1])+"</li>");p.length&&(o.logs.append(p.join("")),setTimeout(function(){o.logs[0].scrollTop=o.logs[0].scrollHeight})),o.stime&&(o.curr_status=t("Started"),o.execution_time>=2&&(o.curr_status=t["Running..."]),n.isNull(o.exit_code)||(0==o.exit_code?o.curr_status=t("Successfully completed."):o.curr_status=a(t("Failed (exit code: %s).")).sprintf(String(o.exit_code)).value()),0==o.state&&o.stime&&(o.state=1,l.Events&&l.Events.trigger("pgadmin-bgprocess:started:"+o.id,o,o)),1!=o.state||n.isNull(o.exit_code)||(o.state=2,l.Events&&l.Events.trigger("pgadmin-bgprocess:finished:"+o.id,o,o)),setTimeout(function(){o.show.apply(o)},10)),o.completed||setTimeout(function(){o.status.apply(o)},1e3)},status:function(){var e=this;o.ajax({typs:"GET",timeout:3e4,url:e.bgprocess_url("status"),cache:!1,async:!0,contentType:"application/json",success:function(t){setTimeout(function(){e.update(t)},10)},error:function(t){410!=t.status&&setTimeout(function(){e.update(t)},1e4)}})},show:function(){var e=this;if(e.notify&&!e.details){if(!e.notifier){var i=o("<div></div>",{class:"h5 pg-bg-notify-header"}).append(o("<span></span>").text(e.desc)),n=o('<div class="pg-bg-bgprocess row"></div>').append(i).append(o("<div></div>",{class:"pg-bg-notify-body h6"}).append(o("<div></div>",{class:"pg-bg-start col-xs-12"}).append(o("<div></div>").text(e.stime.toString())).append(o('<div class="pg-bg-etime"></div>')))),a=o("<div></div>",{class:"col-xs-12 text-center pg-bg-click h6"}).append(o("<span></span>").text(t("Click here for details."))).appendTo(n),l=(o("<div></div>",{class:"pg-bg-status col-xs-12 h5 "+(0===e.exit_code?"bg-success":1==e.exit_code?"bg-failed":"")}).appendTo(n),o('<div class="bg-close"><i class="fa fa-close"></i></div>').appendTo(i));e.container=n,e.notifier=r.notify(n.get(0),"bg-bgprocess",0,null),a.on("click",function(e){e=e||window.event,e.cancelBubble=!0,e.stopPropagation(),this.notifier.dismiss(),this.notifier=null,this.completed=!1,this.show_detailed_view.apply(this)}.bind(e)),l.on("click",function(e){this.notifier.dismiss(),this.notifier=null,this.acknowledge_server.apply(this)}.bind(this)),n.on("click",function(e){e=e||window.event,e.cancelBubble=!0,e.stopPropagation()})}e.container.find(".pg-bg-etime").empty().append(o("<span></span>").text(String(e.execution_time))).append(o("<span></span>").text(" "+t("seconds")));var s=o(e.container.find(".pg-bg-status"));s.empty().append(e.curr_status),0===e.exit_code?s.addClass("bg-success"):1==e.exit_code&&s.addClass("bg-failed")}else e.show_detailed_view.apply(e)},show_detailed_view:function(){var e=this,i=this.panel,a=!1;e.panel||(a=!0,i=this.panel=l.BackgroundProcessObsorver.create_panel(),i.title("Process Watcher - "+n.escape(e.desc)),i.focus());var r=i.$container,s=0===e.exit_code?"bg-bgprocess-success":1==e.exit_code?"bg-bgprocess-failed":"",d=r.find(".bg-process-watcher"),c=r.find(".bg-process-details"),p=r.find(".bg-process-footer");if(a&&(d.html(e.logs),setTimeout(function(){e.logs[0].scrollTop=e.logs[0].scrollHeight}),c.find(".bg-detailed-desc").html(e.detailed_desc)),c.find(".bg-process-stats .bgprocess-start-time").html(e.stime),p.find(".bg-process-status p").removeClass().addClass(s).html(e.curr_status),p.find(".bg-process-exec-time p").empty().append(o("<span></span>").text(String(e.execution_time))).append(o("<span></span>").text(" "+t("seconds"))),a){e.details=!0,e.err=0,e.out=0,setTimeout(function(){e.status.apply(e)},1e3);var u=function(e,t,i){var n=t.outerHeight()+i.outerHeight();e.css("padding-bottom",n)}.bind(i,d,c,p);i.on(wcDocker.EVENT.RESIZED,u),i.on(wcDocker.EVENT.ATTACHED,u),i.on(wcDocker.EVENT.DETACHED,u),u(),i.on(wcDocker.EVENT.CLOSED,function(e){e.panel=null,e.details=!1,null!=e.exit_code&&e.acknowledge_server.apply(e)}.bind(i,this))}},acknowledge_server:function(){var e=this;o.ajax({type:"PUT",timeout:3e4,url:e.bgprocess_url("acknowledge"),cache:!1,async:!0,contentType:"application/json",success:function(e){},error:function(e){}})}}),n.extend(l.BackgroundProcessObsorver,{bgprocesses:{},init:function(){var e=this;e.initialized||(e.initialized=!0,setTimeout(function(){e.update_process_list.apply(e)},1e3),l.Events.on("pgadmin-bgprocess:created",function(){setTimeout(function(){l.BackgroundProcessObsorver.update_process_list(!0)},1e3)}))},update_process_list:function(e){var t=this;o.ajax({typs:"GET",timeout:3e4,url:i("bgprocess.list"),cache:!1,async:!0,contentType:"application/json",success:function(i){if(i&&n.isArray(i)){for(var a in i){var o=i[a];"id"in o&&(o.id in t.bgprocesses||(t.bgprocesses[o.id]=new d(o)))}e&&0==i.length&&setTimeout(function(){t.update_process_list(!1)},3e3)}},error:function(e){}})},create_panel:function(){return this.register_panel(),l.docker.addPanel("bg_process_watcher",wcDocker.DOCK.FLOAT,null,{w:screen.width<700?.95*screen.width:.5*screen.width,h:screen.height<500?.95*screen.height:.5*screen.height,x:screen.width<700?"2%":"25%",y:screen.height<500?"2%":"25%"})},register_panel:function(){var e=l.docker,i=e.findPanels("bg_process_watcher");if(!(i&&i.length>=1)){new l.Panel({name:"bg_process_watcher",showTitle:!0,isCloseable:!0,isPrivate:!0,content:'<div class="bg-process-details col-xs-12"><p class="bg-detailed-desc"></p><div class="bg-process-stats"><span><b>'+t("Start time")+': </b><span class="bgprocess-start-time"></span></span></div></div><div class="bg-process-watcher col-xs-12"></div><div class="bg-process-footer col-xs-12"><div class="bg-process-status col-xs-6"><span><b>'+t("Status")+':</b></span><p></p></div><div class="bg-process-exec-time col-xs-6"><div class="exec-div pull-right"><span><b>'+t("Execution time")+":</b></span><p></p></div></div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow")}}).load(l.docker)}}}),l.BackgroundProcessObsorver}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(3),i(10),i(6),i(30)],void 0!==(a=function(e,t,i,n,a,o){return a.Browser.Nodes.server_group||(a.Browser.Nodes.server_group=a.Browser.Node.extend({parent_type:null,type:"server_group",dialogHelp:t("help.static",{filename:"server_group_dialog.html"}),label:e("Server Group"),width:"350px",height:"250px",is_collection:!0,Init:function(){this.initialized||(this.initialized=!0,a.Browser.add_menus([{name:"create_server_group",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Server Group..."),data:{action:"create"},icon:"wcTabIcon icon-server_group"}]))},model:a.Browser.Node.Model.extend({defaults:{id:void 0,name:null},schema:[{id:"id",label:e("ID"),type:"int",group:null,mode:["properties"]},{id:"name",label:e("Name"),type:"text",group:null,mode:["properties","edit","create"]}],validate:function(t,i){var a=null;return this.errorModel.clear(),!this.isNew()&&"id"in this.changed?(a=e("The ID cannot be changed."),this.errorModel.set("id",a),a):n.isUndefined(this.get("name"))||n.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(a=e("Name cannot be empty."),this.errorModel.set("name",a),a):null}}),canDrop:function(e,t,i){return!!e.can_delete},canDelete:function(e){var t=a.Browser.tree.siblings(e,!0);return!(!t||0==t.length)}})),a.Browser.Nodes.server_group}.apply(t,n))&&(e.exports=a)},function(e,n,a){"use strict";var o,l;o=[a(2),a(5),a(0),a(1),a(4),a(3),a(76),a(15),a(9),a(21),a(190)],void 0!==(l=function(e,n,a,o,l,r,s,c){if(!s.Nodes["coll-database"]){s.Nodes["coll-database"]=s.Collection.extend({node:"database",label:e("Databases"),type:"coll-database",columns:["name","datowner","comments"],hasStatistics:!0,statsPrettifyFields:["Size","Size of temporary files"]})}if(!s.Nodes.database){var p=function(e,t,i,n,a){u(e,t,i,n)},u=function(t,i,n,o,l){var r=l||i.connected,d=function t(i,a,o,l,r,s,d,m){m||(n.setInode(d),n.addIcon(d,{icon:"icon-database-not-connected"})),c.pgNotifier("error",i,o,function(i){setTimeout(function(){c.dlgServerPass(e("Connect to database"),i,l,r,s,d,m,p,t,u).resizeTo()},100)})},p=function(e,i,n,a,o,l){n.is_connecting=!1,l||(a.deselect(o),a.setInode(o)),e&&e.data&&("boolean"==typeof e.data.connected&&(n.connected=e.data.connected),"string"==typeof e.data.icon&&(a.removeIcon(o),n.icon=e.data.icon,a.addIcon(o,{icon:n.icon})),c.success(e.info),t.trigger("connected",t,o,n),s.Events.trigger("pgadmin:database:connected",o,n),l||setTimeout(function(){a.select(o),a.open(o)},10))},u=function(e,i,n,a){n.is_connecting=!1;var o=e.parent(i);e.unload(i),e.setInode(i),e.removeIcon(i),e.addIcon(i,{icon:"icon-database-not-connected"}),t.trigger("connect:cancelled",t,i,n),s.Events.trigger("pgadmin:database:connect:cancelled",i,n,t),e.select(o)};a.post(t.generate_url(o,"connect",i,!0)).done(function(e){if(1==e.success)return p(e,t,i,n,o,r)}).fail(function(e,a,l){return d(e,0,l,t,i,n,o,r)})};s.Nodes.database=s.Node.extend({parent_type:"server",type:"database",sqlAlterHelp:"sql-alterdatabase.html",sqlCreateHelp:"sql-createdatabase.html",dialogHelp:n("help.static",{filename:"database_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Size","Size of temporary files"],canDrop:function(e){return e.canDrop},label:e("Database"),node_image:function(){return"pg-icon-database"},Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_database_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database_on_coll",node:"coll-database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"connect_database",node:"database",module:this,applies:["object","context"],callback:"connect_database",category:"connect",priority:4,label:e("Connect Database..."),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_database",node:"database",module:this,applies:["object","context"],callback:"disconnect_database",category:"drop",priority:5,label:e("Disconnect Database..."),icon:"fa fa-chain-broken",enable:"is_connected"}]),o.bindAll(this,"connection_lost"),s.Events.on("pgadmin:database:connection:lost",this.connection_lost))},can_create_database:function(e,t){var i=this.getTreeNodeHierarchy(t),n=i.server;return n.connected&&n.user.can_create_db},is_not_connected:function(e){return e&&1!=e.connected&&1==e.allowConn},is_connected:function(e){return e&&1==e.connected&&1==e.canDisconn},is_conn_allow:function(e){return e&&1==e.allowConn},connection_lost:function(t,i,n){if(s.tree){for(var a=s.tree,l=(t&&this.getTreeNodeHierarchy(t),t&&a.itemData(t)),r=this;l&&"database"!=l._type;)t=a.parent(t),l=t&&a.itemData(t);if(t&&l){if(!l.allowConn)return!1;if(o.isUndefined(l.is_connecting)||!l.is_connecting){l.is_connecting=!0;var d=function e(t,i){i._id==this._id&&(l.is_connecting=!1,s.Events.off("pgadmin:database:connect:cancelled",e),t=t&&a.parent(t),i=t&&a.itemData(t),t&&i&&s.Events.trigger("pgadmin:server:disconnect",{item:t,data:i},!1))};if(s.Events.on("pgadmin:database:connect:cancelled",d),n)return void u(r,l,a,t,!0);c.confirm(e("Connection lost"),e("Would you like to reconnect to the database?"),function(){u(r,l,a,t,!0)},function(){l.is_connecting=!1,a.unload(t),a.setInode(t),a.addIcon(t,{icon:"icon-database-not-connected"}),s.Events.trigger("pgadmin:database:connect:cancelled",t,l,r)})}}}},callbacks:{connect_database:function(e){var n=e||{};return obj=this,t=s.tree,i=n.item||t.selected(),d=i&&1==i.length?t.itemData(i):void 0,!(!d||"template0"==d.label)&&(p(obj,d,t,i),!1)},disconnect_database:function(t){var i=t||{},n=this,o=s.tree,r=i.item||o.selected(),d=r&&1==r.length?o.itemData(r):void 0;return!!d&&(c.confirm(e("Disconnect the database"),l(e("Are you sure you want to disconnect the database - %s?")).sprintf(d.label).value(),function(e){var t=d;a.ajax({url:n.generate_url(r,"connect",d,!0),type:"DELETE",success:function(e){if(1==e.success){var i=o.parent(r);c.success(e.info),o.removeIcon(r),t.connected=!1,t.icon="icon-database-not-connected",o.addIcon(r,{icon:t.icon}),o.unload(r),o.setInode(r),setTimeout(function(){o.select(i)},10)}else{try{c.error(e.errormsg)}catch(e){}o.unload(r)}},error:function(e,t,i){try{var n=a.parseJSON(e.responseText);0==n.success&&c.error(n.errormsg)}catch(e){}o.unload(r)}})},function(e){return!0}),!1)},beforeopen:function(e,t){return!(!t||"database"!=t._type||"template0"==t.label)&&(s.tree.addIcon(e,{icon:t.icon}),!(!t.connected&&t.allowConn)||(p(this,t,s.tree,e),!1))},selected:function(e,t){return!(!t||"database"!=t._type)&&(s.tree.addIcon(e,{icon:t.icon}),!t.connected&&t.allowConn?(p(this,t,s.tree,e),!1):s.Node.callbacks.selected.apply(this,arguments))},refresh:function(e,t){var i=s.tree,n=t||i.selected();i.itemData(n).allowConn&&s.Node.callbacks.refresh.apply(this,arguments)}},model:s.Node.Model.extend({defaults:{name:void 0,owner:void 0,comment:void 0,encoding:"UTF8",template:void 0,tablespace:void 0,collation:void 0,char_type:void 0,datconnlimit:-1,datallowconn:void 0,variables:[],privileges:[],securities:[],datacl:[],deftblacl:[],deffuncacl:[],defseqacl:[],is_template:!1,deftypeacl:[]},initialize:function(e,t){if(0===o.size(e)){var i=s.serverInfo[t.node_info.server._id].user;this.set({datowner:i.name},{silent:!0})}s.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Database"),cell:"string",editable:!1,type:"text"},{id:"did",label:e("OID"),cell:"string",mode:["properties"],editable:!1,type:"text"},{id:"datowner",label:e("Owner"),editable:!1,type:"text",node:"role",control:Backform.NodeListByNameControl,select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"tblacl",label:e("Default TABLE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"seqacl",label:e("Default SEQUENCE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"funcacl",label:e("Default FUNCTION privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"typeacl",label:e("Default TYPE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0,min_version:90200},{id:"comments",label:e("Comment"),editable:!1,type:"multiline"},{id:"encoding",label:e("Encoding"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},url:"get_encodings",control:"node-ajax-options",cache_level:"server"},{id:"template",label:e("Template"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},control:"node-list-by-name",url:"get_databases",cache_level:"server",select2:{allowClear:!1},mode:["create"],transform:function(e,t){var i=[],n=t||this,a=n.model.get("name");return n.model.isNew()?e&&o.isArray(e)&&o.each(e,function(e){i.push({label:e.label,value:e.label,image:"pg-icon-database"})}):i.push({label:a,value:a}),i}},{id:"spcname",label:e("Tablespace"),editable:!1,type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"datcollate",label:e("Collation"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datctype",label:e("Character type"),editable:!1,type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datconnlimit",label:e("Connection limit"),editable:!1,type:"int",group:e("Definition"),min:-1},{id:"is_template",label:e("Template?"),editable:!1,type:"switch",group:e("Definition"),disabled:!0,mode:["properties","edit"],options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"datallowconn",label:e("Allow connections?"),editable:!1,type:"switch",group:e("Definition"),mode:["properties"],disabled:!0,options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"datacl",label:e("Privileges"),type:"collection",model:s.Node.PrivilegeRoleModel.extend({privileges:["C","T","c"]}),uniqueCol:["grantee","grantor"],editable:!1,group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"variables",label:e("Parameters"),type:"collection",model:s.Node.VariableModel.extend({keys:["name","role"]}),editable:!1,group:e("Parameters"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0,hasRole:!0,control:Backform.VariableCollectionControl,node:"role"},{id:"seclabels",label:e("Security Labels"),model:s.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:e("Security"),canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"],min_version:90200},{type:"nested",control:"tab",group:e("Default Privileges"),mode:["edit"],schema:[{id:"deftblacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:e("Default Privileges: Tables"),editable:!1,type:"collection",group:e("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:e("Default Privileges: Sequences"),editable:!1,type:"collection",group:e("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:e("Default Privileges: Functions"),editable:!1,type:"collection",group:e("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:s.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:e("Default Privileges: Types"),editable:!1,type:"collection",group:"deftypesacl_group",mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200},{id:"deftypesacl_group",type:"group",label:e("Types"),mode:["edit","create"],min_version:90200}]}],validate:function(t){var i=this.get("name");if(o.isUndefined(i)||o.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}return this.errorModel.unset("name"),null}})}),s.SecurityGroupSchema={id:"security",label:e("Security"),type:"group",visible:function(e){if(e&&"node_info"in e){return!("catalog"in(e.node_info||e.handler.node_info))}return!0}}}return s.Nodes["coll-database"]}.apply(n,o))&&(e.exports=l)},function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(22),i(155),i(9),i(51),i(190)],void 0!==(o=function(e,t,i,a,o,l,r,s,d){if(!r.Nodes["coll-role"]){l.Browser.Nodes["coll-role"]=l.Browser.Collection.extend({node:"role",type:"coll-role",columns:["rolname","rolvaliduntil","rolconnlimit","rolcanlogin","rolsuper","rolcreaterole","rolcreatedb","rolcatupdate","rolinherit","rolreplication"]})}var c=l.Browser.SecurityModel=l.Browser.SecurityModel||l.Browser.Node.Model.extend({defaults:{provider:null,label:null},schema:[{id:"provider",label:e("Provider"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"},{id:"label",label:e("Security Label"),type:"text",disabled:!1}],validate:function(){var t=this.toJSON();if(a.isUndefined(t.provider)||a.isNull(t.provider)||""==String(t.provider).replace(/^\s+|\s+$/g,"")){var i=e("Please specify the value for all the security providers.");return this.errorModel.set("provider",i),i}if(this.errorModel.unset("provider"),a.isUndefined(t.label)||a.isNull(t.label)||""==String(t.label).replace(/^\s+|\s+$/g,"")){var i=e("Please specify the value for all the security providers.");return this.errorModel.set("label",i),i}return this.errorModel.unset("label"),null}}),p={onText:e("Yes"),offText:e("No"),size:"mini"},u=d.SwitchControl.extend({template:a.template(['<label class="control-label pg-el-sm-9 pg-el-xs-12"><%=label%></label>','<div class="pgadmin-controls pg-el-sm-3 pg-el-xs-12">','  <div class="checkbox" style="float:right">',"    <label>",'      <input type="checkbox" class="<%=extraClasses.join(\' \')%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    </label>","  </div>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))}),g=d.Control.extend({defaults:a.defaults({extraClasses:["col-xs-12 col-sm-12 col-md-12"]},d.NodeListByNameControl.prototype.defaults),initialize:function(){d.NodeListByNameControl.prototype.initialize.apply(this,arguments)},formatter:{fromRaw:function(e,t){var i=a.isObject(e)?e:JSON.parse(e);return a.pluck(i,"role")},toRaw:function(e,t){return e}},template:a.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select multiple="multiple" style="width:100%;" class="pgadmin-controls <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>>',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value=<%-option.value%> data-icon=<%-option.image%> <%=value != null && _.indexOf(value, option.value) != -1 ? "selected" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),selectionTemplate:a.template(["<span>",'  <span class="wcTabIcon <%= optimage %>"></span>',"  <span><%= opttext %><span>","  <% if (checkbox) { %>",'  <input type="checkbox" <%=disabled ? "disabled=\'disabled\'" : ""%>/>',"  <% } %>","</span>"].join("\n")),events:{"change select":"onChange"},getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each(function(){e.push(i(this).attr("value"))}),e},render:function(){var t=a.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),o=t.name.split("."),l=o.shift(),r=o.join("."),s=this.keyPathAccessor(n[l],r),c=a.extend(t,{rawValue:s,value:this.formatter.fromRaw(s,this.model),attributes:n,formatter:this.formatter}),p=function(e,t,i){return a.isFunction(e)?!!e.apply(t,[i]):!!e};if(a.extend(c,{disabled:p(c.disabled,c,this.model),visible:p(c.visible,c,this.model),required:p(c.required,c,this.model),helpMessage:function(e,t,i){return a.isFunction(e)?e.apply(t,[i]):e}(c.helpMessage,c,this.model)}),a.isFunction(c.options))try{c.options=c.options.apply(this)}catch(e){c.options=[],this.model.trigger("pgadmin-view:transform:error",m,u.field,e)}this.$el.removeClass(d.hiddenClassName),c.visible||this.$el.addClass(d.hiddenClassName),this.$el.html(this.template(c)).addClass(t.name),this.updateInvalid();var u=this,g=this.model.get(this.field.get("name")),h=function(e){if(!e.id)return e.text;var t=i(e.element).data("icon");if(t){var n=a.extend({},c,{opttext:a.escape(e.text),optimage:t,checkbox:!1});return i(u.selectionTemplate(n))}return e.text},b=function(e){if(!e.id)return e.text;var t=i(e.element).data("icon"),n=function(t){return a.each(g.where({role:e.id}),function(e){e.set("admin",i(t.target).is(":checked"))}),!1};if(t){var o=a.extend({},c,{opttext:a.escape(e.text),optimage:t,checkbox:!0}),l=i(u.selectionTemplate(o));return setTimeout(function(){a.each(g.where({role:e.id}),function(e){l.find("input").prop("checked",e.get("admin"))})},200),l.find("input").on("change",n),l}return e.text};return this.$el.find("select").select2({templateResult:h,templateSelection:b,multiple:!0,tags:!0,allowClear:!c.disabled,placeholder:c.disabled?"":e("Select members"),width:"style"}).on("change",function(e){i(e.target).find(":selected").each(function(){})}),this},onChange:function(e){var t=this.model,n=(i(e.target),this.field.get("name").split(".")),o=n.shift(),l=(n.join("."),this.getValueFromDOM()),r=t.get(o),s=[];this.stopListening(this.model,"change:"+o,this.render),r.each(function(e){var t=e.get("role"),i=a.indexOf(l,t);i>-1?l.splice(i,1):s.push(t)}),a.each(l,function(e){r.add({role:e})}),a.each(s,function(e){r.remove(r.where({role:e}))}),this.listenTo(this.model,"change:"+o,this.render)}});if(!r.Nodes.role){var h;l.Browser.Nodes.role=l.Browser.Node.extend({parent_type:"server",type:"role",sqlAlterHelp:"sql-alterrole.html",sqlCreateHelp:"sql-createrole.html",dialogHelp:t("help.static",{filename:"role_dialog.html"}),label:e("Login/Group Role"),hasSQL:!0,width:"550px",canDrop:function(e,t){var i=this.getTreeNodeHierarchy(t),n=i.server;return e.is_superuser?n.connected&&n.user.is_superuser:n.connected&&n.user.can_create_role},hasDepends:!0,node_label:function(e){return e.label},node_image:function(e){return null==e||void 0==e?"icon-role":e.can_login?"icon-role":"icon-group"},title:function(t){return t?t.can_login?e("Login Role")+" - "+t.label:e("Group Role")+" - "+t.label:this.label},Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_role_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role_on_roles",node:"coll-role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role",node:"role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"}]))},can_create_role:function(e,t){var i=this.getTreeNodeHierarchy(t),n=i.server;return n.connected&&n.user.can_create_role},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:null,rolname:void 0,rolcanlogin:!1,rolpassword:null,rolconnlimit:-1,rolsuper:!1,rolcreaterole:!1,rolcreatedb:!1,rolinherit:!0,rolcatupdate:!1,rolreplication:!1,rolmembership:[],rolvaliduntil:null,seclabels:[],variables:[]},schema:[{id:"rolname",label:e("Name"),type:"text",disabled:"readonly"},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],editable:!1,type:"text",visible:!0,disabled:!0},{id:"rolpassword",label:e("Password"),type:"password",group:e("Definition"),mode:["edit","create"],control:"input",deps:["rolcanlogin"],retype:!0,cell:"string",disabled:function(e){if(!e.isNew()){var t=this.node_info.server.user;return!(t.is_superuser||t.can_create_role)&&t.id!=e.get("oid")}return!1}},{id:"rolvaliduntil",disabled:"readonly",type:"text",group:e("Definition"),label:e("Account expires"),mode:["properties","edit","create"],control:"datetimepicker",deps:["rolcanlogin"],options:{format:"YYYY-MM-DD HH:mm:ss Z"}},{id:"rolconnlimit",type:"int",group:e("Definition"),label:e("Connection limit"),cell:"integer",min:-1,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcanlogin",label:e("Can login?"),type:"switch",group:e("Privileges"),options:p,disabled:"readonly",control:u},{id:"rolsuper",label:e("Superuser"),type:"switch",group:e("Privileges"),options:p,control:u.extend({onChange:function(){d.SwitchControl.prototype.onChange.apply(this,arguments),this.model.set("rolcatupdate",this.model.get("rolsuper")),this.model.set("rolcreaterole",this.model.get("rolsuper")),this.model.set("rolcreatedb",this.model.get("rolsuper"))}}),disabled:"readonly"},{id:"rolcreaterole",label:e("Create roles?"),group:e("Privileges"),type:"switch",options:p,disabled:"readonly",control:u},{id:"description",label:e("Comments"),type:"multiline",group:null,mode:["properties","edit","create"],options:p,disabled:"readonly"},{id:"rolcreatedb",label:e("Create databases?"),group:e("Privileges"),type:"switch",options:p,disabled:"readonly",control:u},{id:"rolcatupdate",label:e("Update catalog?"),type:"switch",max_version:90400,options:p,control:u,group:e("Privileges"),disabled:function(e){return e.get("read_only")||!e.get("rolsuper")}},{id:"rolinherit",group:e("Privileges"),label:e("Inherit rights from the parent roles?"),type:"switch",options:p,disabled:"readonly",control:u},{id:"rolreplication",group:e("Privileges"),label:e("Can initiate streaming replication and backups?"),type:"switch",min_version:90100,options:p,disabled:"readonly",control:u},{id:"rolmembership",label:e("Roles"),group:e("Membership"),type:"collection",cell:"string",disabled:"readonly",mode:["properties","edit","create"],control:g,model:r.Node.Model.extend({keys:["role"],idAttribute:"role",defaults:{role:void 0,admin:!1},validate:function(){return null}}),filter:function(e){return this.model.isNew()||this.model.get("rolname")!=e.label},helpMessage:function(t){return e(t.has("read_only")&&0==t.get("read_only")?"Select the checkbox for roles to include WITH ADMIN OPTION.":"Roles shown with a check mark have the WITH ADMIN OPTION set.")}},(h={id:"variables",label:e("Parameters"),type:"collection",group:e("Parameters"),hasDatabase:!0,url:"variables",model:r.Node.VariableModel.extend({keys:["name","database"]}),control:"variable-collection",mode:["edit","create"],canAdd:!0,canDelete:!0},n(h,"url","variables"),n(h,"disabled","readonly"),h),{id:"seclabels",label:e("Security Labels"),model:c,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,disabled:"readonly",canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],readonly:function(e){if(!e.has("read_only")){var t=this.node_info.server.user;e.set("read_only",!(t.is_superuser||t.can_create_role))}return e.get("read_only")},validate:function(){var t,i={},n=this.get("seclabels");if((a.isUndefined(this.get("rolname"))||""==String(this.get("rolname")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),n)for(var o,l=0;l<n.models.length&&!o;l++)(o=n.models[l].validate.apply(n.models[l]))&&(i.seclabels=o,t=t||o);return this.errorModel.clear().set(i),a.size(i)?(this.trigger("on-status",{msg:t}),t):null}})})}return r.Nodes.role}.apply(t,a))&&(e.exports=o)},function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(9)],void 0!==(o=function(e,t,i,a,o,l,r,s){if(!r.Nodes["coll-cast"]){l.Browser.Nodes["coll-cast"]=l.Browser.Collection.extend({node:"cast",label:e("Casts"),type:"coll-cast",columns:["name","description"]})}if(!r.Nodes.cast){var d;l.Browser.Nodes.cast=l.Browser.Node.extend({parent_type:"database",type:"cast",sqlAlterHelp:"sql-altercast.html",sqlCreateHelp:"sql-createcast.html",dialogHelp:t("help.static",{filename:"cast_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("Cast"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_cast_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"},enable:r.Nodes.database.is_conn_allow},{name:"create_cast_on_coll",node:"coll-cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}},{name:"create_cast",node:"cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}}]))},model:l.Browser.Node.Model.extend({defaults:{name:void 0,encoding:"UTF8",srctyp:void 0,trgtyp:void 0,proname:void 0,castcontext:void 0,syscast:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",editable:!1,type:"text",disabled:!0,cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"srctyp",label:e("Source type"),url:"get_type",type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},mode:["create"],transform:function(e){return a.each(e,function(e){e.image="icon-cast"}),e},control:Backform.NodeAjaxOptionsControl.extend({onChange:function(){Backform.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");void 0!=e&&""!=e&&void 0!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"srctyp",label:e("Source type"),type:"text",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"trgtyp",label:e("Target type"),url:"get_type",type:"text",group:e("Definition"),disabled:function(e){return!e.isNew()},mode:["create"],transform:function(e){return a.each(e,function(e){e.image="icon-cast"}),e},control:Backform.NodeAjaxOptionsControl.extend({onChange:function(){Backform.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");void 0!=e&&""!=e&&void 0!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"trgtyp",label:e("Target type"),type:"text",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"proname",label:e("Function"),deps:["srctyp","trgtyp"],type:"text",disabled:function(e){return!e.isNew()},group:e("Definition"),mode:["create"],control:"node-ajax-options",options:function(e){var t=e.model.get("srctyp"),n=e.model.get("trgtyp"),a=[];if(void 0!=t&&""!=t&&void 0!=n&&""!=n){var o=e.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_functions",e.field.get("node_data"),!1,e.field.get("node_info")]);i.ajax({type:"POST",timeout:3e4,url:l,cache:!1,async:!1,data:{srctyp:t,trgtyp:n},success:function(e){return a=e.data},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&s.error(a.errormsg)}catch(e){}}})}return a}},{id:"proname",label:e("Function"),type:"text",group:e("Definition"),disabled:!0,mode:["properties","edit"]},{id:"castcontext",label:e("Context"),options:{onText:"IMPLICIT",offText:"EXPLICIT"},editable:!1,type:"string",group:e("Definition"),mode:["create"],control:Backform.SwitchControl.extend({getValueFromDOM:function(){return this.$input.prop("checked")?"IMPLICIT":"EXPLICIT"}})},{id:"castcontext",label:e("Context"),disabled:!0,options:[{label:"IMPLICIT",value:"IMPLICIT"},{label:"EXPLICIT",value:"EXPLICIT"},{label:"ASSIGNMENT",value:"ASSIGNMENT"}],editable:!1,type:"select2",group:e("Definition"),mode:["properties","edit"]},{id:"syscast",label:e("System cast?"),cell:"switch",type:"switch",mode:["properties"],disabled:!0,options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},(d={id:"description",label:e("Comment"),type:"text"},n(d,"type","multiline"),n(d,"cellHeaderClasses","width_percent_50"),d)],validate:function(t){var i=this.get("srctyp"),n=this.get("trgtyp");if(a.isUndefined(i)||a.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var o=e("Source type must be selected.");return this.errorModel.set("srctyp",o),o}if(this.errorModel.unset("srctyp"),a.isUndefined(n)||a.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")){var o=e("Target type must be selected.");return this.errorModel.set("trgtyp",o),o}return this.errorModel.unset("trgtyp"),this.trigger("on-status-clear"),null}})})}return r.Nodes["coll-cast"]}.apply(t,a))&&(e.exports=o)},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(9),i(51),i(21)],void 0!==(o=function(e,t,i,a,o,l,r,s){if(!r.Nodes["coll-tablespace"]){r.Nodes["coll-tablespace"]=r.Collection.extend({node:"tablespace",label:e("Tablespaces"),type:"coll-tablespace",columns:["name","spcuser","description"],hasStatistics:!0,statsPrettifyFields:["Size"]})}return r.Nodes.tablespace||(r.Nodes.tablespace=r.Node.extend({parent_type:"server",type:"tablespace",sqlAlterHelp:"sql-altertablespace.html",sqlCreateHelp:"sql-createtablespace.html",dialogHelp:t("help.static",{filename:"tablespace_dialog.html"}),label:e("Tablespace"),hasSQL:!0,canDrop:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Size"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_tablespace_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace_on_coll",node:"coll-tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"move_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"move_objects",category:"move_tablespace",priority:5,label:e("Move objects to..."),icon:"fa fa-exchange",data:{action:"create"},enable:"can_move_objects"}]))},can_create_tablespace:function(e,t){var i=this.getTreeNodeHierarchy(t),n=i.server;return n.connected&&n.user.is_superuser},can_move_objects:function(e,t){var i=this.getTreeNodeHierarchy(t),n=i.server;return n.connected&&n.user.is_superuser&&n.version>=90400},callbacks:{move_objects:function(o){var l=o||{},d=this,c=r.tree,p=l.item||c.selected(),u=p&&1==p.length?c.itemData(p):void 0,m=(u&&r.Nodes[u._type],d.generate_url(p,"move_objects",u,!0)),g=d.generate_url(p,"move_objects_sql",u,!0);if(!u)return!1;var h=n.Model.extend({idAttribute:"id",defaults:{new_tblspc:void 0,obj_type:"all",user:void 0},schema:[{id:"tblspc",label:e("New tablespace"),type:"text",disabled:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return e&&e.label!=u.label}},{id:"obj_type",label:e("Object type"),type:"text",disabled:!1,control:"select2",select2:{allowClear:!1,width:"100%"},options:[{label:e("All"),value:"all"},{label:e("Tables"),value:"tables"},{label:e("Indexes"),value:"indexes"},{label:e("Materialized views"),value:"materialized_views"}]},{id:"user",label:e("Object owner"),type:"text",disabled:!1,control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"sqltab",label:e("SQL"),group:e("SQL"),type:"text",disabled:!1,control:Backform.SqlTabControl.extend({initialize:function(){Backform.SqlTabControl.prototype.initialize.apply(this,arguments)},onTabChange:function(e){if(this.dialog&&e.shown==this.tabIndex){var t=this,n=t.model.toJSON();n.old_tblspc=u.label,i.ajax({url:g,type:"GET",cache:!1,data:n,dataType:"json",contentType:"application/json"}).done(function(e){t.sqlCtrl.clearHistory(),t.sqlCtrl.setValue(e.data),t.sqlCtrl.refresh()}).fail(function(){t.model.trigger("pgadmin-view:msql:error")}).always(function(){t.model.trigger("pgadmin-view:msql:fetched")})}}})}],validate:function(){return null}});s.move_objects_dlg||s.dialog("move_objects_dlg",function(){return{main:function(){var t=e("Move objects to another tablespace");this.set("title",t)},build:function(){s.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Users"),url:t("help.static",{filename:"move_objects.html"})}},{text:e("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button"}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this,n=i("<div class='move_objects'></div>");this.__internal.buttons[1].element.disabled=!0;var o=r.tree,l=o.selected(),s=l&&1==l.length?o.itemData(l):void 0,d=s&&r.Nodes[s._type];if(s){var c=d.getTreeNodeHierarchy.apply(d,[l]),p=new h({},{node_info:c}),u=Backform.generateViewSchema(c,p,"create",d,c.server,!0),m=this.view=new Backform.Dialog({el:n,model:p,schema:u});i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),m.render(),this.elements.content.appendChild(n.get(0)),this.view.model.on("change",function(){a.isUndefined(this.get("tblspc"))||""===this.get("tblspc")?(t.__internal.buttons[1].element.disabled=!0,this.errorModel.set("tblspc",e("Please select tablespace"))):(this.errorModel.clear(),t.__internal.buttons[1].element.disabled=!1)})}},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void r.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null,t.button.element.getAttribute("label"));if(t.button.text===e("OK")){var n=this,a=this.view.model.toJSON();a.old_tblspc=u.label,t.cancel=!0,s.confirm(e("Move objects..."),e("Are you sure you wish to move the objects from %(old_tablespace)s to %(new_tablespace)s?",{old_tablespace:a.old_tblspc,new_tablespace:a.tblspc}),function(){i.ajax({url:m,method:"PUT",data:{data:JSON.stringify(a)},success:function(e){e.success?(s.success(e.info),n.close()):s.error(e.errormsg)},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&s.error(a.errormsg)}catch(e){}}})},function(){})}}}}),s.move_objects_dlg(!0).resizeTo("40%","50%")}},model:r.Node.Model.extend({defaults:{name:void 0,owner:void 0,comment:void 0,spclocation:void 0,spcoptions:[],spcacl:[],seclabels:[]},initialize:function(e,t){if(0===a.size(e)){var i=r.serverInfo[t.node_info.server._id].user;this.set({spcuser:i.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"spclocation",label:e("Location"),cell:"string",group:e("Definition"),type:"text",mode:["properties","edit","create"],disabled:function(e){return!e.isNew()}},{id:"spcuser",label:e("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"spcoptions",label:e("Parameters"),type:"collection",group:e("Parameters"),control:"variable-collection",model:r.Node.VariableModel,mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},{id:"spcacl",label:e("Privileges"),type:"collection",group:e("Security"),control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["C"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],columns:["grantee","grantor","privileges"]},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=(this.sessAttrs,void 0);return a.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t)):a.isUndefined(this.get("spclocation"))||""==String(this.get("spclocation")).replace(/^\s+|\s+$/g,"")?(t=e("Location cannot be empty."),this.errorModel.set("spclocation",t)):(this.errorModel.unset("name"),this.errorModel.unset("spclocation")),null}})})),r.Nodes["coll-tablespace"]}.apply(t,a))&&(e.exports=o)}).call(t,i(10))},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(1),i(6),i(9)],void 0!==(a=function(e,t,i,n){return n.Nodes["coll-resource_group"]||(n.Nodes["coll-resource_group"]=n.Collection.extend({node:"resource_group",label:e("Resource Groups"),type:"coll-resource_group",columns:["name","cpu_rate_limit","dirty_rate_limit"]})),n.Nodes.resource_group||(n.Nodes.resource_group=n.Node.extend({parent_type:"server",type:"resource_group",dialogHelp:t("help.static",{ilename:"resource_group_dialog.html"}),label:e("Resource Group"),hasSQL:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,n.add_menus([{name:"create_resourcegroup_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"},enable:function(e,t){return this.getTreeNodeHierarchy(t).server.connected&&"ppas"===e.server_type&&e.version>=90400}},{name:"create_resource_group_on_coll",node:"coll-resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}},{name:"create_resource_group",node:"resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}}]))},model:n.Node.Model.extend({defaults:{name:void 0,cpu_rate_limit:0,dirty_rate_limit:0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"cpu_rate_limit",label:e("CPU rate limit (%%)"),cell:"string",type:"numeric",min:0,max:16777216},{id:"dirty_rate_limit",label:e("Dirty rate limit (KB)"),cell:"string",type:"numeric",min:0,max:16777216}],validate:function(t){var n,a,o,l,l=this.get("name");if(i.isUndefined(l)||i.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}this.errorModel.unset("name");var a=this.get("cpu_rate_limit");if(i.isUndefined(a)||i.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var n=e("CPU rate limit cannot be empty.");return this.errorModel.set("cpu_rate_limit",n),n}this.errorModel.unset("cpu_rate_limit");var o=this.get("dirty_rate_limit");if(i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")){var n=e("Dirty rate limit cannot be empty.");return this.errorModel.set("dirty_rate_limit",n),n}return this.errorModel.unset("dirty_rate_limit"),null}})})),n.Nodes["coll-resource_group"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-event_trigger"]){o.Browser.Nodes["coll-event_trigger"]=o.Browser.Collection.extend({node:"event_trigger",label:e("Event Trigger"),type:"coll-event_trigger",columns:["name","eventowner","comment"]})}return l.Nodes.event_trigger||(o.Browser.Nodes.event_trigger=o.Browser.Node.extend({parent_type:"database",type:"event_trigger",sqlAlterHelp:"sql-altereventtrigger.html",sqlCreateHelp:"sql-createeventtrigger.html",dialogHelp:t("help.static",{filename:"event_trigger_dialog.html"}),label:e("Event Trigger"),hasSQL:!0,hasDepends:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_event_trigger_on_coll",node:"coll-event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:o.Browser.Node.Model.extend({defaults:{oid:void 0,name:void 0,eventowner:void 0,comment:void 0,enabled:"O",eventfuncoid:void 0,eventfunname:void 0,eventname:"DDL_COMMAND_START",when:void 0,xmin:void 0,source:void 0,language:void 0},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({eventowner:i.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"eventowner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:Backform.NodeListByNameControl},{id:"comment",label:e("Comment"),type:"multiline"},{id:"enabled",label:e("Enabled status"),type:"radio",group:e("Definition"),mode:["properties","edit","create"],options:[{label:"Enable",value:"O"},{label:"Disable",value:"D"},{label:"Replica",value:"R"},{label:"Always",value:"A"}]},{id:"eventfunname",label:e("Trigger function"),type:"text",control:"node-ajax-options",group:e("Definition"),url:"fopts",cache_node:"trigger_function"},{id:"eventname",label:e("Events"),type:"radio",group:e("Definition"),cell:"string",options:[{label:"DDL COMMAND START",value:"DDL_COMMAND_START"},{label:"DDL COMMAND END",value:"DDL_COMMAND_END"},{label:"SQL DROP",value:"SQL_DROP"}]},{id:"when",label:e("When"),type:"multiline",group:e("Definition")},{id:"seclabels",label:e("Security Labels"),model:l.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger name cannot be empty."),this.errorModel.set("name",t),t):n.isUndefined(this.get("eventowner"))||""==String(this.get("eventowner")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger owner cannot be empty."),this.errorModel.set("eventowner",t),t):n.isUndefined(this.get("enabled"))?(t=e("Event trigger enabled status cannot be empty."),this.errorModel.set("enabled",t),t):n.isUndefined(this.get("eventfunname"))||""==String(this.get("eventfunname")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger function cannot be empty."),this.errorModel.set("eventfunname",t),t):n.isUndefined(this.get("eventname"))?(t=e("Event trigger event cannot be empty."),this.errorModel.set("eventname",t),t):null}})})),l.Nodes["coll-event_trigger"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(9)],void 0!==(a=function(e,t,i,n,a,o,l){if(!l.Nodes["coll-extension"]){o.Browser.Nodes["coll-extension"]=o.Browser.Collection.extend({node:"extension",label:e("Extension"),type:"coll-extension",columns:["name","owner","comment"]})}return l.Nodes.extension||(o.Browser.Nodes.extension=o.Browser.Node.extend({parent_type:"database",type:"extension",sqlAlterHelp:"sql-alterextension.html",sqlCreateHelp:"sql-createextension.html",dialogHelp:t("help.static",{filename:"extension_dialog.html"}),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,label:e("Extension"),Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_extension_on_coll",node:"coll-extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:o.Browser.Node.Model.extend({schema:[{id:"name",label:e("Name"),first_empty:!0,type:"text",mode:["properties","create","edit"],visible:!0,url:"avails",disabled:function(e){return!e.isNew()},transform:function(e,t){var i=[],a=t||this,o=a.model.get("name");return a.model.isNew()?e&&n.isArray(e)&&n.each(e,function(e){null===e.installed_version&&i.push({label:e.name,value:JSON.stringify(e)})}):i.push({label:o,value:o}),i},control:Backform.NodeAjaxOptionsControl.extend({getValueFromDOM:function(){var e=this.formatter.toRaw(n.unescape(this.$el.find("select").val()),this.model);return""===e?null:("string"==typeof e&&(e=JSON.parse(e)),e.name)},onChange:function(){Backform.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.$el.find("select").val();if(""!=e.trim()){var t=this.formatter.toRaw(e,this.model);"string"==typeof t&&(t=JSON.parse(t));var i={version:"",relocatable:n.isNull(t.relocatable[0])||n.isUndefined(t.relocatable[0])?"":t.relocatable[0]};this.model.set(i)}else{var i={version:"",relocatable:!0,schema:""};this.model.set(i)}}})},{id:"eid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),control:"node-list-by-name",mode:["properties"],node:"role",cell:"string",cache_level:"server"},{id:"schema",label:e("Schema"),type:"text",control:"node-list-by-name",group:e("Definition"),mode:["properties","create","edit"],deps:["relocatable"],node:"schema",first_empty:!0,disabled:function(e){return!!e.has("relocatable")&&!e.get("relocatable")}},{id:"relocatable",label:e("Relocatable?"),cell:"switch",group:e("Definition"),type:"switch",mode:["properties"],options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"version",label:e("Version"),cell:"string",mode:["properties","create","edit"],group:e("Definition"),control:"node-ajax-options",url:"avails",first_empty:!0,transform:function(e,t){var i=[],a=t||this,o=a.model.get("name");return n.each(e,function(e){e.name==o&&e.version&&n.isArray(e.version)&&n.each(e.version,function(e){i.push({label:e,value:e})})}),i}},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}],validate:function(){var t,i={},a=this.get("name");return n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(i.name=e("Name cannot be empty."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),null)}})})),l.Nodes["coll-extension"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-language"]){l.Nodes["coll-language"]=l.Collection.extend({node:"language",label:e("Languages"),type:"coll-language",columns:["name","lanowner","description"]})}return l.Nodes.language||(l.Nodes.language=l.Node.extend({parent_type:"database",type:"language",sqlAlterHelp:"sql-alterlanguage.html",sqlCreateHelp:"sql-createlanguage.html",dialogHelp:t("help.static",{filename:"language_dialog.html"}),label:e("Language"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_language_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"},enable:l.Nodes.database.is_conn_allow},{name:"create_language_on_coll",node:"coll-language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}},{name:"create_language",node:"language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}}]))},model:l.Node.Model.extend({defaults:{name:void 0,lanowner:void 0,comment:void 0,lanacl:[],seclabels:[],trusted:!0,lanproc:void 0,laninl:void 0,lanval:void 0,is_template:!1,template_list:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({lanowner:i.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",control:"node-ajax-options",mode:["properties","create","edit"],url:"get_templates",select2:{allowClear:!1,tags:!0,multiple:!1},transform:function(e,t){var i=[],a=t||this,o=a.model.get("name");if(a.model.isNew()){var l=[];e&&n.isArray(e)&&n.each(e,function(e){i.push({label:e.tmplname,value:e.tmplname}),l.push(e.tmplname)}),this.model.set({template_list:l})}else i.push({label:o,value:o});return i}},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text",disabled:!0},{id:"lanowner",label:e("Owner"),type:"text",control:Backform.NodeListByNameControl,node:"role",mode:["edit","properties","create"],select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"trusted",label:e("Trusted?"),type:"switch",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"},group:e("Definition"),mode:["edit","properties","create"],deps:["name"],disabled:function(e){if(e.isNew()){if(-1==e.get("template_list").indexOf(e.get("name")))return e.set({is_template:!1}),!1;e.set({is_template:!0})}return!0}},{id:"lanproc",label:e("Handler Function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,function(e){"handler"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"laninl",label:e("Inline Function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,function(e){"inline"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"lanval",label:e("Validator Function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,function(e){"validator"==e.prop_type&&t.push({label:e.label,value:e.label})}),t},disabled:function(e){return!e.isNew()||-1!=e.get("template_list").indexOf(e.get("name"))}},{id:"lanacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",mode:["edit","create"],model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security Labels"),mode:["edit","create"],model:l.SecLabelModel,editable:!1,type:"collection",group:"security",min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}if(this.errorModel.unset("name"),!this.get("is_template")){var a=this.get("lanproc");if(n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var i=e("Handler Function cannot be empty.");return this.errorModel.set("lanproc",i),i}this.errorModel.unset("lanproc")}return null}})})),l.Nodes["coll-language"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r){var s=l.Node.Model.extend({idAttribute:"fdwoption",defaults:{fdwoption:void 0,fdwvalue:void 0},schema:[{id:"fdwoption",label:e("Option"),type:"text",cellHeaderClasses:"width_percent_50",editable:!0},{id:"fdwvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("fdwoption"))||n.isNull(this.get("fdwoption"))||""==String(this.get("fdwoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fdwoption",e),e}return this.errorModel.unset("fdwoption"),null}});if(!l.Nodes["coll-foreign_data_wrapper"]){l.Nodes["coll-foreign_data_wrapper"]=l.Collection.extend({node:"foreign_data_wrapper",label:e("Foreign Data Wrappers"),type:"coll-foreign_data_wrapper",columns:["name","fdwowner","description"]})}return l.Nodes.foreign_data_wrapper||(l.Nodes.foreign_data_wrapper=l.Node.extend({parent_type:"database",type:"foreign_data_wrapper",sqlAlterHelp:"sql-alterforeigndatawrapper.html",sqlCreateHelp:"sql-createforeigndatawrapper.html",dialogHelp:t("help.static",{filename:"foreign_data_wrapper_dialog.html"}),label:e("Foreign Data Wrapper"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_foreign_data_wrapper_on_coll",node:"coll-foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:l.Node.Model.extend({defaults:{name:void 0,fdwowner:void 0,comment:void 0,fdwvalue:void 0,fdwhan:void 0,fdwoption:void 0,fdwacl:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({fdwowner:i.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:function(e){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fdwoid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"fdwowner",label:e("Owner"),type:"text",control:Backform.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fdwhan",label:e("Handler"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","create","properties"],url:"get_handlers"},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"fdwoptions",label:e("Options"),type:"collection",group:e("Options"),model:s,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fdwoption"],columns:["fdwoption","fdwvalue"]},{id:"fdwvalue",label:e("Validator"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","create","properties"],url:"get_validators"},{id:"security",label:e("Security"),type:"group"},{id:"fdwacl",label:e("Privileges"),type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection"},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}return this.errorModel.unset("name"),null}})})),l.Nodes.foreign_data_wrapper}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l){var r=a.Browser.Node.Model.extend({idAttribute:"fsrvoption",defaults:{fsrvoption:void 0,fsrvvalue:void 0},schema:[{id:"fsrvoption",label:e("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"fsrvvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(i.isUndefined(this.get("fsrvoption"))||i.isNull(this.get("fsrvoption"))||""==String(this.get("fsrvoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fsrvoption",e),e}return this.errorModel.unset("fsrvoption"),null}});if(!o.Nodes["coll-foreign_server"]){a.Browser.Nodes["coll-foreign_server"]=a.Browser.Collection.extend({node:"foreign_server",label:e("Foreign Servers"),type:"coll-foreign_server",columns:["name","fsrvowner","description"]})}return o.Nodes.foreign_server||(a.Browser.Nodes.foreign_server=a.Browser.Node.extend({parent_type:"foreign_data_wrapper",type:"foreign_server",sqlAlterHelp:"sql-alterforeignserver.html",sqlCreateHelp:"sql-createforeignserver.html",label:e("Foreign Server"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_foreign_server_on_coll",node:"coll-foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}}]))},model:a.Browser.Node.Model.extend({defaults:{name:void 0,fsrvtype:void 0,fsrvversion:void 0,fsrvvalue:void 0,fsrvoptions:[],fsrvowner:void 0,description:void 0,fsrvacl:[]},initialize:function(e,t){if(0===i.size(e)){var n=o.serverInfo[t.node_info.server._id].user;this.set({fsrvowner:n.name},{silent:!0})}a.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:function(e){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fsrvid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"fsrvowner",label:e("Owner"),type:"text",control:Backform.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fsrvtype",label:e("Type"),cell:"string",group:e("Definition"),type:"text",mode:["edit","create","properties"],disabled:function(e){return!e.isNew()}},{id:"fsrvversion",label:e("Version"),cell:"string",group:e("Definition"),type:"text"},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"fsrvoptions",label:e("Options"),type:"collection",group:e("Options"),model:r,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fsrvoption"],columns:["fsrvoption","fsrvvalue"]},o.SecurityGroupSchema,{id:"fsrvacl",label:e("Privileges"),type:"collection",group:"security",model:a.Browser.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0}],validate:function(){var t=this.get("name");if(i.isUndefined(t)||i.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}return this.errorModel.unset("name"),null}})})),o.Nodes["coll-foreign_server"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){var s=o.Browser.Node.Model.extend({idAttribute:"umoption",defaults:{umoption:void 0,umvalue:void 0},schema:[{id:"umoption",label:e("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"umvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("umoption"))||n.isNull(this.get("umoption"))||""==String(this.get("umoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("umoption",e),e}return this.errorModel.unset("umoption"),null}});if(!l.Nodes["coll-user_mapping"]){o.Browser.Nodes["coll-user_mapping"]=o.Browser.Collection.extend({node:"user_mapping",label:e("User Mappings"),type:"coll-user_mapping",columns:["name"]})}return l.Nodes.user_mapping||(o.Browser.Nodes.user_mapping=o.Browser.Node.extend({parent_type:"foreign_server",type:"user_mapping",sqlAlterHelp:"sql-alterusermapping.html",sqlCreateHelp:"sql-createusermapping.html",dialogHelp:t("help.static",{filename:"user_mapping_dialog.html"}),label:e("User Mapping"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_user_mapping_on_coll",node:"coll-user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}}]))},model:o.Browser.Node.Model.extend({defaults:{name:void 0,um_options:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user;this.set({name:i.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("User"),type:"text",control:Backform.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1},disabled:function(e){return!e.isNew()},transform:function(e){var t=this,i=t.field.get("schema_node"),n=Backform.NodeListByNameControl.prototype.defaults.transform.apply(this,arguments);return n.unshift({label:"CURRENT_USER",value:"CURRENT_USER",image:"icon-"+i.type},{label:"PUBLIC",value:"PUBLIC",image:"icon-"+i.type}),n}},{id:"um_oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"umoptions",label:e("Options"),type:"collection",group:e("Options"),model:s,control:"unique-col-collection",mode:["create","edit"],canAdd:!0,canDelete:!0,uniqueCol:["umoption"]}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}return this.errorModel.unset("name"),null}})})),l.Nodes["coll-user_mapping"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(17),i(8),i(9),i(21)],void 0!==(o=function(e,t,i,a,o,l,r,s,d){s.VacuumCollectionControl=s.Control.extend({grid_columns:void 0,initialize:function(){s.Control.prototype.initialize.apply(this,arguments);var e=this,t=this.model,n=e.field.get("url");if(n&&t.isNew()){var o,l=e.field.get("node"),r=e.field.get("node_data"),d=e.field.get("node_info"),c=l.generate_url.apply(l,[null,n,r,!1,d]);t.trigger("pgadmin-view:fetching",t,e.field),i.ajax({async:!1,url:c,success:function(e){o=e},error:function(){t.trigger("pgadmin-view:fetch:error",t,e.field)}}),t.trigger("pgadmin-view:fetched",t,e.field),o&&a.isArray(o)&&t.get(e.field.get("name")).reset(o,{silent:!0})}},render:function(){var e=this,t=(this.model,e.field.attributes);e.grid&&(e.grid.remove(),delete e.grid,e.grid=void 0),e.$el.empty();var o=a.template(['<div class="subnode-header">','  <label class="control-label col-sm-4"><%-label%></label>',"</div>"].join("\n")),l=i('<div class="pgadmin-control-group backgrid form-group col-xs-12 object subnode"></div>').append(o(t)),r=e.grid=new n.Grid({columns:e.grid_columns,collection:e.model.get(e.field.get("name")),className:"backgrid table-bordered"});return e.$el.append(i(l).append(r.render().$el)),e}}),s.cellFunction=function(e){switch(e.get("column_type")){case"integer":return n.IntegerCell;case"number":return n.NumberCell;case"string":return n.StringCell;default:return n.Cell}},s.VacuumTableModel=r.Node.Model.extend({defaults:{name:void 0,setting:void 0,label:void 0,value:void 0,column_type:void 0},toJSON:function(){var e=r.Node.Model.prototype.toJSON.apply(this);return delete e.label,delete e.setting,delete e.column_type,e}}),s.VacuumSettingsSchema=[{id:"autovacuum_custom",label:e("Custom auto-vacuum?"),group:e("Table"),mode:["edit","create"],type:"switch",disabled:function(e){return e.top&&e.top.get("is_partitioned")?(setTimeout(function(){e.set("autovacuum_custom",!1)},10),!0):!!e.top.inSchema.apply(this,[e])}},{id:"autovacuum_enabled",label:e("Enabled?"),group:e("Table"),mode:["edit","create"],type:"switch",deps:["autovacuum_custom"],disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&1==e.get("autovacuum_custom"))&&(setTimeout(function(){e.set("autovacuum_enabled",!1)},10),!0)}},{id:"vacuum_table",label:e("Vacuum Table"),model:s.VacuumTableModel,editable:!1,type:"collection",canEdit:!0,group:e("Table"),mode:["edit","create"],url:"get_table_vacuum",control:s.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:e("Label"),headerCell:n.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:e("Value"),cellHeaderClasses:"width_percent_30",cellFunction:s.cellFunction,editable:function(e){return e.handler.get("autovacuum_enabled")},headerCell:n.Extension.CustomHeaderCell},{name:"setting",label:e("Default value"),cellHeaderClasses:"width_percent_30",headerCell:n.Extension.CustomHeaderCell,cellFunction:s.cellFunction,editable:!1}]}),deps:["autovacuum_enabled"]},{id:"toast_autovacuum",label:e("Custom auto-vacuum?"),group:e("Toast Table"),mode:["edit","create"],type:"switch",disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&e.isNew())&&!!(e.top.inSchema.apply(this,[e])||!0!==e.get("toast_autovacuum_enabled")&&!0!==e.top.get("hastoasttable"))}},{id:"toast_autovacuum_enabled",label:e("Enabled?"),group:e("Toast Table"),mode:["edit","create"],type:"switch",deps:["toast_autovacuum"],disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&!0===e.get("toast_autovacuum"))&&((e.isNew()||e.get("hastoasttable"))&&setTimeout(function(){e.set("toast_autovacuum_enabled",!1)},10),!0)}},{id:"vacuum_toast",label:e("Vacuum Toast Table"),model:s.VacuumTableModel,type:"collection",editable:function(e){return e.isNew()},canEdit:!0,group:e("Toast Table"),mode:["properties","edit","create"],url:"get_toast_table_vacuum",control:s.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:e("Label"),headerCell:n.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:e("Value"),cellHeaderClasses:"width_percent_30",headerCell:n.Extension.CustomHeaderCell,cellFunction:s.cellFunction,editable:function(e){return e.handler.get("toast_autovacuum_enabled")}},{name:"setting",label:e("Default value"),cellHeaderClasses:"width_percent_30",headerCell:n.Extension.CustomHeaderCell,cellFunction:s.cellFunction,editable:!1}]}),deps:["toast_autovacuum_enabled"]}];if(!r.Nodes["coll-schema"]){r.Nodes["coll-schema"]=r.Collection.extend({node:"schema",label:e("Schemas"),type:"coll-schema",columns:["name","namespaceowner","description"]})}r.Nodes.schema||(r.Nodes.schema=r.Node.extend({parent_type:"database",type:"schema",sqlAlterHelp:"sql-alterschema.html",sqlCreateHelp:"sql-createschema.html",dialogHelp:t("help.static",{filename:"schema_dialog.html"}),label:e("Schema"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_schema_on_coll",node:"coll-schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"},enable:"can_create_schema"}]))},can_create_schema:function(e,t){return r.Nodes.database.is_conn_allow.call(this,e)},model:r.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,description:void 0,is_system_obj:void 0},initialize:function(e,t){if(0===a.size(e)){var i=r.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:i.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"is_sys_object",label:e("System schema?"),cell:"switch",type:"switch",mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"tblacl",label:e("Default TABLE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"seqacl",label:e("Default SEQUENCE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"funcacl",label:e("Default FUNCTION privileges"),group:e("Security"),type:"text",mode:["properties"],disabled:!0},{id:"typeacl",label:e("Default TYPE privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0,min_version:90200,visible:function(){return this.version_compatible}},{id:"nspacl",label:e("Privileges"),model:r.Node.PrivilegeRoleModel.extend({privileges:["C","U"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"},{type:"nested",control:"tab",group:e("Default Privileges"),mode:["create","edit"],schema:[{id:"deftblacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:e("Default Privileges: Tables"),editable:!1,type:"collection",group:e("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:e("Default Privileges: Sequences"),editable:!1,type:"collection",group:e("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:e("Default Privileges: Functions"),editable:!1,type:"collection",group:e("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:e("Default Privileges: Types"),editable:!1,type:"collection",group:e("Types"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200}]}],validate:function(){var t=null;return this.errorModel.clear(),a.isUndefined(this.get("name"))||a.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):a.isUndefined(this.get("namespaceowner"))||a.isNull(this.get("namespaceowner"))||""==String(this.get("namespaceowner")).replace(/^\s+|\s+$/g,"")?(t=e("Owner cannot be empty."),this.errorModel.set("namespaceowner",t),t):null}}),canChildDrop:function(e,t){for(var i=r.tree,n=t,o=e;n;){if(a.indexOf(["schema"],o._type)>-1)return!0;var l=i.hasParent(n)?i.parent(n):null,s=l?i.itemData(l):null;if(s&&"catalog"==s._type)return!1;n=i.hasParent(n)?i.parent(n):null,o=n?i.itemData(n):null}return!0}}),r.tableChildTreeNodeHierarchy=function(e){var t=0,i={},n=r.tree;do{var o=n.itemData(e);o._type in r.Nodes&&r.Nodes[o._type].hasId&&("partition"===o._type||"table"===o._type?"table"in i||(i.table=a.extend({},o,{priority:t}),t-=1):(i[o._type]=a.extend({},o,{priority:t}),t-=1)),e=n.hasParent(e)?n.parent(e):null}while(e);return i});n.Extension.TableChildSwitchCell=n.Extension.SwitchCell.extend({initialize:function(){n.Extension.SwitchCell.prototype.initialize.apply(this,arguments),n.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e,t=this.model,i=this.column,n=this.column.get("editable"),o=this.$el.find("input[type=checkbox]").first(),l=i.get("name");return e=a.isFunction(n)?!!n.apply(i,[t]):!!n,e?(this.$el.addClass("editable"),o.bootstrapSwitch("disabled",!1)):(this.$el.removeClass("editable"),o.bootstrapSwitch("disabled",!0),setTimeout(function(){t.set(l,!1)},10)),this.delegateEvents(),this},remove:n.Extension.DependentCell.prototype.remove});return r.Nodes.schema}.apply(t,a))&&(e.exports=o)}).call(t,i(11))},function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(4),i(3),i(6),i(17),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!o.Nodes["coll-catalog"]){o.Nodes["coll-catalog"]=o.Collection.extend({node:"catalog",label:e("Catalogs"),type:"coll-catalog",columns:["name","namespaceowner","description"]})}return o.Nodes.catalog||(o.Nodes.catalog=o.Node.extend({parent_type:"database",type:"catalog",label:e("Catalog"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:o.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0,securitylabel:[]},initialize:function(e,t){if(0===i.size(e)){var n=o.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:n.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:!0},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text",disabled:!0},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"seclabels",label:e("Security Labels"),model:o.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){return null}})})),o.Nodes.catalog}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l){if(!o.Nodes["coll-catalog_object"]){a.Browser.Nodes["coll-catalog_object"]=a.Browser.Collection.extend({node:"catalog_object",label:e("Catalog Objects"),type:"coll-catalog_object",columns:["name","owner","description"]})}return o.Nodes.catalog_object||(a.Browser.Nodes.catalog_object=a.Browser.Node.extend({parent_type:"catalog",type:"catalog_object",label:e("Catalog Object"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:a.Browser.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0},{id:"owner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}]})})),o.Nodes.catalog_object}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-collation"]){o.Browser.Nodes["coll-collation"]=o.Browser.Collection.extend({node:"collation",label:e("Collations"),type:"coll-collation",columns:["name","owner","description"]})}return l.Nodes.collation||(o.Browser.Nodes.collation=l.Node.extend({type:"collation",sqlAlterHelp:"sql-altercollation.html",sqlCreateHelp:"sql-createcollation.html",dialogHelp:t("help.static",{filename:"collation_dialog.html"}),label:e("Collation"),collection_type:"coll-collation",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_collation_on_coll",node:"coll-collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:l.Nodes.schema.canChildDrop,canDropCascade:l.Nodes.schema.canChildDrop,model:o.Browser.Node.Model.extend({defaults:{name:void 0,oid:void 0,owner:void 0,lc_type:void 0,lc_collate:void 0,description:void 0},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,a=t.node_info.schema;this.set({owner:i.name},{silent:!0}),this.set({schema:a._label},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",control:"node-list-by-name",node:"role"},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},control:"node-list-by-name",cache_node:"database",cached_level:"database"},{id:"copy_collation",label:e("Copy collation"),cell:"string",control:"node-ajax-options",type:"text",mode:["create","edit"],group:e("Definition"),url:"get_collations",disabled:"inSchemaWithModelCheck",deps:["locale","lc_collate","lc_type"]},{id:"locale",label:e("Locale"),cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),disabled:"inSchemaWithModelCheck",deps:["lc_collate","lc_type","copy_collation"]},{id:"lc_collate",label:e("LC_COLLATE"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["locale","copy_collation"],disabled:"inSchemaWithModelCheck"},{id:"lc_type",label:e("LC_TYPE"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),disabled:"inSchemaWithModelCheck",deps:["locale","copy_collation"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(){var t={},i=void 0,a=this.changed,o=!1,l=!1,r=!1,s=!1,i=void 0,d=this.toJSON();return this.errorModel.clear(),(n.has(a,d.name)&&n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i=e("Name cannot be empty."),this.errorModel.set("name",i)),n.has(a,d.locale)&&(n.isUndefined(this.get("locale"))||""==String(this.get("locale")).replace(/^\s+|\s+$/g,""))&&(o=!0),n.has(a,d.lc_collate)&&(n.isUndefined(this.get("lc_collate"))||""==String(this.get("lc_collate")).replace(/^\s+|\s+$/g,""))&&(r=!0),n.has(a,d.lc_type)&&(n.isUndefined(this.get("lc_type"))||""==String(this.get("lc_type")).replace(/^\s+|\s+$/g,""))&&(l=!0),n.has(a,d.copy_collation)&&(n.isUndefined(this.get("copy_collation"))||""==String(this.get("copy_collation")).replace(/^\s+|\s+$/g,""))&&(s=!0),o&&(r||l)&&s&&(i=e("Definition incomplete. Please provide Locale OR Copy Collation OR LC_TYPE/LC_COLLATE."),t.locale=i),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||(e.isNew()&&"copy_collation"==this.name?!!e.get("locale")||!(!e.get("lc_collate")&&!e.get("lc_type")):!e.isNew()||"lc_collate"!=this.name&&"lc_type"!=this.name?e.isNew()&&"locale"==this.name?!(!e.get("lc_collate")&&!e.get("lc_type"))||!!e.get("copy_collation"):!e.isNew():!!e.get("locale")||!!e.get("copy_collation"))}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-collation"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes.collation}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(l=function(e,t,i,o,l,r,s,d){if(!s.Nodes["coll-domain"]){s.Nodes["coll-domain"]=s.Collection.extend({node:"domain",label:e("Domains"),type:"coll-domain",columns:["name","owner","description"]})}var c=s.Node.Model.extend({idAttribute:"conoid",initialize:function(e,t){0===!o.size(e)&&(this.convalidated_default=this.get("convalidated")),s.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,convalidated:!0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:e("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_40",editable:function(e){if(o.isUndefined(e.isNew))return!0;if(!e.isNew()){if(this.get("node_info").server.version<90200)return!1}return!0}},{id:"consrc",label:e("Check"),type:"multiline",cell:n.Extension.TextareaCell,group:e("Definition"),cellHeaderClasses:"width_percent_60",editable:function(e){return!!o.isUndefined(e.isNew)||e.isNew()}},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",group:e("Definition"),editable:function(e){return!(this.get("node_info").server.version<90200||!o.isUndefined(e.isNew)&&!e.isNew()&&e.get("convalidated")&&e.convalidated_default)}}],toJSON:a.Model.prototype.toJSON,validate:function(){return null}});return s.Nodes.domain||(s.Nodes.domain=s.Node.extend({type:"domain",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-createdomain.html",dialogHelp:t("help.static",{filename:"domain_dialog.html"}),label:e("Domain"),collection_type:"coll-domain",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_domain_on_coll",node:"coll-domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:s.Nodes.schema.canChildDrop,canDropCascade:s.Nodes.schema.canChildDrop,model:s.Node.Model.extend({initialize:function(e,t){if(0===o.size(e)){var i=t.node_info.schema.label;this.set({basensp:i},{silent:!0});var n=s.serverInfo[t.node_info.server._id].user;this.set({owner:n.name},{silent:!0})}s.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,basetype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,typnotnull:void 0,sysdomain:void 0,collname:void 0,constraints:[],seclabels:[]},type_options:void 0,schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:Backform.NodeListByNameControl,node:"role",type:"text",mode:["edit","create","properties"]},{id:"basensp",label:e("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"sysdomain",label:e("System domain?"),cell:"boolean",type:"switch",mode:["properties"],options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"basetype",label:e("Base type"),cell:"string",control:"node-ajax-options",type:"text",url:"get_types",mode:["properties","create","edit"],group:e("Definition"),first_empty:!0,cache_node:"type",disabled:function(e){return!e.isNew()},transform:function(e){return this.model.type_options=e,e}},{id:"typlen",label:e("Length"),cell:"string",type:"text",group:e("Definition"),deps:["basetype"],disabled:function(e){if(!e.isNew())return!0;var t=e.get("basetype");return e.type_options&&o.each(e.type_options,function(i){t==i.value&&i.length&&(e.set("is_tlength",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0}))}),!e.get("is_tlength")}},{id:"precision",label:e("Precision"),cell:"string",type:"text",group:e("Definition"),deps:["basetype"],disabled:function(e){if(!e.isNew())return!0;var t=e.get("basetype");return e.type_options&&o.each(e.type_options,function(i){t==i.value&&i.precision&&(e.set("is_precision",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0}))}),!e.get("is_precision")}},{id:"typdefault",label:e("Default"),cell:"string",type:"text",group:e("Definition"),placeholder:"Enter an expression or a value."},{id:"typnotnull",label:e("Not Null?"),cell:"boolean",type:"switch",group:e("Definition"),options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"collname",label:e("Collation"),cell:"string",control:"node-ajax-options",type:"text",url:"get_collations",group:e("Definition"),cache_level:"database",cache_node:"schema",disabled:function(e){return!e.isNew()}},{id:"constraints",label:e("Constraints"),cell:"string",type:"collection",group:e("Constraints"),mode:["edit","create"],model:c,canAdd:!0,canDelete:!0,canEdit:!1,columns:["conname","consrc","convalidated"]},s.SecurityGroupSchema,{id:"seclabels",label:e("Security Labels"),model:s.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,i={};this.get("seclabels");return(o.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(o.isUndefined(this.get("basetype"))||""==String(this.get("basetype")).replace(/^\s+|\s+$/g,""))&&(i.basetype=e("Base Type cannot be empty."),t=t||i.basetype),this.errorModel.clear().set(i),null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e;a;){if(o.indexOf(["schema"],l._type)>-1)return!0;if("coll-domain"==l._type){var r=n.hasParent(a)?n.parent(a):null;return"catalog"!=(r?n.itemData(r):null)._type}a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!0},isDisabled:function(e){if(!e.isNew()){if(this.node_info.server.version<90200)return!1}return!0}})),s.Nodes.domain}.apply(t,o))&&(e.exports=l)}).call(t,i(11),i(10))},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-domain_constraints"]){o.Browser.Nodes["coll-domain_constraints"]=o.Browser.Collection.extend({node:"domain_constraints",label:e("Domain Constraints"),type:"coll-domain_constraints",columns:["name","description"]})}return l.Nodes.domain_constraints||(o.Browser.Nodes.domain_constraints=l.Node.extend({type:"domain_constraints",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-alterdomain.html",dialogHelp:t("help.static",{filename:"domain_constraint_dialog.html"}),label:e("Domain Constraints"),collection_type:"coll-domain_constraints",hasSQL:!0,hasDepends:!0,parent_type:["domain"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_domain_on_coll",node:"coll-domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:l.Nodes.schema.canChildDrop,model:o.Browser.Node.Model.extend({defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:e("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],min_version:90500},{id:"consrc",label:e("Check"),type:"multiline",cel:"string",group:e("Definition"),mode:["properties","create","edit"],disabled:function(e){return!e.isNew()}},{id:"connoinherit",label:e("No inherit"),type:"switch",cell:"boolean",group:e("Definition"),mode:["properties","create","edit"],disabled:"isDisabled",visible:!1},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",group:e("Definition"),min_version:90200,disabled:function(e){if(!e.isNew()){return this.node_info.server.version<90200||!!e.get("convalidated")}return!1},mode:["properties","create","edit"]}],validate:function(){var t,i={};return(n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(n.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(i.consrc=e("Check cannot be empty."),t=t||i.consrc),this.errorModel.clear().set(i),n.size(i)?(this.trigger("on-status",{msg:t}),t):null},isDisabled:function(e){if(!e.isNew()){if(this.node_info.server.version<90200)return!0}return!1}})})),l.Nodes.domain}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(l=function(e,t,i,o,l,r,s,d){if(!s.Nodes["coll-foreign_table"]){s.Nodes["coll-foreign_table"]=s.Collection.extend({node:"foreign_table",label:e("Foreign Tables"),type:"coll-foreign_table",columns:["name","owner","description"]})}var c=(n.IntegerCell.extend({initialize:function(){n.NumberCell.prototype.initialize.apply(this,arguments),n.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(o.isFunction(i)?!i.apply(t,[e]):!i)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this.delegateEvents(),this},remove:n.Extension.DependentCell.prototype.remove}),s.Node.Model.extend({idAttribute:"option",defaults:{option:void 0,value:void 0},schema:[{id:"option",label:e("Option"),type:"text",editable:!0,cellHeaderClasses:"width_percent_30"},{id:"value",label:e("Value"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){if(o.isUndefined(this.get("value"))||o.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var e="Please enter a value.";return this.errorModel.set("value",e),e}return this.errorModel.unset("value"),null}})),p=s.Node.Model.extend({idAttribute:"attnum",defaults:{attname:void 0,datatype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,attnotnull:void 0,collname:void 0,attnum:void 0,inheritedfrom:void 0,inheritedid:void 0,attstattarget:void 0,coloptions:[]},type_options:void 0,schema:[{id:"attname",label:e("Name"),cell:"string",type:"text",editable:"is_editable_column",cellHeaderClasses:"width_percent_40"},{id:"datatype",label:e("Data Type"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_types",editable:"is_editable_column",cellHeaderClasses:"width_percent_0",group:e("Definition"),transform:function(e,t){return t.model.type_options=e,e}},{id:"typlen",label:e("Length"),cell:"string",group:e("Definition"),type:"int",deps:["datatype"],disabled:function(e){var t=e.get("typlen");if(!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom"))))return o.isUndefined(t)||setTimeout(function(){e.set("typlen",void 0)},10),!0;var i=e.get("datatype"),n=!1;return e.type_options?(e.set("is_tlength",!1,{silent:!0}),o.each(e.type_options,function(t){i==t.value&&t.length&&(n=!0,e.set("is_tlength",!0,{silent:!0}),e.set("min_val",t.min_val,{silent:!0}),e.set("max_val",t.max_val,{silent:!0}))}),n||o.isUndefined(t)||setTimeout(function(){e.set("typlen",void 0)},10),!e.get("is_tlength")):(n||o.isUndefined(t)||setTimeout(function(){e.set("typlen",void 0)},10),!0)},cellHeaderClasses:"width_percent_10"},{id:"precision",label:e("Precision"),type:"int",deps:["datatype"],cell:"string",group:e("Definition"),disabled:function(e){var t=e.get("precision");if(!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom"))))return o.isUndefined(t)||setTimeout(function(){e.set("precision",void 0)},10),!0;var i=e.get("datatype"),n=!1;return e.type_options?(e.set("is_precision",!1,{silent:!0}),o.each(e.type_options,function(t){i==t.value&&t.precision&&(n=!0,e.set("is_precision",!0,{silent:!0}),e.set("min_val",t.min_val,{silent:!0}),e.set("max_val",t.max_val,{silent:!0}))}),n||o.isUndefined(t)||setTimeout(function(){e.set("precision",void 0)},10),!e.get("is_precision")):(n||o.isUndefined(t)||setTimeout(function(){e.set("precision",void 0)},10),!0)},cellHeaderClasses:"width_percent_10"},{id:"typdefault",label:e("Default"),type:"text",cell:"string",min_version:90300,group:e("Definition"),placeholder:"Enter an expression or a value.",cellHeaderClasses:"width_percent_10",editable:function(e){return!!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom")))&&!(this.get("node_info").server.version<90300)}},{id:"attnotnull",label:e("Not Null"),cell:"boolean",type:"switch",editable:"is_editable_column",cellHeaderClasses:"width_percent_10",group:e("Definition")},{id:"attstattarget",label:e("Statistics"),min_version:90200,cell:"integer",type:"int",group:e("Definition"),editable:function(e){return!o.isUndefined(e.isNew)&&!e.isNew()&&(!(this.get("node_info").server.version<90200)&&!!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom"))))},cellHeaderClasses:"width_percent_10"},{id:"collname",label:e("Collation"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_collations",min_version:90300,editable:function(e){return!(!o.isUndefined(e.isNew)&&!e.isNew())&&!!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom")))},cellHeaderClasses:"width_percent_20",group:e("Definition")},{id:"attnum",cell:"string",type:"text",visible:!1},{id:"inheritedfrom",label:e("Inherited From"),cell:"string",type:"text",visible:!1,mode:["properties","edit"],cellHeaderClasses:"width_percent_10"},{id:"coloptions",label:e("Options"),cell:"string",type:"collection",group:e("Options"),mode:["edit","create"],model:c,canAdd:!0,canDelete:!0,canEdit:!1,control:Backform.UniqueColCollectionControl,uniqueCol:["option"],min_version:90200}],validate:function(){var t=null;return o.isUndefined(this.get("attname"))||""==String(this.get("attname")).replace(/^\s+|\s+$/g,"")?(t=e("Column Name cannot be empty."),this.errorModel.set("attname",t)):this.errorModel.unset("attname"),o.isUndefined(this.get("datatype"))||""==String(this.get("datatype")).replace(/^\s+|\s+$/g,"")?(t=e("Column Datatype cannot be empty."),this.errorModel.set("datatype",t)):this.errorModel.unset("datatype"),t},is_editable_column:function(e){return!!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom")))},toJSON:a.Model.prototype.toJSON}),u=Backform.NodeAjaxOptionsControl.extend({onChange:function(e){var t=this.model,n=(i(e.target),this.field.get("name").split(".")),l=n.shift(),r=n.join("."),s=this.getValueFromDOM(),d={},c=t.get("columns"),p=t.get(l);if(this.model.errorModel instanceof a.Model)if(o.isEmpty(r))this.model.errorModel.unset(l);else{var u=this.model.errorModel.get(l);u&&(this.keyPathSetter(u,r,null),this.model.errorModel.set(l,u))}var m=this;if("string"==typeof p&&(p=JSON.parse(p)),o.size(s)<o.size(p)){var g=o.difference(p,s),h=c.where({inheritedid:parseInt(g[0])});c.remove(h)}else o.each(s,function(e){var t=c.where({inheritedid:parseInt(e)});if(t&&t.length<=0){var i=m.fetchColumns(e);c.add(i)}});d[l]=o.isEmpty(r)?s:o.clone(t.get(l))||{},this.stopListening(this.model,"change:"+l,this.render),t.set(d),this.listenTo(this.model,"change:"+l,this.render)},fetchColumns:function(e){var t=this,n="get_columns",a=t.model.top||t.model,o=this.field.get("schema_node"),l=this.field.get("node_info"),r=o.generate_url.apply(o,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||!1,l]),d=this.field.get("cache_level")||o.type,c=this.field.get("cache_node");c=c&&s.Nodes.cache_node||o,a.trigger("pgadmin:view:fetching",a,t.field);var p={attrelid:e};return i.ajax({async:!1,url:r,data:p,success:function(e){p=c.cache(n,l,d,e.data)},error:function(){a.trigger("pgadmin:view:fetch:error",a,t.field)}}),a.trigger("pgadmin:view:fetched",a,t.field),p=p&&p.data||[]}}),m=s.Node.Model.extend({idAttribute:"conoid",initialize:function(e,t){0===o.size(e)||(this.convalidated_default=this.get("convalidated")),s.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0,conislocal:void 0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:e("Name"),type:"text",cell:"string",editable:"is_editable",cellHeaderClasses:"width_percent_30"},{id:"consrc",label:e("Check"),type:"multiline",editable:"is_editable",cell:n.Extension.TextareaCell,cellHeaderClasses:"width_percent_30"},{id:"connoinherit",label:e("No Inherit"),type:"switch",cell:"boolean",editable:"is_editable",cellHeaderClasses:"width_percent_20"},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",cellHeaderClasses:"width_percent_20",editable:function(e){this.get("node_info").server;return!!o.isUndefined(e.isNew)||(!!e.isNew()||(!e.get("convalidated")||!e.convalidated_default))}}],validate:function(){var t,i={};return(o.isUndefined(this.get("conname"))||""==String(this.get("conname")).replace(/^\s+|\s+$/g,""))&&(i.conname=e("Constraint Name cannot be empty."),t=t||i.conname),(o.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(i.consrc=e("Constraint Check cannot be empty."),t=t||i.consrc),this.errorModel.clear().set(i),t},is_editable:function(e){return!!o.isUndefined(e.isNew)||e.isNew()},toJSON:a.Model.prototype.toJSON}),g=s.Node.Model.extend({defaults:{option:void 0,value:void 0},schema:[{id:"option",label:e("Option"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"value",label:e("Value"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){},toJSON:a.Model.prototype.toJSON});return s.Nodes.foreign_table||(s.Nodes.foreign_table=s.Node.extend({type:"foreign_table",sqlAlterHelp:"sql-alterforeigntable.html",sqlCreateHelp:"sql-createforeigntable.html",dialogHelp:t("help.static",{filename:"foreign_table_dialog.html"}),label:e("Foreign Table"),collection_type:"coll-foreign_table",hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert","update","delete"],parent_type:["schema"],Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_foreign_table_on_coll",node:"coll-foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:s.Nodes.schema.canChildDrop,canDropCascade:s.Nodes.schema.canChildDrop,model:s.Node.Model.extend({initialize:function(e,t){if(0===o.size(e)){var i=t.node_info.schema._label,n=s.serverInfo[t.node_info.server._id].user;this.set({basensp:i,owner:n.name},{silent:!0})}s.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,ftsrvname:void 0,strftoptions:void 0,inherits:[],columns:[],constraints:[],ftoptions:[],relacl:[],stracl:[],seclabels:[]},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:Backform.NodeListByNameControl,node:"role",type:"text",select2:{allowClear:!1}},{id:"basensp",label:e("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"ftsrvname",label:e("Foreign server"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_foreign_servers",disabled:function(e){return!e.isNew()}},{id:"inherits",label:e("Inherits"),group:e("Definition"),type:"array",min_version:90500,control:u,url:"get_tables",select2:{multiple:!0},cache_level:"database",transform:function(e,t){if("edit"==this.field.get("mode")){var i=this.model.get("oid"),n=o.findWhere(e,{id:i});n&&(e=o.reject(e,n))}return e}},{id:"columns",label:e("Columns"),cell:"string",type:"collection",group:e("Columns"),mode:["edit","create"],model:p,canAdd:!0,canDelete:!0,canEdit:!0,columns:["attname","datatype","inheritedfrom"],canDeleteRow:function(e){return!!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom")))},canEditRow:function(e){return!!(o.isUndefined(e.get("inheritedid"))||o.isNull(e.get("inheritedid"))||o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom")))}},{id:"constraints",label:e("Constraints"),cell:"string",type:"collection",group:e("Constraints"),mode:["edit","create"],model:m,canAdd:!0,canDelete:!0,columns:["conname","consrc","connoinherit","convalidated"],canEdit:function(e){return!(e instanceof a.Model&&e instanceof m)||e.isNew()},min_version:90500,canDeleteRow:function(e){return!(1!=e.get("conislocal")&&!o.isUndefined(e.get("conislocal")))}},{id:"strftoptions",label:e("Options"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"ftoptions",label:e("Options"),cell:"string",type:"collection",group:e("Options"),mode:["edit","create"],model:g,canAdd:!0,canDelete:!0,canEdit:!1,control:"unique-col-collection",uniqueCol:["option"]},{id:"relacl",label:e("Privileges"),cell:"string",type:"text",group:e("Security"),mode:["properties"],min_version:90200},s.SecurityGroupSchema,{id:"acl",label:e("Privileges"),model:r.Browser.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",min_version:90200},{id:"seclabels",label:e("Security Labels"),model:s.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,i={};this.get("seclabels");return(o.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(o.isUndefined(this.get("basensp"))||""==String(this.get("basensp")).replace(/^\s+|\s+$/g,""))&&(i.basensp=e("Schema cannot be empty."),t=t||i.basensp),(o.isUndefined(this.get("ftsrvname"))||""==String(this.get("ftsrvname")).replace(/^\s+|\s+$/g,""))&&(i.ftsrvname=e("Foreign server cannot be empty."),t=t||i.ftsrvname),this.errorModel.clear().set(i),null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e;a;){if(o.indexOf(["schema"],l._type)>-1)return!0;if("coll-foreign_table"==l._type){var r=n.hasParent(a)?n.parent(a):null;return"catalog"!=(r?n.itemData(r):null)._type}a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!0}})),s.Nodes.foreign_table}.apply(t,o))&&(e.exports=l)}).call(t,i(11),i(10))},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(l=function(e,t,i,o,l,r,s,d){var c=r.Browser.Node.Model.extend({defaults:{token:void 0,dictname:void 0},keys:["token"],schema:[{id:"token",label:e("Token"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!1,cell:"string",url:"tokens"},{id:"dictname",label:e("Dictionaries"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0,cell:n.Extension.MultiSelectAjaxCell,url:"dictionaries"}],validate:function(){var t;this.errorModel.clear();var i=this.get("token"),n=this.get("dictname");return o.isNull(i)||o.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Token cannot be empty."),this.errorModel.set("token",t),t):o.isNull(n)||o.isUndefined(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(t=e("Dictionary name cannot be empty."),this.errorModel.set("dictname",t),t):null}}),p=Backform.TokenControl=Backform.UniqueColCollectionControl.extend({initialize:function(t){Backform.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var n,l=n=this,s=[{id:"token",label:"",type:"text",url:"tokens",node:"fts_configuration",canAdd:!0,url_with_id:!0,control:Backform.NodeAjaxOptionsControl.extend({formatter:Backform.NodeAjaxOptionsControl.prototype.formatter,initialize:function(){Backform.NodeAjaxOptionsControl.prototype.initialize.apply(this,arguments);var e=this,t=e.field.get("url")||e.defaults.url,a=e.model.top||e.model;n.model.get("oid");if(t){var l=this.field.get("schema_node"),s=this.field.get("node_info"),d=l.generate_url.apply(l,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||l.type,p=this.field.get("cache_node");p=p&&r.Browser.Nodes[p]||l;var u=p.cache(t,s,c);this.field.get("version_compatible")&&(o.isUndefined(u)||o.isNull(u))&&(a.trigger("pgadmin:view:fetching",a,e.field),i.ajax({async:!1,url:d,success:function(e){u=p.cache(t,s,c,e.data)},error:function(){a.trigger("pgadmin:view:fetch:error",a,e.field)}}),a.trigger("pgadmin:view:fetched",a,e.field)),u=u&&u.data||[];var m=this.field.get("transform")||e.defaults.transform;m&&o.isFunction(m)?e.field.set("options",m.bind(e,u)):e.field.set("options",u)}}}),select2:{allowClear:!0,width:"style",placeholder:e("Select token")},first_empty:!0,disabled:function(e){return o.isUndefined(l.model.get("oid"))}}],d={token:null},c=["token","dictname"];l.headerData=new(a.Model.extend({defaults:d,schema:s}))({});var p=Backform.generateViewSchema(l.field.get("node_info"),l.headerData,"create",l.field.get("schema_node"),l.field.get("node_data")),u=[];o.each(p,function(e){u=u.concat(e.fields)}),l.headerFields=new Backform.Fields(u),l.gridSchema=Backform.generateGridColumnsFromModel(l.field.get("node_info"),l.field.get("model"),"edit",c,l.field.get("schema_node")),l.controls=[],l.listenTo(l.headerData,"change",l.headerDataChanged),l.listenTo(l.headerData,"select2",l.headerDataChanged),l.listenTo(l.collection,"add",l.onAddorRemoveTokens),l.listenTo(l.collection,"remove",l.onAddorRemoveTokens)},generateHeader:function(t){var n=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-xs-3">','    <label class="control-label"><%-token_label%></label>',"   </div>",'   <div class="col-xs-6" header="token"></div>','   <div class="col-xs-2">','     <button class="btn-sm btn-default add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>"," </div>","</div>"].join("\n");o.extend(t,{token_label:e("Tokens")});var a=this,l=o.template(n),r=i(l(t)),s=this.controls;return a.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:a.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el),t.$el.find(".control-label").remove(),s.push(t)}),"properties"==t.mode&&r.find("button.add").remove(),"create"==t.mode&&r.find("button.add").attr("disabled",!0),a.$header=r,r},events:o.extend({},Backform.UniqueColCollectionControl.prototype.events,{"click button.add":"addTokens"}),showGridControl:function(e){var t=this,a=o.template("<div class='subnode-header'></div>"),l=i("<div></div>",{class:"pgadmin-control-group backgrid form-group col-xs-12 object subnode"}).append(a({label:e.label}));l.append(t.generateHeader(e));var r=o.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&r.unshift({name:"pg-backform-delete",label:"",cell:n.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var s=t.grid=new n.Grid({columns:r,collection:t.collection,className:"backgrid table-bordered"});return t.$grid=s.render().$el,l.append(t.$grid),setTimeout(function(){t.headerData.set({token:t.$header.find('div[header="token"] select').val()},{silent:!0})},10),l},headerDataChanged:function(){var e=this,t=this.headerData.toJSON(),i=o.isEmpty(t)||o.isUndefined(t);e.$header&&e.$header.find("button.add").prop("disabled",i)},addTokens:function(e){e.preventDefault();var t=this,n=t.headerData.get("token");if(!n||""==n)return!1;var a=t.model.get(t.field.get("name")),l=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.model.top,collection:a,handler:a}),r=["token"],s=-1;t.collection.each(function(e){o.each(r,function(t){e.get(t)==n&&(s=a.indexOf(e))})}),-1==s&&(a.add(l),s=a.indexOf(l)),t.$grid.find(".new").removeClass("new");var d=t.grid.body.rows[s].$el;return d.addClass("new"),i(d).pgMakeVisible("backform-tab"),!1},onAddorRemoveTokens:function(){var e=this;setTimeout(function(){e.collection.trigger("pgadmin:tokens:updated",e.collection),e.headerDataChanged()},10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveTokens),o.each(this.controls,function(e){e.remove()}),p.__super__.remove.apply(this,arguments),delete this.headerData}});if(!s.Nodes["coll-fts_configuration"]){r.Browser.Nodes["coll-fts_configuration"]=r.Browser.Collection.extend({node:"fts_configuration",label:e("FTS Configurations"),type:"coll-fts_configuration",columns:["name","description"]})}return s.Nodes.fts_configuration||(r.Browser.Nodes.fts_configuration=r.Browser.Node.extend({parent_type:["schema","catalog"],type:"fts_configuration",sqlAlterHelp:"sql-altertsconfig.html",sqlCreateHelp:"sql-createtsconfig.html",dialogHelp:t("help.static",{filename:"fts_configuration_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("FTS Configuration"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_fts_configuration_on_schema",node:"schema",module:this,category:"create",priority:4,applies:["object","context"],callback:"show_obj_properties",label:e("FTS Configuration..."),icon:"wcTabIcon icon-fts_configuration",data:{action:"create"},enable:"canCreate"},{name:"create_fts_configuration_on_coll",module:this,priority:4,node:"coll-fts_configuration",applies:["object","context"],callback:"show_obj_properties",category:"create",label:e("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"},{name:"create_fts_configuration",node:"fts_configuration",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"}]))},model:r.Browser.Node.Model.extend({defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,prsname:void 0,copy_config:void 0,tokens:void 0},initialize:function(e,t){var i=0===o.size(e);if(r.Browser.Node.Model.prototype.initialize.apply(this,arguments),i){var n=s.serverInfo[t.node_info.server._id].user;this.set({owner:n.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:Backform.NodeListByNameControl,select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsname",label:e("Parser"),type:"text",url:"parsers",first_empty:!0,group:e("Definition"),control:"node-ajax-options",deps:["copy_config"],disabled:function(e){var t=e.get("copy_config");return!e.isNew()||!o.isNull(t)&&!o.isUndefined(t)&&""!==t}},{id:"copy_config",label:e("Copy Config"),type:"text",mode:["create"],group:e("Definition"),control:"node-ajax-options",url:"copyConfig",deps:["prsname"],disabled:function(e){var t=e.get("prsname");return!e.isNew()||!o.isNull(t)&&!o.isUndefined(t)&&""!==t}},{id:"tokens",label:e("Tokens"),type:"collection",group:e("Tokens"),control:p,model:c,columns:["token","dictionary"],uniqueCol:["token"],mode:["create","edit"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(t){var i,n=this.get("name"),a=this.get("prsname"),l=""===a||o.isUndefined(a)||o.isNull(a)?this.get("copy_config"):this.get("prsname"),r=this.get("schema");return this.errorModel.clear(),this.trigger("on-status-clear"),o.isUndefined(n)||o.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(i=e("Name must be specified."),this.errorModel.set("name",i),i):o.isUndefined(l)||o.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(i=e("Select parser or configuration to copy."),this.errorModel.set("parser",i),i):o.isUndefined(r)||o.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(i=e("Schema must be selected."),this.errorModel.set("schema",i),i):null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e;a;){if(o.indexOf(["schema"],l._type)>-1)return!0;if("coll-fts_configuration"==l._type){var r=n.hasParent(a)?n.parent(a):null;return"catalog"!=(r?n.itemData(r):null)._type}a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!0}})),s.Nodes["coll-fts_configuration"]}.apply(t,o))&&(e.exports=l)}).call(t,i(11),i(10))},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){var s=o.Browser.Node.Model.extend({defaults:{options:void 0,value:void 0},schema:[{id:"option",label:e("Option"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0},{id:"value",label:e("Value"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0}],validate:function(){if(this.errorModel.clear(),n.isUndefined(this.get("option"))||""==String(this.get("option")).replace(/^\s+|\s+$/g,"")){var t=e("Option cannot be empty.");return this.errorModel.set("option",t),t}if(n.isUndefined(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var t=e("Value cannot be empty.");return this.errorModel.set("value",t),t}return null}});if(!l.Nodes["coll-fts_dictionary"]){o.Browser.Nodes["coll-fts_dictionary"]=o.Browser.Collection.extend({node:"fts_dictionary",label:e("FTS Dictionaries"),type:"coll-fts_dictionary",columns:["name","description"]})}return l.Nodes.fts_dictionary||(o.Browser.Nodes.fts_dictionary=o.Browser.Node.extend({parent_type:["schema","catalog"],type:"fts_dictionary",sqlAlterHelp:"sql-altertsdictionary.html",sqlCreateHelp:"sql-createtsdictionary.html",dialogHelp:t("help.static",{filename:"fts_dictionary_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("FTS Dictionary"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_dictionary_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"},{name:"create_fts_dictionary_on_coll",node:"coll-fts_dictionary",module:this,applies:["object","context"],priority:4,callback:"show_obj_properties",category:"create",label:e("FTS Dictionary..."),data:{action:"create"},icon:"wcTabIcon icon-fts_dictionary",enable:"canCreate"},{name:"create_fts_dictionary",node:"fts_dictionary",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,template:void 0,options:void 0},initialize:function(e,t){var i=0===n.size(e);if(o.Browser.Node.Model.prototype.initialize.apply(this,arguments),i){var a=l.serverInfo[t.node_info.server._id].user;this.set({owner:a.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:Backform.NodeListByNameControl},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",cache_node:"database",control:"node-list-by-id"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"template",label:e("Template"),type:"text",disabled:function(e){return!e.isNew()},url:"fetch_templates",group:e("Definition"),control:"node-ajax-options",cache_node:"fts_template"},{id:"options",label:e("Option"),type:"collection",group:e("Options"),control:"unique-col-collection",model:s,columns:["option","value"],uniqueCol:["option"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(t){var i=this.get("name"),a=this.get("template"),o=this.get("schema");if(n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var l=e("Name must be specified.");return this.errorModel.set("name",l),l}if(n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var l=e("Template must be selected.");return this.errorModel.set("template",l),l}if(n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")){var l=e("Schema must be selected.");return this.errorModel.set("schema",l),l}return this.errorModel.clear(),this.trigger("on-status-clear"),null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-fts_dictionary"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes.fts_dictionary}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-fts_parser"]){o.Browser.Nodes["coll-fts_parser"]=o.Browser.Collection.extend({node:"fts_parser",label:e("FTS Parsers"),type:"coll-fts_parser",columns:["name","description"]})}return l.Nodes.fts_parser||(o.Browser.Nodes.fts_parser=o.Browser.Node.extend({parent_type:["schema","catalog"],type:"fts_parser",sqlAlterHelp:"sql-altertsparser.html",sqlCreateHelp:"sql-createtsparser.html",dialogHelp:t("help.static",{filename:"fts_parser_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("FTS Parser"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_parser_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"},{name:"create_fts_parser_on_coll",node:"coll-fts_parser",applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},module:this,enable:"canCreate"},{name:"create_fts_parser",node:"fts_parser",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({defaults:{name:void 0,description:void 0,schema:void 0,prsstart:void 0,prstoken:void 0,prsend:void 0,prslextype:void 0,prsheadline:void 0},initialize:function(e,t){var i=0===n.size(e);o.Browser.Node.Model.prototype.initialize.apply(this,arguments),i&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsstart",label:e("Start function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"start_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prstoken",label:e("Get next token function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"token_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsend",label:e("End function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"end_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prslextype",label:e("Lextypes function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"lextype_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsheadline",label:e("Headline function"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"headline_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"}],validate:function(t){var i=this.get("name"),a=this.get("prsstart"),o=this.get("prstoken"),l=this.get("prsend"),r=this.get("prslextype"),s=this.get("schema");if(n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var d=e("Name must be specified.");return this.errorModel.set("name",d),d}if(n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var d=e("Start function must be selected.");return this.errorModel.set("prsstart",d),d}if(n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")){var d=e("Get next token function must be selected.");return this.errorModel.set("prstoken",d),d}if(n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")){var d=e("End function must be selected.");return this.errorModel.set("prsend",d),d}if(n.isUndefined(r)||n.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")){var d=e("Lextype function must be selected.");return this.errorModel.set("prslextype",d),d}if(n.isUndefined(s)||n.isNull(s)||""==String(s).replace(/^\s+|\s+$/g,"")){var d=e("Schema must be selected.");return this.errorModel.set("schema",d),d}return this.errorModel.clear(),this.trigger("on-status-clear"),null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-fts_parser"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes["coll-fts_parser"]}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-fts_template"]){o.Browser.Nodes["coll-fts_template"]=o.Browser.Collection.extend({node:"fts_template",label:e("FTS Templates"),type:"coll-fts_template",columns:["name","description"]})}return l.Nodes.fts_template||(o.Browser.Nodes.fts_template=o.Browser.Node.extend({parent_type:["schema","catalog"],type:"fts_template",sqlAlterHelp:"sql-altertstemplate.html",sqlCreateHelp:"sql-createtstemplate.html",dialogHelp:t("help.static",{filename:"fts_template_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("FTS Template"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_template_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template_on_coll",node:"coll-fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template",node:"fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({defaults:{name:void 0,description:void 0,schema:void 0,tmplinit:void 0,tmpllexize:void 0},initialize:function(e,t){var i=0===n.size(e);o.Browser.Node.Model.prototype.initialize.apply(this,arguments),i&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",disabled:!0,mode:["properties"]},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"tmplinit",label:e("Init function"),group:e("Definition"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_init",cache_level:"database",cache_node:"schema"},{id:"tmpllexize",label:e("Lexize function"),group:e("Definition"),type:"text",disabled:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_lexize",cache_level:"database",cache_node:"schema"}],validate:function(t){var i=this.get("name"),a=this.get("tmpllexize"),o=this.get("schema");if(n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")){var l=e("Name must be specified.");return this.errorModel.set("name",l),l}if(n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")){var l=e("Lexize function must be selected.");return this.errorModel.set("tmpllexize",l),l}if(n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")){var l=e("Schema must be selected.");return this.errorModel.set("schema",l),l}return this.errorModel.clear(),this.trigger("on-status-clear"),null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-fts_template"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes.fts_template}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(191),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r,s){if(!l.Nodes["coll-procedure"]){o.Browser.Nodes["coll-procedure"]=o.Browser.Collection.extend({node:"procedure",label:e("Procedures"),type:"coll-procedure",columns:["name","funcowner","description"],hasStatistics:!0})}var d=l.Nodes.schema;return l.Nodes.procedure||(o.Browser.Nodes.procedure=l.Node.extend({type:"procedure",sqlAlterHelp:"sql-alterprocedure.html",sqlCreateHelp:"sql-createprocedure.html",dialogHelp:t("help.static",{filename:"procedure_dialog.html"}),label:e("Procedure"),collection_type:"coll-procedure",hasSQL:!0,hasDepends:!0,hasStatistics:!0,hasScriptTypes:["create","exec"],parent_type:["schema","catalog"],Init:function(){this.proc_initialized||(this.proc_initialized=!0,l.add_menus([{name:"create_procedure_on_coll",node:"coll-procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!1},enable:"canCreateProc"},{name:"create_procedure",node:"procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"},{name:"create_procedure",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"}]))},canDrop:d.canChildDrop,canDropCascade:!1,canCreateProc:function(e,t,i){var n=this.getTreeNodeHierarchy.apply(this,[t]);return!("catalog"in n)&&("server"in n&&"ppas"==n.server.server_type)},model:s.model.extend({defaults:n.extend({},s.model.prototype.defaults,{lanname:"edbspl"}),canVarAdd:function(e){return!(this.node_info.server.version<90500)},isVisible:function(e){return"sysfunc"!=this.name&&"sysproc"==this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(name=this.name,name){case"provolatility":case"proisstrict":case"prosecdef":case"procost":case"proleakproof":case"variables":var t=this.node_info.server;return t.version<90500;case"prorows":var t=this.node_info.server;return!(t.version>=90500&&1==e.get("proretset"));case"funcowner":case"lanname":case"proargs":return!0;default:return!1}return!1},validate:function(){var t,i={},a=this.get("seclabels");if((n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(n.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(i.pronamespace=e("Schema cannot be empty."),t=t||i.pronamespace),(n.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(i.lanname=e("Language cannot be empty."),t=t||i.lanname),(n.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(i.prosrc=e("Code cannot be empty."),t=t||i.prosrc),a)for(var o,l=0;l<a.models.length&&!o;l++)(o=a.models[l].validate.apply(a.models[l]))&&(i.seclabels=o,t=t||o);return this.errorModel.clear().set(i),null}})})),l.Nodes.procedure}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(192),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r,s){return l.Nodes["coll-edbproc"]||(o.Browser.Nodes["coll-edbproc"]=o.Browser.Collection.extend({node:"edbproc",label:e("Procedures"),type:"coll-edbproc",columns:["name","funcowner","description"],hasStatistics:!0})),l.Nodes.edbproc||(o.Browser.Nodes.edbproc=l.Node.extend({type:"edbproc",dialogHelp:t("help.static",{filename:"edbproc_dialog.html"}),label:e("Procedure"),collection_type:"coll-edbproc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.proc_initialized||(this.proc_initialized=!0)},canDrop:!1,canDropCascade:!1,model:s.model.extend({defaults:n.extend({},s.model.prototype.defaults,{lanname:"edbspl"}),isVisible:function(e){return"sysfunc"!=this.name&&"sysproc"==this.name},validate:function(){return null}})})),l.Nodes.edbproc}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r){return l.Nodes["coll-edbvar"]||(l.Nodes["coll-edbvar"]=l.Collection.extend({node:"edbvar",label:e("Variables"),type:"coll-edbvar",columns:["name","funcowner","description"]})),l.Nodes.edbvar||(l.Nodes.edbvar=l.Node.extend({type:"edbvar",dialogHelp:t("help.static",{filename:"edbvar_dialog.html"}),label:e("Function"),collection_type:"coll-edbvar",canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(e){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:l.Node.Model.extend({defaults:{name:void 0,oid:void 0,datatype:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"datatype",label:e("Data type"),cell:"string",type:"text",disabled:!0},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:!0}],validate:function(){return null}})})),l.Nodes.edbvar}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-trigger_function"]){l.Nodes["coll-trigger_function"]=l.Collection.extend({node:"trigger_function",label:e("Trigger functions"),type:"coll-trigger_function",columns:["name","funcowner","description"],hasStatistics:!0})}return l.Nodes.trigger_function||(l.Nodes.trigger_function=l.Node.extend({type:"trigger_function",sqlAlterHelp:"plpgsql-trigger.html",sqlCreateHelp:"plpgsql-trigger.html",dialogHelp:t("help.static",{filename:"trigger_function_dialog.html"}),label:e("Trigger function"),collection_type:"coll-trigger_function",hasSQL:!0,hasDepends:!0,hasStatistics:!0,parent_type:["schema","catalog"],Init:function(t){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_trigger_function_on_coll",node:"coll-trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:l.Nodes.schema.canChildDrop,canDropCascade:l.Nodes.schema.canChildDrop,model:l.Node.Model.extend({initialize:function(e,t){if(0===n.size(e)){var i=t.node_info.schema._id;this.set({pronamespace:i},{silent:!0});var a=l.serverInfo[t.node_info.server._id].user;this.set({funcowner:a.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:"trigger",lanname:"plpgsql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,args:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",control:Backform.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:e("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:e("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:e("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:e("Return type"),cell:"string",control:"select2",type:"text",group:e("Definition"),disabled:"isDisabled",first_empty:!0,select2:{width:"100%",allowClear:!1},mode:["create"],visible:"isVisible",options:[{label:e("trigger"),value:"trigger"},{label:e("event_trigger"),value:"event_trigger"}]},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:e("Language"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_languages",disabled:"isDisabled",transform:function(e,t){return n.reject(e,function(e){return"sql"==e.label||"edbspl"==e.label})},select2:{allowClear:!1}},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["lanname"],control:Backform.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:e("Object file"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:e("Link symbol"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:e("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:e("Returns a set?"),type:"switch",group:e("Options"),disabled:"isDisabled",visible:"isVisible"},{id:"proisstrict",label:e("Strict?"),type:"switch",disabled:"isDisabled",group:e("Options"),options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},{id:"prosecdef",label:e("Security of definer?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:e("Window?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"procost",label:e("Estimated cost"),type:"text",group:e("Options"),disabled:"isDisabled"},{id:"prorows",label:e("Estimated rows"),type:"text",group:e("Options"),disabled:"isDisabled",deps:["proretset"],visible:"isVisible"},{id:"proleakproof",label:e("Leak proof?"),group:e("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled"},l.SecurityGroupSchema,{id:"proacl",label:e("Privileges"),mode:["properties"],group:e("Security"),type:"text"},{id:"variables",label:e("Parameters"),type:"collection",group:e("Parameters"),control:"variable-collection",model:l.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},{id:"acl",label:e("Privileges"),editable:!1,type:"collection",group:"security",mode:["edit","create"],model:l.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],disabled:"isDisabled",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:e("Security Labels"),canEdit:!0,model:l.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",canAdd:!0,uniqueCol:["provider"],disabled:"isDisabled"}],validate:function(t){var i,a={},o=this.get("seclabels");if(t&&0==t.length)return this.errorModel.clear(),null;if((n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(a.name=e("Name cannot be empty."),i=i||a.name),(n.isUndefined(this.get("funcowner"))||""==String(this.get("funcowner")).replace(/^\s+|\s+$/g,""))&&(a.funcowner=e("Owner cannot be empty."),i=i||a.funcowner),(n.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(a.pronamespace=e("Schema cannot be empty."),i=i||a.pronamespace),(n.isUndefined(this.get("prorettypename"))||""==String(this.get("prorettypename")).replace(/^\s+|\s+$/g,""))&&(a.prorettypename=e("Return type cannot be empty."),i=i||a.prorettypename),(n.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(a.lanname=e("Language cannot be empty."),i=i||a.lanname),"c"==String(this.get("lanname"))?((n.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(a.probin=e("Object File cannot be empty."),i=i||a.probin),(n.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(a.prosrc_c=e("Link Symbol cannot be empty."),i=i||a.prosrc_c)):(n.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(a.prosrc=e("Code cannot be empty."),i=i||a.prosrc),o)for(var l,r=0;r<o.models.length&&!l;r++)(l=o.models[r].validate.apply(o.models[r]))&&(a.seclabels=l,i=i||l);return this.errorModel.clear().set(a),n.size(a)?(this.trigger("on-status",{msg:i}),i):null},isVisible:function(e){return"sysproc"!=this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(name=this.name,name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();case"prorows":return 1!=e.get("proretset");default:return!1}return!1},canVarAdd:function(e){return!(this.node_info&&"catalog"in this.node_info)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-trigger_function"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes.trigger_function}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-package"]){l.Nodes["coll-package"]=l.Collection.extend({node:"package",label:e("Packages"),type:"coll-package",columns:["name","owner","description"]})}return l.Nodes.package||(l.Nodes.package=l.Node.extend({type:"package",dialogHelp:t("help.static",{filename:"package_dialog.html"}),label:e("Package"),collection_type:"coll-package",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_package_on_coll",node:"coll-package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"}]))},canDrop:l.Nodes.schema.canChildDrop,canDropCascade:l.Nodes.schema.canChildDrop,canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),a=n.server;return(!a||"pg"!==a.server_type)&&void 0==n.catalog},model:l.Node.Model.extend({defaults:{name:void 0,oid:void 0,owner:void 0,is_sys_object:void 0,description:void 0,pkgheadsrc:void 0,pkgbodysrc:void 0,acl:void 0,pkgacl:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,a=t.node_info.schema;this.set({owner:i.name,schema:a._label},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function(e){return!e.isNew()}},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:!0,editable:!1,visible:function(e){return!e.isNew()}},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",disabled:function(e){return!e.isNew()},filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"is_sys_object",label:e("System package?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"pkgheadsrc",label:e("Header"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Code"),control:Backform.SqlFieldControl},{id:"pkgbodysrc",label:e("Body"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Code"),control:Backform.SqlFieldControl},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"pkgacl",label:e("Privileges"),type:"collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],editable:!1,group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):n.isUndefined(this.get("pkgheadsrc"))||""==String(this.get("pkgheadsrc")).replace(/^\s+|\s+$/g,"")?(t=e("Header cannot be empty."),this.errorModel.set("pkgheadsrc",t),t):null}})})),l.Nodes.package}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-sequence"]){l.Nodes["coll-sequence"]=l.Collection.extend({node:"sequence",label:e("Sequences"),type:"coll-sequence",columns:["name","seqowner","comment"],hasStatistics:!0})}return l.Nodes.sequence||(l.Nodes.sequence=l.Node.extend({type:"sequence",sqlAlterHelp:"sql-altersequence.html",sqlCreateHelp:"sql-createsequence.html",dialogHelp:t("help.static",{filename:"sequence_dialog.html"}),label:e("Sequence"),collection_type:"coll-sequence",hasSQL:!0,hasDepends:!0,hasStatistics:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_sequence_on_coll",node:"coll-sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:l.Nodes.schema.canChildDrop,canDropCascade:l.Nodes.schema.canChildDrop,canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-sequence"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0},model:l.Node.Model.extend({defaults:{name:void 0,oid:void 0,seqowner:void 0,schema:void 0,comment:void 0,increment:void 0,start:void 0,current_value:void 0,minimum:void 0,maximum:void 0,cache:void 0,cycled:void 0,relacl:[],securities:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,a=t.node_info.schema;this.set({seqowner:i.name},{silent:!0}),this.set({schema:a._label},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"seqowner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],node:"role",control:Backform.NodeListByNameControl},{id:"schema",label:e("Schema"),cell:"string",control:"node-list-by-name",node:"schema",type:"text",mode:["create","edit"],filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"comment",label:e("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"current_value",label:e("Current value"),type:"int",mode:["properties","edit"],group:e("Definition")},{id:"increment",label:e("Increment"),type:"int",mode:["properties","create","edit"],group:e("Definition"),min:1},{id:"start",label:e("Start"),type:"int",mode:["properties","create"],group:e("Definition"),disabled:function(e){return!e.isNew()}},{id:"minimum",label:e("Minimum"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"maximum",label:e("Maximum"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"cache",label:e("Cache"),type:"int",mode:["properties","create","edit"],group:e("Definition"),min:1},{id:"cycled",label:e("Cycled"),type:"switch",mode:["properties","create","edit"],group:e("Definition"),options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"}},l.SecurityGroupSchema,{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:!0},{id:"relacl",label:e("Privileges"),group:"security",model:l.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),uniqueCol:["grantee","grantor"],mode:["edit","create"],editable:!1,type:"collection",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"securities",label:e("Security Labels"),canAdd:!0,model:l.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",min_version:90200,uniqueCol:["provider"]}],validate:function(){var t=void 0,i=this.get("minimum"),a=this.get("maximum"),o=this.get("start");if(n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(this.errorModel.unset("name"),n.isUndefined(this.get("seqowner"))||""==String(this.get("seqowner")).replace(/^\s+|\s+$/g,""))return t=e("Owner cannot be empty."),this.errorModel.set("seqowner",t),t;if(this.errorModel.unset("seqowner"),n.isUndefined(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return t=e("Schema cannot be empty."),this.errorModel.set("schema",t),t;if(this.errorModel.unset("schema"),!this.isNew()){if(n.isUndefined(this.get("current_value"))||""==String(this.get("current_value")).replace(/^\s+|\s+$/g,""))return t=e("Current value cannot be empty."),this.errorModel.set("current_value",t),t;if(this.errorModel.unset("current_value"),n.isUndefined(this.get("increment"))||""==String(this.get("increment")).replace(/^\s+|\s+$/g,""))return t=e("Increment value cannot be empty."),this.errorModel.set("increment",t),t;if(this.errorModel.unset("increment"),n.isUndefined(this.get("minimum"))||""==String(this.get("minimum")).replace(/^\s+|\s+$/g,""))return t=e("Minimum value cannot be empty."),this.errorModel.set("minimum",t),t;if(this.errorModel.unset("minimum"),n.isUndefined(this.get("maximum"))||""==String(this.get("maximum")).replace(/^\s+|\s+$/g,""))return t=e("Maximum value cannot be empty."),this.errorModel.set("maximum",t),t;if(this.errorModel.unset("maximum"),n.isUndefined(this.get("cache"))||""==String(this.get("cache")).replace(/^\s+|\s+$/g,""))return t=e("Cache value cannot be empty."),this.errorModel.set("cache",t),t;this.errorModel.unset("cache")}var l=e("Minimum value must be less than maximum value."),r=e("Start value cannot be less than minimum value."),s=e("Start value cannot be greater than maximum value.");return 0==i&&0==a||parseInt(i,10)>=parseInt(a,10)?(this.errorModel.set("minimum",l),l):(this.errorModel.unset("minimum"),o&&i&&parseInt(o)<parseInt(i)?(this.errorModel.set("start",r),r):(this.errorModel.unset("start"),o&&a&&parseInt(o)>parseInt(a)?(this.errorModel.set("start",s),s):(this.errorModel.unset("start"),null)))}})})),l.Nodes.sequence}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-synonym"]){o.Browser.Nodes["coll-synonym"]=o.Browser.Collection.extend({node:"synonym",label:e("Synonyms"),type:"coll-synonym",columns:["name","owner","is_public_synonym"]})}return l.Nodes.synonym||(o.Browser.Nodes.synonym=l.Node.extend({type:"synonym",dialogHelp:t("help.static",{filename:"synonym_dialog.html"}),label:e("Synonym"),collection_type:"coll-synonym",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_synonym_on_coll",node:"coll-synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"}]))},canDrop:l.Nodes.schema.canChildDrop,model:o.Browser.Node.Model.extend({isNew:function(){return!this.fetchFromServer},idAttribute:"name",initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,a=t.node_info.schema;this.set({owner:i.name,synobjschema:a._label,schema:a._label,targettype:"r"},{silent:!0})}else this.fetchFromServer=!0;o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:!0,control:"node-list-by-name",node:"role",visible:!1},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function(e){return!e.isNew()},node:"schema",control:"node-list-by-name",cache_node:"database",cache_level:"database"},{id:"targettype",label:e("Target type"),cell:"string",disabled:"inSchema",group:e("Definition"),select2:{width:"50%",allowClear:!1},options:function(t){return[{label:e("Function"),value:"f"},{label:e("Package"),value:"P"},{label:e("Procedure"),value:"p"},{label:e("Public Synonym"),value:"s"},{label:e("Sequence"),value:"S"},{label:e("Table"),value:"r"},{label:e("View"),value:"v"}]},control:"select2"},{id:"synobjschema",label:e("Target schema"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["targettype"],select2:{allowClear:!1},control:"node-list-by-name",node:"schema",filter:function(e){var t=["pg_catalog","sys","dbo","pgagent","information_schema","dbms_job_procedure"];return e&&-1==n.indexOf(t,e.label)},disabled:function(e){if(!e.inSchema.apply(this,[e])){return!!("s"==e.get("targettype"))&&(e.set("synobjschema","public",{silent:!0}),!0)}return!0}},{id:"synobjname",label:e("Target object"),cell:"string",type:"text",disabled:"inSchema",group:e("Definition"),deps:["targettype","synobjschema"],control:"node-ajax-options",options:function(e){var t=e.model.get("targettype"),n=e.model.get("synobjschema"),a=[],o=e.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_target_objects",e.field.get("node_data"),!1,e.field.get("node_info")]);return i.ajax({type:"GET",timeout:3e4,url:l,cache:!1,async:!1,data:{trgTyp:t,trgSchema:n},success:function(e){return a=e.data},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&r.error(a.errormsg)}catch(e){}}}),a}},{id:"is_public_synonym",label:e("Public synonym?"),disabled:!0,type:"switch",mode:["properties"],cell:"switch",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"mini"}}],validate:function(){var t=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t)):n.isUndefined(this.get("synobjschema"))||""==String(this.get("synobjschema")).replace(/^\s+|\s+$/g,"")?(t=e("Target schema cannot be empty."),this.errorModel.set("synobjschema",t)):(n.isUndefined(this.get("synobjname"))||""==String(this.get("synobjname")).replace(/^\s+|\s+$/g,""))&&(t=e("Target object cannot be empty."),this.errorModel.set("synobjname",t)),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),a=n.server;return(!a||"pg"!==a.server_type)&&void 0==n.catalog}})),l.Nodes.synonym}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(11),i(26),i(9)],void 0!==(o=function(e,t,i,a,o,l,r,s,d){if(!r.Nodes["coll-type"]){r.Nodes["coll-type"]=r.Collection.extend({node:"type",label:e("Types"),type:"coll-type",columns:["name","typeowner","description"]})}var c=d.IntegerCell.extend({initialize:function(){d.NumberCell.prototype.initialize.apply(this,arguments),d.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(a.isFunction(i)?!i.apply(t,[e]):!i)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this.delegateEvents(),this},remove:d.Extension.DependentCell.prototype.remove}),p=d.Extension.NodeAjaxOptionsCell.extend({initialize:function(){d.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),d.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),n=this.$el.find("select").first();return(a.isFunction(i)?!i.apply(t,[e]):!i)?(this.$el.removeClass("editable"),n.prop("disabled",!0)):(this.$el.addClass("editable"),n.prop("disabled",!1)),this.delegateEvents(),this},remove:d.Extension.DependentCell.prototype.remove}),u=Backform.CompositeModel=r.Node.Model.extend({idAttribute:"attnum",defaults:{attnum:void 0,member_name:void 0,type:void 0,tlength:void 0,is_tlength:!1,precision:void 0,is_precision:!1,collation:void 0,min_val:void 0,max_val:void 0},type_options:void 0,subtypes:void 0,schema:[{id:"member_name",label:e("Member Name"),type:"text",disabled:!1,editable:!0},{id:"type",label:e("Type"),control:"node-ajax-options",type:"text",url:"get_types",disabled:!1,node:"type",cache_node:"domain",editable:!0,cell:"node-ajax-options",select2:{allowClear:!1},transform:function(e,t){return t.model.type_options=e,e}},{id:"tlength",label:e("Length/precision"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(e){var t=e.get("type");return e.type_options&&a.each(e.type_options,function(i){t==i.value&&(i.length?(e.set("is_tlength",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0})):e.set("is_tlength",!1,{silent:!0}))}),e.get("is_tlength")}},{id:"precision",label:e("Scale"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(e){var t=e.get("type");return e.type_options&&a.each(e.type_options,function(i){t==i.value&&(i.precision?(e.set("is_precision",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0})):e.set("is_precision",!1,{silent:!0}))}),e.get("is_precision")}},{id:"collation",label:e("Collation"),cell:p,deps:["type"],select2:{allowClear:!1},control:"node-ajax-options",editable:function(e){var t=e.get("type"),i=!1;return e.type_options&&a.each(e.type_options,function(e){t==e.value&&e.is_collatable&&(i=!0)}),i&&setTimeout(function(){e.set("collspcname","",{silent:!0})},10),i},type:"text",disabled:!1,url:"get_collations",node:"type"}],validate:function(){var t=null;this.sessAttrs;if(this.errorModel.clear(),a.isUndefined(this.get("member_name"))||a.isNull(this.get("member_name"))||""==String(this.get("member_name")).replace(/^\s+|\s+$/g,""))return t=e("Please specify the value for member name."),this.errorModel.set("member_name",t),t;if(a.isUndefined(this.get("type"))||a.isNull(this.get("type"))||""==String(this.get("type")).replace(/^\s+|\s+$/g,""))return t=e("Please specify the type."),this.errorModel.set("type",t),t;if(this.get("is_tlength")&&!a.isUndefined(this.get("tlength"))){if(this.get("tlength")<this.get("min_val")&&(t=e("Length/precision should not be less than %(value)s",{value:this.get("min_val")})),this.get("tlength")>this.get("max_val")&&(t=e("Length/precision should not be greater than %(value)s",{value:this.get("max_val")})),t)return this.errorModel.set("tlength",t),t}else if(this.get("is_precision")&&!a.isUndefined(this.get("precision"))&&(this.get("precision")<this.get("min_val")&&(t=e("Scale should not be less than %(value)s",{value:this.get("min_val")})),this.get("precision")>this.get("max_val")&&(t=e("Scale should not be greater than %(value)s",{value:this.get("max_val")})),t))return this.errorModel.set("precision",t),t;return null}}),m=Backform.EnumModel=r.Node.Model.extend({defaults:{label:void 0},schema:[{id:"label",label:e("Label"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_99",editable:function(e){return a.isUndefined(e.get("label"))}}],validate:function(){return null}});if(!r.Nodes.type){var g;r.Nodes.type=r.Node.extend({type:"type",sqlAlterHelp:"sql-altertype.html",sqlCreateHelp:"sql-createtype.html",dialogHelp:t("help.static",{filename:"type_dialog.html"}),label:e("Type"),collection_type:"coll-type",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_type_on_coll",node:"coll-type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:r.Nodes.schema.canChildDrop,canDropCascade:r.Nodes.schema.canChildDrop,ext_funcs:void 0,model:r.Node.Model.extend({defaults:{name:void 0,oid:void 0,is_sys_type:!1,typtype:void 0},initialize:function(e,t){if(0===a.size(e)){var i=r.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({typeowner:i.name,schema:n._label},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"schemaCheck"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],disabled:!0},{id:"typeowner",label:e("Owner"),cell:"string",control:"node-list-by-name",type:"text",mode:["properties","create","edit"],node:"role",disabled:"inSchema",select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"schemaCheck",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database",control:"node-list-by-name",select2:{allowClear:!1}},(g={id:"typtype",label:e("Type"),mode:["create","edit"],disabled:"inSchemaWithModelCheck",group:e("Definition"),select2:{width:"50%",allowClear:!1},options:function(e){return[{label:"Composite",value:"c"},{label:"Enumeration",value:"e"},{label:"External",value:"b"},{label:"Range",value:"r"},{label:"Shell",value:"p"}]}},n(g,"disabled","inSchemaWithModelCheck"),n(g,"control",Backform.Select2Control.extend({render:function(){return Backform.Select2Control.prototype.render.apply(this,arguments),this.model.isNew()&&this.model.set({typtype:"c"}),this}})),g),{id:"composite",label:e("Composite Type"),model:u,editable:!0,type:"collection",group:e("Definition"),mode:["edit","create"],control:"unique-col-collection",uniqueCol:["member_name"],canAdd:!0,canEdit:!1,canDelete:!0,disabled:"inSchema",deps:["typtype"],visible:function(e){return"c"===e.get("typtype")}},{id:"enum",label:e("Enumeration Type"),model:m,editable:!0,type:"collection",group:e("Definition"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:function(e){return!!e.isNew()},disabled:"inSchema",deps:["typtype"],control:"unique-col-collection",uniqueCol:["label"],visible:function(e){return"e"===e.get("typtype")}},{type:"nested",control:"plain-fieldset",group:e("Definition"),mode:["edit","create"],visible:function(e){return"r"===e.get("typtype")},deps:["typtype"],label:"",schema:[{id:"typname",label:e("Subtype"),cell:"string",control:"node-ajax-options",select2:{allowClear:!0,placeholder:"",width:"100%"},url:"get_stypes",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",transform:function(e,t){return t.model.subtypes=e,e}},{id:"opcname",label:e("Subtype operator class"),cell:"string",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",deps:["typname"],control:"select",options:function(){var e=this.model.get("typname"),t=this,n=[];if(!a.isUndefined(e)&&""!=e){var o=this.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_subopclass",this.field.get("node_data"),!1,this.field.get("node_info")]);i.ajax({async:!1,url:l,cache:!1,data:{typname:e},success:function(e){n=e.data},error:function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)}})}return n}},{id:"collname",label:e("Collation"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),deps:["typname"],control:"node-ajax-options",url:"get_collations",select2:{allowClear:!0,placeholder:"",width:"100%"},disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("typname"),i=void 0;return a.isUndefined(t)||a.each(e.subtypes,function(e){t===e.label&&(i=e.is_collate)}),!i}},{id:"rngcanonical",label:e("Canonical function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",deps:["name","typname"],control:"select",options:function(){var e=this.model.get("name"),t=this,n=[];if(!a.isUndefined(e)&&""!=e){var o=this.field.get("schema_node"),l=o.generate_url.apply(o,[null,"get_canonical",this.field.get("node_data"),!1,this.field.get("node_info")]);i.ajax({async:!1,url:l,cache:!1,data:{name:e},success:function(e){n=e.data},error:function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)}})}return n}},{id:"rngsubdiff",label:e("Subtype diff function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchemaWithModelCheck",deps:["opcname"],control:"select",options:function(){var e=this.model.get("typname"),t=this.model.get("opcname"),n=this,o=[];if(!a.isUndefined(e)&&""!=e&&!a.isUndefined(t)&&""!=t){var l=this.field.get("schema_node"),r=l.generate_url.apply(l,[null,"get_stypediff",this.field.get("node_data"),!1,this.field.get("node_info")]);i.ajax({async:!1,url:r,cache:!1,data:{typname:e,opcname:t},success:function(e){o=e.data},error:function(){n.model.trigger("pgadmin:view:fetch:error",n.model,n.field)}})}return o}}]},{type:"nested",control:"tab",group:e("Definition"),label:e("External Type"),deps:["typtype"],mode:["create","edit"],visible:function(e){return"b"===e.get("typtype")},schema:[{id:"typinput",label:e("Input function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typoutput",label:e("Output function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typreceive",label:e("Receive function"),cell:"string",type:"text",group:e("Optional-1"),mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typsend",label:e("Send function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typmodin",label:e("Typmod in function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Optional-1"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return a.each(e,function(e){"typmodin"!==e.cbtype&&"all"!==e.cbtype||t.push(e)}),t}},{id:"typmodout",label:e("Typmod out function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return a.each(e,function(e){"typmodout"!==e.cbtype&&"all"!==e.cbtype||t.push(e)}),t}},{id:"typlen",label:e("Internal length"),cell:"integer",group:e("Optional-1"),type:"int",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"variable",label:e("Variable?"),cell:"switch",group:e("Optional-1"),type:"switch",mode:["create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typdefault",label:e("Default?"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typanalyze",label:e("Analyze function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typcategory",label:e("Category type"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"Array types",value:"A"},{label:"Boolean types",value:"B"},{label:"Composite types",value:"C"},{label:"Date/time types",value:"D"},{label:"Enum types",value:"E"},{label:"Geometric types",value:"G"},{label:"Network address types",value:"I"},{label:"Numeric types",value:"N"},{label:"Pseudo-types",value:"P"},{label:"String types",value:"S"},{label:"Timespan types",value:"T"},{label:"User-defined types",value:"U"},{label:"Bit-string types",value:"V"},{label:"unknown type",value:"X"}]},{id:"typispreferred",label:e("Preferred?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Optional-1")},{id:"element",label:e("Element type"),cell:"string",control:"node-ajax-options",group:e("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_types"},{id:"typdelim",label:e("Delimiter"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Optional-2"),disabled:"inSchemaWithModelCheck"},{id:"typalign",label:e("Alignment type"),cell:"string",group:e("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"char",value:"c"},{label:"int2",value:"s"},{label:"int4",value:"i"},{label:"double",value:"d"}]},{id:"typstorage",label:e("Storage type"),type:"text",mode:["properties","create","edit"],group:e("Optional-2"),cell:"string",disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"PLAIN",value:"p"},{label:"EXTERNAL",value:"e"},{label:"MAIN",value:"m"},{label:"EXTENDED",value:"x"}]},{id:"typbyval",label:e("Passed by value?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Optional-2")},{id:"is_collatable",label:e("Collatable?"),cell:"switch",min_version:90100,group:e("Optional-2"),type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"}]},{id:"alias",label:e("Alias"),cell:"string",type:"text",mode:["properties"],disabled:"inSchema"},r.SecurityGroupSchema,{id:"type_acl",label:e("Privileges"),cell:"string",type:"text",mode:["properties"],group:"security",disabled:"inSchema"},{id:"member_list",label:e("Members"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),disabled:"inSchema",visible:function(e){return"c"===e.get("typtype")}},{id:"enum_list",label:e("Labels"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),disabled:"inSchema",visible:function(e){return"e"===e.get("typtype")}},{id:"is_sys_type",label:e("System type?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"typacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),mode:["edit","create"],canDelete:!0,uniqueCol:["grantee"],deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("typacl");t.length>0&&t.reset()}return!("p"===e.get("typtype"))}},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection",deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("seclabels");t.length>0&&t.reset()}return!("p"===e.get("typtype"))}}],validate:function(){var t=(this.sessAttrs,void 0);if(this.errorModel.clear(),a.isUndefined(this.get("name"))||a.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(a.isUndefined(this.get("schema"))||a.isNull(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return t=e("Schema cannot be empty."),this.errorModel.set("schema",t),t;if(a.isUndefined(this.get("typtype"))||a.isNull(this.get("typtype"))||""==String(this.get("typtype")).replace(/^\s+|\s+$/g,""))return t=e("Type cannot be empty."),this.errorModel.set("typtype",t),t;if("r"==this.get("typtype")&&(a.isUndefined(this.get("typname"))||a.isNull(this.get("typname"))||""==String(this.get("typname")).replace(/^\s+|\s+$/g,"")))return t=e("Subtype name cannot be empty."),this.errorModel.set("typname",t),t;if("b"==this.get("typtype")){if(a.isUndefined(this.get("typinput"))||a.isNull(this.get("typinput"))||""==String(this.get("typinput")).replace(/^\s+|\s+$/g,""))return t=e("Input function cannot be empty."),this.errorModel.set("typinput",t),t;if(a.isUndefined(this.get("typoutput"))||a.isNull(this.get("typoutput"))||""==String(this.get("typoutput")).replace(/^\s+|\s+$/g,""))return t=e("Output function cannot be empty."),this.errorModel.set("typoutput",t),t}return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},schemaCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&"p"===e.get("typtype")},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithEditMode:function(e){return!(this.node_info&&"schema"in this.node_info)||!!e.isNew()},external_func_combo:function(e){var t=[];return a.each(e,function(e){"all"==e.cbtype&&t.push(e)}),t}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=r.tree,o=t,l=e;o;){if(a.indexOf(["schema"],l._type)>-1)return!0;if("coll-type"==l._type){var s=n.hasParent(o)?n.parent(o):null;return"catalog"!=(s?n.itemData(s):null)._type}o=n.hasParent(o)?n.parent(o):null,l=o?n.itemData(o):null}return!0}})}return r.Nodes.type}.apply(t,a))&&(e.exports=o)},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(17),i(8),i(9)],void 0!==(l=function(e,t,i,o,l,r,s,d,c){if(!s.Nodes["coll-index"]){r.Browser.Nodes["coll-index"]=r.Browser.Collection.extend({node:"index",label:e("Indexes"),type:"coll-index",getTreeNodeHierarchy:s.tableChildTreeNodeHierarchy,sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",dialogHelp:t("help.static",{filename:"index_dialog.html"}),columns:["name","description"],hasStatistics:!0,statsPrettifyFields:["Size","Index size"]})}var p=n.Extension.NodeAjaxOptionsCell.extend({initialize:function(){n.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),n.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),n=this.$el.find("select").first();return(o.isFunction(i)?!i.apply(t,[e]):!i)?(this.$el.removeClass("editable"),n.prop("disabled",!0)):(this.$el.addClass("editable"),n.prop("disabled",!1)),this.delegateEvents(),this},remove:n.Extension.DependentCell.prototype.remove}),u=r.Browser.Node.Model.extend({defaults:{colname:void 0,collspcname:void 0,op_class:void 0,sort_order:!1,nulls:!1,is_sort_nulls_applicable:!0},schema:[{id:"colname",label:e("Column"),cell:"node-list-by-name",type:"text",disabled:"inSchemaWithModelCheck",editable:function(e){return!(e instanceof a.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-list-by-name",node:"column"},{id:"collspcname",label:e("Collation"),cell:p,type:"text",disabled:"inSchemaWithModelCheck",editable:function(e){return!(e instanceof a.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-ajax-options",url:"get_collations",node:"index"},{id:"op_class",label:e("Operator class"),cell:p,tags:!0,type:"text",disabled:"checkAccessMethod",editable:function(e){return!(e instanceof a.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&!e.checkAccessMethod.apply(this,arguments))},control:"node-ajax-options",url:"get_op_class",node:"index",deps:["amname"],transform:function(e,t){var i=t.model.top.get("amname"),n=e.btree;return o.isUndefined(i)?n:(o.each(e,function(e,t){i===t&&(n=e)}),n)}},{id:"sort_order",label:e("Sort order"),cell:n.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof a.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname"],options:{onText:"DESC",offText:"ASC",onColor:"success",offColor:"primary",size:"small"}},{id:"nulls",label:e("NULLs"),cell:n.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof a.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname","sort_order"],options:{onText:"FIRST",offText:"LAST",onColor:"success",offColor:"primary",size:"small"}}],validate:function(){if(this.errorModel.clear(),o.isUndefined(this.get("colname"))||""==String(this.get("colname")).replace(/^\s+|\s+$/g,"")){var t=e("Column Name cannot be empty.");return this.errorModel.set("colname",t),t}},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(e.top.node_info&&"schema"in e.top.node_info)||!e.top.isNew()},checkAccessMethod:function(e){var t=e.top;return o.isUndefined(t.get("amname"))||o.isNull(t.get("amname"))||""==String(t.get("amname")).replace(/^\s+|\s+$/g,"")||"btree"===t.get("amname")?1==e.get("sort_order")&&0==e.previous("sort_order")&&setTimeout(function(){e.set("nulls",!0)},10):e.set("is_sort_nulls_applicable",!1),!1}});return s.Nodes.index||(r.Browser.Nodes.index=s.Node.extend({getTreeNodeHierarchy:s.tableChildTreeNodeHierarchy,parent_type:["table","view","mview","partition"],collection_type:["coll-table","coll-view"],sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",type:"index",label:e("Index"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Size","Index size"],Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_index_on_coll",node:"coll-index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index",node:"index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onMatView",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"}]))},canDrop:s.Nodes.schema.canChildDrop,canDropCascade:s.Nodes.schema.canChildDrop,model:r.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,nspname:void 0,tabname:void 0,spcname:void 0,amname:"btree"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",disabled:!0,mode:["edit","properties"]},{id:"spcname",label:e("Tablespace"),cell:"string",control:"node-list-by-name",node:"tablespace",select2:{allowClear:!0},type:"text",mode:["properties","create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/pg_global/)}},{id:"amname",label:e("Access Method"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_access_methods",group:e("Definition"),select2:{allowClear:!0},control:d.NodeAjaxOptionsControl.extend({onChange:function(){d.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("amname"),n=t.model.previous("amname");if(i!=n&&0!==t.model.get("columns").length){var a=e("Changing access method will clear columns collection");c.confirm(a,function(e){for(var i=t.model.get("columns"),n=i.length,a=n-1;a>=0;a--)i.remove(i.models[a])},function(){setTimeout(function(){t.model.set("amname",n)},10)})}}})},{id:"cols",label:e("Columns"),cell:"string",type:"text",disabled:"inSchema",mode:["properties"],group:e("Definition")},{id:"fillfactor",label:e("Fill factor"),cell:"string",type:"int",disabled:"inSchema",mode:["create","edit","properties"],min:10,max:100,group:e("Definition")},{id:"indisunique",label:e("Unique?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",group:e("Definition")},{id:"indisclustered",label:e("Clustered?"),cell:"string",type:"switch",disabled:"inSchema",group:e("Definition")},{id:"indisvalid",label:e("Valid?"),cell:"string",type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"indisprimary",label:e("Primary?"),cell:"string",type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"is_sys_idx",label:e("System index?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"isconcurrent",label:e("Concurrent build?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["create","edit"],group:e("Definition")},{id:"indconstraint",label:e("Constraint"),cell:"string",type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit"],control:"sql-field",visible:!0,group:e("Definition")},{id:"columns",label:e("Columns"),type:"collection",deps:["amname"],group:e("Definition"),model:u,mode:["edit","create"],canAdd:function(e){return!!e.isNew()},canEdit:!1,canDelete:function(e){return!!e.isNew()},control:"unique-col-collection",uniqueCol:["colname"],columns:["colname","op_class","sort_order","nulls","collspcname"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var i=(this.changed,void 0);if(t&&0==t.length)return this.errorModel.clear(),null;if(this.errorModel.clear(),o.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return i=e("Name cannot be empty."),this.errorModel.set("name",i),i;if(o.isUndefined(this.get("spcname"))||""==String(this.get("spcname")).replace(/^\s+|\s+$/g,""))return i=e("Tablespace cannot be empty."),this.errorModel.set("spcname",i),i;if(o.isUndefined(this.get("amname"))||""==String(this.get("amname")).replace(/^\s+|\s+$/g,""))return i=e("Access method cannot be empty."),this.errorModel.set("amname",i),i;var n=this.get("columns");if(n&&n.length>0){if(!o.every(n.pluck("colname")))return i=e("You must specify column name."),this.errorModel.set("columns",i),i}else if(n)return i=e("You must specify at least one column."),this.errorModel.set("columns",i),i;return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!o.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e,r=[],d=!1,c=!1;a;){if(!d&&o.indexOf(["table","partition"],l._type)>-1&&(d=!0,"is_partitioned"in l&&l.is_partitioned&&(c=!0)),o.indexOf(["schema"],l._type)>-1)return!c;r.push(l._type),a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!(o.indexOf(r,"catalog")>-1)&&!c}})),s.Nodes.index}.apply(t,o))&&(e.exports=l)}).call(t,i(11),i(10))},function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(17),i(15),i(9)],void 0!==(o=function(e,t,i,a,o,l,r,s,d){s.CustomSwitchControl=s.SwitchControl.extend({template:a.template(['<label class="<%=Backform.controlLabelClassName%> custom_switch_label_class"><%=label%></label>','<div class="<%=Backform.controlsClassName%> custom_switch_control_class">','  <div class="checkbox">',"    <label>",'      <input type="checkbox" class="<%=extraClasses.join(\' \')%>"','        name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%>','        <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    </label>","  </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>"].join("\n")),className:"pgadmin-control-group form-group col-xs-6"});if(!r.Nodes["coll-trigger"]){l.Browser.Nodes["coll-trigger"]=l.Browser.Collection.extend({node:"trigger",label:e("Triggers"),type:"coll-trigger",getTreeNodeHierarchy:r.tableChildTreeNodeHierarchy,columns:["name","description"]})}return r.Nodes.trigger||(l.Browser.Nodes.trigger=r.Node.extend({getTreeNodeHierarchy:r.tableChildTreeNodeHierarchy,parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"trigger",label:e("Trigger"),hasSQL:!0,hasDepends:!0,width:"650px",sqlAlterHelp:"sql-altertrigger.html",sqlCreateHelp:"sql-createtrigger.html",dialogHelp:t("help.static",{filename:"trigger_dialog.html"}),Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_trigger_on_coll",node:"coll-trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger",node:"trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"enable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"enable_trigger",category:"connect",priority:3,label:e("Enable trigger"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"disable_trigger",category:"drop",priority:3,label:e("Disable trigger"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"create_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"}]))},callbacks:{enable_trigger:function(e){var t=e||{},n=this,a=r.tree,o=t.item||a.selected(),l=o&&1==o.length?a.itemData(o):void 0;if(!l)return!1;var s=l;i.ajax({url:n.generate_url(o,"enable",l,!0),type:"PUT",data:{enable:!0},dataType:"json",success:function(e){1==e.success&&(d.success(e.info),a.removeIcon(o),s.icon="icon-trigger",a.addIcon(o,{icon:s.icon}),a.unload(o),a.setInode(!1),a.deselect(o),setTimeout(function(){a.select(o)},10))},error:function(e,t,n){try{var l=i.parseJSON(e.responseText);0==l.success&&d.error(l.errormsg)}catch(e){}a.unload(o)}})},disable_trigger:function(e){var t=e||{},n=this,a=r.tree,o=t.item||a.selected(),l=o&&1==o.length?a.itemData(o):void 0;if(!l)return!1;var s=l;i.ajax({url:n.generate_url(o,"enable",l,!0),type:"PUT",data:{enable:!1},dataType:"json",success:function(e){1==e.success&&(d.success(e.info),a.removeIcon(o),s.icon="icon-trigger-bad",a.addIcon(o,{icon:s.icon}),a.unload(o),a.setInode(!1),a.deselect(o),setTimeout(function(){a.select(o)},10))},error:function(e,t,n){try{var l=i.parseJSON(e.responseText);0==l.success&&d.error(l.errormsg)}catch(e){}a.unload(o)}})}},canDrop:r.Nodes.schema.canChildDrop,canDropCascade:r.Nodes.schema.canChildDrop,model:l.Browser.Node.Model.extend({defaults:{name:void 0,is_row_trigger:!0,fires:"BEFORE"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",disabled:!0,mode:["properties"]},{id:"is_enable_trigger",label:e("Trigger enabled?"),type:"switch",disabled:"inSchema",mode:["edit","properties"],group:e("Definition")},{id:"is_row_trigger",label:e("Row trigger?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){if(a.has(e,"node_info")&&a.has(e.node_info,"table")&&a.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned)return setTimeout(function(){e.set("is_row_trigger",!1)},10),!0;var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("is_row_trigger");return!(!a.isUndefined(i)&&"ppas"==e.node_info.server.server_type)}return!a.isUndefined(t)&&!0===t&&(setTimeout(function(){e.set("is_row_trigger",!0)},10),!0)}},n({id:"is_constraint_trigger",label:e("Constraint trigger?"),type:"switch",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],group:e("Definition")},"disabled",function(e){return a.has(e,"node_info")&&a.has(e.node_info,"table")&&a.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned||-1!=a.indexOf(Object.keys(e.node_info),"view")?(setTimeout(function(){e.set("is_constraint_trigger",!1)},10),!0):e.inSchemaWithModelCheck.apply(this,[e])}),{id:"tgdeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){var t=e.get("is_constraint_trigger");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!a.isUndefined(t)&&!0===t)&&(e.get("tgdeferrable")&&setTimeout(function(){e.set("tgdeferrable",!1)},10),!0)}},{id:"tginitdeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["tgdeferrable","is_constraint_trigger"],disabled:function(e){var t=e.get("tgdeferrable");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!a.isUndefined(t)&&t)&&(e.get("tginitdeferred")&&setTimeout(function(){e.set("tginitdeferred",!1)},10),!e.get("is_constraint_trigger"))}},{id:"tfunction",label:e("Trigger Function"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],group:e("Definition"),control:"node-ajax-options",url:"get_triggerfunctions",cache_node:"trigger_function"},{id:"tgargs",label:e("Arguments"),cell:"string",group:e("Definition"),type:"text",mode:["create","edit","properties"],deps:["tfunction"],disabled:function(e){var t=e.get("tfunction"),i=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||"ppas"===i&&!a.isUndefined(t)&&"Inline EDB-SPL"===t&&(e.set("tgargs",void 0),!0)}},{id:"fires",label:e("Fires"),deps:["is_constraint_trigger"],mode:["create","edit","properties"],group:e("Events"),options:function(e){var t=[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"}],i=[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"},{label:"INSTEAD OF",value:"INSTEAD OF"}];return-1!=a.indexOf(Object.keys(e.model.node_info),"table")?t:i},control:"select2",select2:{allowClear:!1,width:"100%"},disabled:function(e){var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("fires");return!(!a.isUndefined(i)&&"ppas"==e.node_info.server.server_type)}return!a.isUndefined(t)&&!0===t&&(setTimeout(function(){e.set("fires","AFTER")},10),!0)}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:e("Events"),group:e("Events"),schema:[{id:"evnt_insert",label:e("INSERT"),type:"switch",mode:["create","edit","properties"],group:e("Events"),control:s.CustomSwitchControl,disabled:function(e){var t=e.get("evnt_insert");return!(!a.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_update",label:e("UPDATE"),type:"switch",mode:["create","edit","properties"],group:e("Events"),control:s.CustomSwitchControl,disabled:function(e){var t=e.get("evnt_update");return!(!a.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_delete",label:e("DELETE"),type:"switch",mode:["create","edit","properties"],group:e("Events"),control:s.CustomSwitchControl,disabled:function(e){var t=e.get("evnt_delete");return!(!a.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_truncate",label:e("TRUNCATE"),type:"switch",group:e("Events"),control:s.CustomSwitchControl,disabled:function(e){var t=e.get("is_constraint_trigger"),i=e.get("is_row_trigger"),n=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||!("ppas"===n&&!a.isUndefined(t)&&!a.isUndefined(i)&&!1===t&&!1===i)}}]},{id:"whenclause",label:e("When"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],control:"sql-field",visible:!0,group:e("Events")},{id:"columns",label:e("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:!0},deps:["evnt_update"],node:"column",group:e("Events"),disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("evnt_update");return!(!a.isUndefined(t)&&t)}},{id:"tgoldtable",label:e("Old table"),type:"text",group:e("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"tgnewtable",label:e("New table"),type:"text",group:e("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"prosrc",label:e("Code"),group:e("Code"),type:"text",mode:["create","edit"],deps:["tfunction"],control:"sql-field",visible:!0,disabled:function(e){var t=e.get("tfunction");return!("ppas"===e.node_info.server.server_type&&!a.isUndefined(t)&&"Inline EDB-SPL"===t)}},{id:"is_sys_trigger",label:e("System trigger?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var i=void 0;return this.errorModel.clear(),t&&0==t.length?null:a.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Name cannot be empty."),this.errorModel.set("name",i),i):a.isUndefined(this.get("tfunction"))||""==String(this.get("tfunction")).replace(/^\s+|\s+$/g,"")?(i=e("Trigger function cannot be empty."),this.errorModel.set("tfunction",i),i):this.get("evnt_truncate")||this.get("evnt_delete")||this.get("evnt_update")||this.get("evnt_insert")?a.isUndefined(this.get("tfunction"))||"Inline EDB-SPL"!==this.get("tfunction")||!a.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")?null:(i=e("Trigger code cannot be empty."),this.errorModel.set("prosrc",i),i):(i=e("Specify at least one event."),this.errorModel.set("evnt_truncate"," "),this.errorModel.set("evnt_delete"," "),this.errorModel.set("evnt_update"," "),this.errorModel.set("evnt_insert",i),i)},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!a.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)},disableTransition:function(e){var t=!0,i=null,n=this.name,o=0;return-1==a.indexOf(Object.keys(e.node_info),"table")||e.node_info.server.version<1e5||("tgoldtable"==n?i="evnt_delete":"tgnewtable"==n&&(i="evnt_insert"),e.get("evnt_insert")&&o++,e.get("evnt_update")&&o++,e.get("evnt_delete")&&o++,e.get("is_constraint_trigger")||"AFTER"!=e.get("fires")||!e.get("evnt_update")&&!e.get(i)||1!=o||(t=!!(e.get("evnt_update")&&a.size(e.get("columns"))>=1&&""!=e.get("columns")[0])),t&&setTimeout(function(){e.get(n)&&e.set(n,null)},10),t)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=r.tree,o=t,l=e,s=[];o;){if(a.indexOf(["schema"],l._type)>-1)return!0;s.push(l._type),o=n.hasParent(o)?n.parent(o):null,l=o?n.itemData(o):null}return!(a.indexOf(s,"catalog")>-1)},canCreate_with_trigger_enable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return"icon-trigger-bad"===e.icon},canCreate_with_trigger_disable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return"icon-trigger"===e.icon}})),r.Nodes.trigger}.apply(t,a))&&(e.exports=o)},function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(a=function(e,t,i,n,a,o,l){if(!o.Nodes["coll-catalog_object_column"]){a.Browser.Nodes["coll-catalog_object_column"]=a.Browser.Collection.extend({node:"catalog_object_column",label:e("catalog_object_column"),type:"coll-catalog_object_column",columns:["attname","attnum","cltype","description"]})}return o.Nodes.catalog_object_column||(a.Browser.Nodes.catalog_object_column=a.Browser.Node.extend({parent_type:"catalog_object",type:"catalog_object_column",label:e("catalog_object_column"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:a.Browser.Node.Model.extend({defaults:{attname:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0},schema:[{id:"attname",label:e("Column"),cell:"string",type:"text",disabled:!0},{id:"attowner",label:e("Owner"),cell:"string",type:"text",disabled:!0},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:!0},{id:"cltype",label:e("Data type"),cell:"string",group:e("Definition"),type:"text",disabled:!0},{id:"collspcname",label:e("Collation"),cell:"string",group:e("Definition"),type:"text",disabled:!0},{id:"attacl",label:e("Privileges"),cell:"string",group:e("Security"),type:"text",disabled:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:!0}]})})),o.Nodes.catalog_object_column}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(13),i(21),i(193)],void 0!==(a=function(e,t,i,n,a,o,l,r){if(!l.Nodes["coll-view"]){l.Nodes["coll-view"]=l.Collection.extend({node:"view",label:e("Views"),type:"coll-view",columns:["name","owner"]})}return l.Nodes.view||(l.Nodes.view=l.Node.extend({parent_type:["schema","catalog"],type:"view",sqlAlterHelp:"sql-alterview.html",sqlCreateHelp:"sql-createview.html",dialogHelp:t("help.static",{filename:"view_dialog.html"}),label:e("View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert"],collection_type:"coll-view",canDrop:l.Nodes.schema.canChildDrop,canDropCascade:l.Nodes.schema.canChildDrop,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_view_on_coll",node:"coll-view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:17,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!1},enable:"canCreate"}]))},model:l.Node.Model.extend({initialize:function(e,t){if(0===n.size(e)){var i=t.node_info.schema._label||"public",a=l.serverInfo[t.node_info.server._id].user;this.set({schema:i,owner:a.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"notInSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:"node-list-by-name",node:"role",disabled:"notInSchema",select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",disabled:"notInSchema",mode:["create","edit"],select2:{allowClear:!1},cache_node:"database"},{id:"system_view",label:e("System view?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"acl",label:e("Privileges"),mode:["properties"],type:"text",group:e("Security")},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",disabled:"notInSchema"},{id:"security_barrier",label:e("Security barrier"),type:"switch",min_version:"90200",group:e("Definition"),disabled:"notInSchema"},{id:"check_option",label:e("Check options"),control:"select2",group:e("Definition"),type:"text",min_version:"90400",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"notInSchema",options:[{label:e("No"),value:"no"},{label:e("Local"),value:"local"},{label:e("Cascaded"),value:"cascaded"}]},{id:"definition",label:e("Definition"),cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),control:Backform.SqlFieldControl,disabled:"notInSchema"},l.SecurityGroupSchema,{id:"datacl",label:e("Privileges"),type:"collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"notInSchema"},{id:"seclabels",label:e("Security labels"),model:l.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,disabled:"notInSchema",control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,i={},a=this.get("name"),o=this.get("definition");return n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(i.name=e("Please specify name."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(i.definition=e("Please enter view definition."),t=t||i.definition,this.errorModel.set("definition",t),t):(this.errorModel.unset("definition"),null))},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e;o;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-view"==r._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!0}})),l.Nodes.view}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(15),i(6),i(13),i(21)],void 0!==(a=function(e,t,i,n,a,o,l,r,s){if(!r.Nodes["coll-mview"]){r.Nodes["coll-mview"]=r.Collection.extend({node:"mview",label:e("Materialized Views"),type:"coll-mview",columns:["name","owner"]})}return r.Nodes.mview||(r.Nodes.mview=r.Node.extend({parent_type:["schema","catalog"],type:"mview",sqlAlterHelp:"sql-altermaterializedview.html",sqlCreateHelp:"sql-creatematerializedview.html",dialogHelp:t("help.static",{filename:"materialized_view_dialog.html"}),label:e("Materialized View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select"],collection_type:"coll-mview",canDrop:r.Nodes.schema.canChildDrop,canDropCascade:r.Nodes.schema.canChildDrop,Init:function(){this.initialized||(this.initialized=!0,o.Browser.add_menu_category("refresh_mview",e("Refresh View"),18,"fa fa-recycle"),r.add_menus([{name:"create_mview_on_coll",node:"coll-mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:e("Materialized View...")},{name:"create_mview",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:e("Materialized View...")},{name:"create_mview",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:18,icon:"wcTabIcon icon-mview",data:{action:"create",check:!1},enable:"canCreate",label:e("Materialized View...")},{name:"refresh_mview_data",node:"mview",module:this,priority:1,callback:"refresh_mview",category:"refresh_mview",applies:["object","context"],label:e("With data"),data:{concurrent:!1,with_data:!0},icon:"fa fa-recycle"},{name:"refresh_mview_nodata",node:"mview",callback:"refresh_mview",priority:2,module:this,category:"refresh_mview",applies:["object","context"],label:e("With no data"),data:{concurrent:!1,with_data:!1},icon:"fa fa-refresh"},{name:"refresh_mview_concurrent",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!0},priority:3,applies:["object","context"],callback:"refresh_mview",label:e("With data (concurrently)"),icon:"fa fa-recycle"},{name:"refresh_mview_concurrent_nodata",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!1},priority:4,applies:["object","context"],callback:"refresh_mview",label:e("With no data (concurrently)"),icon:"fa fa-refresh"}]))},model:r.Node.Model.extend({initialize:function(e,t){if(0===n.size(e)){var i=(t.node_info.schema._label,r.serverInfo[t.node_info.server._id].user);this.set({schema:"public",owner:i.name},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{spcname:void 0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:!0,mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:"node-list-by-name",select2:{allowClear:!1},node:"role",disabled:"inSchema"},{id:"schema",label:e("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",mode:["create","edit"],cache_node:"database",disabled:"inSchema",select2:{allowClear:!1}},{id:"system_view",label:e("System view?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},r.SecurityGroupSchema,{id:"acl",label:e("Privileges"),mode:["properties"],type:"text",group:e("Security")},{id:"comment",label:e("Comment"),cell:"string",type:"multiline"},{id:"definition",label:"",cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),control:Backform.SqlFieldControl,extraClasses:["sql_field_width_full"]},{id:"with_data",label:e("With Data"),group:e("Storage"),mode:["edit","create"],type:"switch"},{id:"spcname",label:e("Tablespace"),cell:"string",type:"text",group:e("Storage"),first_empty:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"fillfactor",label:e("Fill Factor"),group:e("Storage"),mode:["edit","create"],type:"int"},{type:"nested",control:"tab",id:"materialization",label:e("Parameter"),mode:["edit","create"],group:e("Parameter"),schema:Backform.VacuumSettingsSchema},{id:"datacl",label:e("Privileges"),type:"collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",canAdd:!0,canDelete:!0,mode:["edit","create"],control:"unique-col-collection"},{id:"seclabels",label:e("Security Labels"),model:r.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(t){var i,a={},o=this.get("name"),l=this.get("definition");return-1!=n.indexOf(t,"autovacuum_enabled")||-1!=n.indexOf(t,"toast_autovacuum_enabled")?null:n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(a.name=e("Please specify name."),i=i||a.name,this.errorModel.set("name",i),i):(this.errorModel.unset("name"),n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(a.definition=e("Please enter view definition."),i=i||a.definition,this.errorModel.set("definition",i),i):(this.errorModel.unset("definition"),null))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}}),canCreate:function(e,t,i){if(i&&!1===i.check)return!0;for(var a=r.tree,o=t,l=e;o;){if(n.indexOf(["schema"],l._type)>-1)return!0;if("coll-mview"==l._type){var s=a.hasParent(o)?a.parent(o):null;return"catalog"!=(s?a.itemData(s):null)._type}o=a.hasParent(o)?a.parent(o):null,l=o?a.itemData(o):null}return!0},refresh_mview:function(t){var n=t||{},a=this,o=r.tree,s=n.item||o.selected(),d=s&&1==s.length?o.itemData(s):void 0;if(!d)return!1;i.ajax({url:a.generate_url(s,"refresh_data",d,!0),type:"PUT",data:{concurrent:t.concurrent,with_data:t.with_data},dataType:"json",success:function(t){1==t.success?l.success(e("View refreshed successfully")):l.alert(e("Error refreshing view"),t.data.result)},error:function(t){var n=i.parseJSON(t.responseText);l.alert(e("Error refreshing view"),n.errormsg)}})},is_version_supported:function(e,t,i){var n=o.Browser.tree,a=t||n.selected(),l=e||(a&&1==a.length?n.itemData(a):void 0),r=this||l&&o.Browser.Nodes[l._type];return r.getTreeNodeHierarchy.apply(r,[a]).server.version>=90400}})),r.Nodes.mview}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(9),i(313),i(314),i(194)],void 0!==(o=function(e,t,i,a,o,l,r,s){if(!r.Nodes["coll-table"]){r.Nodes["coll-table"]=r.Collection.extend({node:"table",label:e("Tables"),type:"coll-table",columns:["name","relowner","is_partitioned","description"],hasStatistics:!0,statsPrettifyFields:["Size","Indexes size","Table size","Toast table size","Tuple length","Dead tuple length","Free space"]})}return r.Nodes.table||(r.Nodes.table=r.Node.extend({getTreeNodeHierarchy:r.tableChildTreeNodeHierarchy,type:"table",label:e("Table"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Size","Indexes size","Table size","Toast table size","Tuple length","Dead tuple length","Free space"],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:t("help.static",{filename:"table_dialog.html"}),parent_type:["schema","catalog"],hasScriptTypes:["create","select","insert","update","delete"],height:"95%",width:"85%",Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_table_on_coll",node:"coll-table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table__on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!1},enable:"canCreate"},{name:"truncate_table",node:"table",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:e("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"table",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:e("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"table",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:e("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"count_table_rows",node:"table",module:this,applies:["object","context"],callback:"count_table_rows",category:"Count",priority:2,label:e("Count Rows"),enable:!0}]),r.Events.on("pgadmin:browser:node:table:updated",this.onTableUpdated,this),r.Events.on("pgadmin:browser:node:type:cache_cleared",this.handle_cache,this),r.Events.on("pgadmin:browser:node:domain:cache_cleared",this.handle_cache,this))},canDrop:r.Nodes.schema.canChildDrop,canDropCascade:r.Nodes.schema.canChildDrop,callbacks:{enable_triggers_on_table:function(e){var t={enable:!0};this.callbacks.set_triggers.apply(this,[e,t])},disable_triggers_on_table:function(e){var t={enable:!1};this.callbacks.set_triggers.apply(this,[e,t])},set_triggers:function(e,t){var n=e||{},a=this,o=r.tree,l=n.item||o.selected(),d=l&&1==l.length?o.itemData(l):void 0;if(!d)return!1;i.ajax({url:a.generate_url(l,"set_trigger",d,!0),type:"PUT",data:t,dataType:"json",success:function(e){1==e.success&&(s.success(e.info),o.unload(l),o.setInode(l),o.deselect(l),setTimeout(function(){o.select(l)},10))},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&s.error(a.errormsg)}catch(e){}o.unload(l)}})},truncate_table:function(e){var t={cascade:!1};this.callbacks.truncate.apply(this,[e,t])},truncate_table_cascade:function(e){var t={cascade:!0};this.callbacks.truncate.apply(this,[e,t])},truncate:function(t,n){var a=t||{},l=this,d=r.tree,c=a.item||d.selected(),p=c&&1==c.length?d.itemData(c):void 0;if(!p)return!1;s.confirm(e("Truncate Table"),o(e("Are you sure you want to truncate table %s?")).sprintf(p.label).value(),function(e){if(e){var t=p;i.ajax({url:l.generate_url(c,"truncate",p,!0),type:"PUT",data:n,dataType:"json",success:function(e){1==e.success&&(s.success(e.info),d.removeIcon(c),t.icon=t.is_partitioned?"icon-partition":"icon-table",d.addIcon(c,{icon:t.icon}),d.unload(c),d.setInode(c),d.deselect(c),setTimeout(function(){d.select(c)},10))},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&s.error(a.errormsg)}catch(e){}d.unload(c)}})}},function(){})},reset_table_stats:function(t){var n=t||{},a=this,l=r.tree,d=n.item||l.selected(),c=d&&1==d.length?l.itemData(d):void 0;if(!c)return!1;s.confirm(e("Reset statistics"),o(e('Are you sure you want to reset the statistics for table "%s"?')).sprintf(c._label).value(),function(e){if(e){var t=c;i.ajax({url:a.generate_url(d,"reset",c,!0),type:"DELETE",success:function(e){1==e.success&&(s.success(e.info),l.removeIcon(d),t.icon=t.is_partitioned?"icon-partition":"icon-table",l.addIcon(d,{icon:t.icon}),l.unload(d),l.setInode(d),l.deselect(d),setTimeout(function(){l.select(d)},10))},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&s.error(a.errormsg)}catch(e){}l.unload(d)}})}},function(){})},count_table_rows:function(e){var t=e||{},n=this,a=r.tree,o=t.item||a.selected(),l=o&&1==o.length?a.itemData(o):void 0;if(!l)return!1;i.ajax({url:n.generate_url(o,"count_rows",l,!0),type:"GET",success:function(e){s.success(e.info),l.rows_cnt=e.data.total_rows,a.unload(o),a.setInode(o),a.deselect(o),setTimeout(function(){a.select(o)},10)},error:function(e,t,n){try{var l=i.parseJSON(e.responseText);0==l.success&&s.error(l.errormsg)}catch(e){}a.unload(o)}})}},model:r.Node.Model.extend({defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1},initialize:function(e,t){if(0===a.size(e)){var i=r.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({relowner:i.name,schema:n._label},{silent:!0})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),type:"text",mode:["properties"]},{id:"relowner",label:e("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:e("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))}},{id:"partition",type:"group",label:e("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:e("Partitioned Table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()}},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"coll_inherits",label:e("Inherited from table(s)"),url:"get_inherits",type:"array",group:e("Columns"),disabled:"checkInheritance",deps:["typname","is_partitioned"],mode:["create","edit"],select2:{multiple:!0,allowClear:!0,placeholder:e("Select to inherit from...")},transform:function(e,t){return(t||this).model.inherited_tables_list=e,e},control:Backform.MultiSelectAjaxControl.extend({onChange:function(){Backform.MultiSelectAjaxControl.prototype.onChange.apply(this,arguments);var e=this,t=e.model.get("coll_inherits")||[],i=e.model.previous("coll_inherits")||[];if(!a.isUndefined(t)){var n=void 0,o=void 0;t.length>1&&t.length>i.length?(n=a.difference(t,i),o=this.get_table_oid(n[0]),this.add_columns(o)):1==t.length&&(o=this.get_table_oid(t[0]),this.add_columns(o)),t.length>0&&t.length<i.length?(n=a.difference(i,t),this.remove_columns(n[0])):1===i.length&&t.length<1&&(n=i[0],this.remove_columns(n))}},add_columns:function(e){var t=this,i=t.model.top||t.model,n=void 0,o=(a.clone(i.get("columns")),i.get("columns")),l={tid:e};n=t.model.fetch_columns_ajax.apply(t,[l]),o.set(n,{merge:!1,remove:!1})},remove_columns:function(e){var t=this.get_table_oid(e),i=this.model.get("columns");i.remove(i.where({inheritedid:t}))},get_table_oid:function(e){var t=void 0;return a.each(this.model.inherited_tables_list,function(i){i.label===e&&(t=i.tid)}),t}})},{id:"coll_inherits",label:e("Inherited from table(s)"),type:"text",group:e("Advanced"),mode:["properties"]},{id:"inherited_tables_cnt",label:e("Inherited tables count"),type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),model:r.Nodes.column.model,subnode:r.Nodes.column.model,mode:["create","edit"],disabled:function(e){return e.isNew()&&e.get("is_partitioned")&&setTimeout(function(){var t=e.get("columns");t.remove(t.filter(function(e){return!a.isUndefined(e.get("inheritedfrom"))}))},10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:Backform.UniqueColCollectionControl.extend({initialize:function(){Backform.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this;e.model.get(e.field.get("name")).on("change:is_primary_key",function(t){var i,n=e.model.get("primary_key"),o=t.get("name");if(t.get("is_primary_key")){if(n.length<1?(i=new n.model({},{top:e.model,collection:n,handler:n}),n.add(i)):i=n.first(),a.isUndefined(i.get("oid"))){var l=i.get("columns"),r=l.where({column:o});if(0==r.length){var s=new l.model({column:o},{silent:!0,top:e.model,collection:n,handler:n});l.add(s)}l.trigger("pgadmin:multicolumn:updated",l)}}else if(n.length>0){var i=n.first();if(!a.isUndefined(i.get("oid")))return;var l=i.get("columns"),d=l.where({column:o});d.length>0&&(l.remove(d),a.each(d,function(e){e.destroy()}),0==l.length&&n.remove(n.first())),l.trigger("pgadmin:multicolumn:updated",l)}})},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),Backform.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{type:"nested",control:"tab",group:e("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:e("Primary key"),model:r.Nodes.primary_key.model,subnode:r.Nodes.primary_key.model,editable:!1,type:"collection",group:e("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("primary_key");t.remove(t.filter(function(e){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&a.some(t.pluck("name"))}},{id:"foreign_key",label:e("Foreign key"),model:r.Nodes.foreign_key.model,subnode:r.Nodes.foreign_key.model,editable:!1,type:"collection",group:e("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("foreign_key");t.remove(t.filter(function(e){return!0}))},10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return a.some(t.pluck("name"))}},{id:"check_constraint",label:e("Check constraint"),model:r.Nodes.check_constraint.model,subnode:r.Nodes.check_constraint.model,editable:!1,type:"collection",group:e("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:e("Unique Constraint"),model:r.Nodes.unique_constraint.model,subnode:r.Nodes.unique_constraint.model,editable:!1,type:"collection",group:e("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("unique_constraint");t.remove(t.filter(function(e){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return a.some(t.pluck("name"))}},{id:"exclude_constraint",label:e("Exclude constraint"),model:r.Nodes.exclusion_constraint.model,subnode:r.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:e("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("exclude_constraint");t.remove(t.filter(function(e){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return a.some(t.pluck("name"))}}]},{id:"typname",label:e("Of type"),type:"text",mode:["properties","create","edit"],disabled:"checkOfType",url:"get_oftype",group:e("Advanced"),deps:["coll_inherits"],transform:function(e,t){return(t||this).model.of_types_tables=e,e},control:Backform.NodeAjaxOptionsControl.extend({onChange:function(){Backform.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("typname"),n=void 0,o=void 0,l=t.model.get("columns");if(a.isUndefined(i)||a.isNull(i)||""===i||0===l.length)a.isUndefined(i)||""!==i||l.remove(l.filter(function(e){return!0}));else{var r=e("Remove column definitions?"),d=e("Changing 'Of type' will remove column definitions.");s.confirm(r,d,function(e){l.remove(l.filter(function(e){return!0}))},function(){setTimeout(function(){t.model.set("typname",null)},10)})}a.isUndefined(i)||""===i||(o={tname:i},n=t.model.fetch_columns_ajax.apply(t,[o]),l.set(n,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:e("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:e("Advanced")},{id:"relhasoids",label:e("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:e("Advanced")},{id:"relpersistence",label:e("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Advanced")},{id:"conname",label:e("Primary key"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"reltuples",label:e("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"rows_cnt",label:e("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema",control:Backform.InputControl.extend({formatter:{fromRaw:function(e,t){var i=l.Browser.tree,n=i.selected(),a=n&&1==n.length?i.itemData(n):void 0;return a&&a.rows_cnt&&parseInt(a.rows_cnt,10)>0?a.rows_cnt:e},toRaw:function(e,t){return e}}})},{id:"relhassubclass",label:e("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"is_sys_table",label:e("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:e("Like"),group:e("Advanced"),schema:[{id:"like_relation",label:e("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:e("Like")},{id:"like_default_value",label:e("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_constraints",label:e("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_indexes",label:e("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_storage",label:e("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_comments",label:e("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")}]},{id:"partition_type",label:e("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:[{label:e("Range"),value:"range"},{label:e("List"),value:"list"}],mode:["create"],visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()||!e.get("is_partitioned")}},{id:"partition_keys",label:e("Partition Keys"),model:Backform.PartitionKeyModel,subnode:Backform.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),i=e.get("typname"),n=!1,o=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(o=1),t.length<=0&&!a.isUndefined(i)&&!a.isNull(i)&&e.of_types_tables.length>0?a.each(e.of_types_tables,function(e){e.label==i&&e.oftype_columns.length>0&&(n=!0)}):t.length>0&&(n=a.some(t.pluck("name"))),e.get("partition_keys")&&e.get("partition_keys").length<o&&n},visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.get("partition_keys")&&e.get("partition_keys").models.length>0&&setTimeout(function(){var t=e.get("partition_keys");t.remove(t.filter(function(e){return!0}))},10)}},{id:"partition_scheme",label:e("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partition_key_note",label:e("Partition Keys"),type:"note",group:"partition",mode:["create"],text:["<br>&nbsp;&nbsp;",e("Partition table supports two types of keys:"),"<br><ul><li>",e("Column: User can select any column from the list of available columns."),"</li><li>",e("Expression: User can specify expression to create partition key."),"<br><p>",e("Example"),":",e("Let's say, we want to create a partition table based per year for the column 'saledate', having datatype 'date/timestamp', then we need to specify the expression as 'extract(YEAR from saledate)' as partition key."),"</p></li></ul>"].join(""),visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{id:"partitions",label:e("Partitions"),model:Backform.PartitionsModel,subnode:Backform.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,customDeleteTitle:e("Detach Partition"),customDeleteMsg:e("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","values_from","values_to","values_in"],control:Backform.SubNodeCollectionControl.extend({row:n.PartitionRow,initialize:function(){Backform.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var n=this.field.get("schema_node"),a=this.field.get("node_info");i.ajax({url:n.generate_url.apply(n,[null,"get_attach_tables",this.field.get("node_data"),!0,a]),type:"GET",async:!1,success:function(i){1==i.success?t.model.table_options=i.data:s.alert(e("Error fetching tables to be attached"),i.data.result)},error:function(t){var n=i.parseJSON(t.responseText);s.alert(e("Error fetching tables to be attached"),n.errormsg)}})}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()&&e.get("partitions")&&e.get("partitions").models.length>0&&setTimeout(function(){var t=e.get("partitions");t.remove(t.filter(function(e){return!0}))},10)}},{id:"partition_note",label:e("Partitions"),type:"note",group:"partition",text:["<ul>"," <li>",e("Create a table: User can create multiple partitions while creating new partitioned table. Operation switch is disabled in this scenario."),"</li><li>",e("Edit existing table: User can create/attach/detach multiple partitions. In attach operation user can select table from the list of suitable tables to be attached."),"</li><li>",e("From/To/In input: Values for these fields must be quoted with single quote. For more than one partition key values must be comma(,) separated."),"<br>",e("Example"),":<ul><li>",e("From/To: Enabled for range partition. Consider partitioned table with multiple keys of type Integer, then values should be specified like '100','200'."),"</li><li> ",e("In: Enabled for list partition. Values must be comma(,) separated and quoted with single quote."),"</li></ul></li></ul>"].join(""),visible:function(e){return!a.isUndefined(e.node_info)&&!a.isUndefined(e.node_info.server)&&!a.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{type:"nested",control:"tab",group:e("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:Backform.VacuumSettingsSchema},{id:"relacl_str",label:e("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:e("Security")},r.SecurityGroupSchema,{id:"relacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security labels"),canEdit:!1,model:r.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:e("Storage settings"),type:"multiline",group:e("Advanced"),mode:["properties"]}],validate:function(t){var i=(this.changed,void 0),n=this.get("name"),o=this.get("schema"),l=this.get("relowner"),r=this.get("is_partitioned"),s=this.get("partition_keys");return a.isUndefined(n)||a.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(i=e("Table name cannot be empty."),this.errorModel.set("name",i),i):(this.errorModel.unset("name"),a.isUndefined(o)||a.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(i=e("Table schema cannot be empty."),this.errorModel.set("schema",i),i):(this.errorModel.unset("schema"),a.isUndefined(l)||a.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(i=e("Table owner cannot be empty."),this.errorModel.set("relowner",i),i):(this.errorModel.unset("relowner"),r&&this.isNew()&&!a.isNull(s)&&s.length<=0?(i=e("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",i),i):(this.errorModel.unset("partition_keys"),null))))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!a.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!a.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("coll_inherits",[])},10),!0):!(!e.inSchema.apply(this,[e])&&(a.isUndefined(e.get("typname"))||a.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(a.isUndefined(e.get("typname"))||a.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||a.isUndefined(e.get("typname"))||a.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return a.isUndefined(e.get("inheritedfrom"))||a.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(a.isUndefined(e.get("coll_inherits"))||a.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,n="get_columns",o=t.model.top||t.model,l=(a.clone(o.get("columns")),void 0),s=this.field.get("schema_node"),d=this.field.get("node_info"),c=s.generate_url.apply(s,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||!1,d]),p=this.field.get("cache_level")||s.type,u=this.field.get("cache_node");return u=u&&r.Nodes[u]||s,o.trigger("pgadmin:view:fetching",o,t.field),i.ajax({async:!1,url:c,data:e,success:function(e){l=u.cache(n,d,p,e.data)},error:function(){o.trigger("pgadmin:view:fetch:error",o,t.field)}}),o.trigger("pgadmin:view:fetched",o,t.field),l=l&&l.data||[]}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=r.tree,o=t,l=e;o;){if(a.indexOf(["schema"],l._type)>-1)return!0;if("coll-table"==l._type){var s=n.hasParent(o)?n.parent(o):null;return"catalog"!=(s?n.itemData(s):null)._type}o=n.hasParent(o)?n.parent(o):null,l=o?n.itemData(o):null}return!0},canCreate_with_trigger_enable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return e.tigger_count>0},canCreate_with_trigger_disable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return e.tigger_count>0&&e.has_enable_triggers>0},onTableUpdated:function(e,t,i){if(i.is_partitioned&&"affected_partitions"in i){var n=i.affected_partitions,o=this,s=[],d=[];if("detached"in n&&n.detached.length>0){r.removeChildTreeNodesById(e,"coll-partition",a.map(n.detached,function(e){return parseInt(e.oid)}));var c,p=r.findParentTreeNodeByType(e,"schema"),u=a.groupBy(n.detached,function(e){return parseInt(e.schema_id)});for(var m in u)if(p=r.findSiblingTreeNode(p,m)){c=a.map(u[m],function(e){return parseInt(e.oid)});var g=r.findChildCollectionTreeNode(p,"coll-table");g&&d.push({parent:g,type:"table",treeHierarchy:l.Browser.Nodes.schema.getTreeNodeHierarchy(p),childrenIDs:a.clone(c)})}}if("attached"in n&&n.attached.length>0){var c,p=r.findParentTreeNodeByType(e,"schema"),h=a.groupBy(n.attached,function(e){return parseInt(e.schema_id)});for(var m in h)p=r.findSiblingTreeNode(p,m),p&&(c=a.map(h[m],function(e){return parseInt(e.oid)}),r.removeChildTreeNodesById(p,"coll-table",c)),s=s.concat(c)}if("created"in n&&n.created.length>0&&a.each(n.created,function(e){s.push(e.oid)}),s.length){o.getTreeNodeHierarchy(e);var b=r.findChildCollectionTreeNode(e,"coll-partition");b&&d.push({parent:b,type:"partition",treeHierarchy:o.getTreeNodeHierarchy(e),childrenIDs:s})}!function e(){if(d.length){var t=d.pop();r.addChildTreeNodes(t.treeHierarchy,t.parent,t.type,t.childrenIDs,e)}}()}},handle_cache:function(){this.clear_cache.apply(this,null)}})),r.Nodes.table}.apply(t,a))&&(e.exports=o)}).call(t,i(11))},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(17),i(8),i(9)],void 0!==(l=function(e,t,i,o,l,r,s,d,c){if(!s.Nodes["coll-column"]){s.Nodes["coll-column"]=s.Collection.extend({node:"column",label:e("Columns"),type:"coll-column",columns:["name","atttypid","description"]})}var p=d.VariablesModel=s.Node.Model.extend({idAttribute:"name",defaults:{name:null,value:null},schema:[{id:"name",label:e("Name"),cell:"select2",type:"text",disabled:!1,node:"column",options:[["n_distinct","n_distinct"],["n_distinct_inherited","n_distinct_inherited"]],select2:{placeholder:"Select variable"},cellHeaderClasses:"width_percent_50"},{id:"value",label:e("Value"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"}],validate:function(){var t=null;return o.isUndefined(this.get("value"))||o.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")?(t=e("Please provide input for variable."),this.errorModel.set("value",t),t):(this.errorModel.unset("value"),null)}}),u=n.Extension.IntegerDepCell=n.IntegerCell.extend({initialize:function(){n.NumberCell.prototype.initialize.apply(this,arguments),n.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(o.isFunction(i)?!i.apply(t,[e]):!i)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this.delegateEvents(),this},render:function(){n.NumberCell.prototype.render.apply(this,arguments);var e=this.model,t=this.column,i=this.column.get("editable");return(o.isFunction(i)?!i.apply(t,[e]):!i)?this.$el.removeClass("editable"):this.$el.addClass("editable"),this},remove:n.Extension.DependentCell.prototype.remove});return s.Nodes.column||(s.Nodes.column=s.Node.extend({getTreeNodeHierarchy:s.tableChildTreeNodeHierarchy,parent_type:["table","view","mview"],collection_type:["coll-table","coll-view","coll-mview"],type:"column",label:e("Column"),hasSQL:!0,sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-altertable.html",dialogHelp:t("help.static",{filename:"column_dialog.html"}),canDrop:function(e,t,i){if(!s.Nodes.schema.canChildDrop.apply(this,[e,t,i]))return!1;for(var n=s.tree,a=t,l=e,r=[];a;)r.push(l._type),a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null;return!(o.indexOf(r,"catalog")>-1||o.indexOf(r,"view")>-1||o.indexOf(r,"mview")>-1)&&(o.indexOf(r,"table")>-1||void 0)},hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_column_on_coll",node:"coll-column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column",node:"column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"}]))},model:s.Node.Model.extend({idAttribute:"attnum",defaults:{name:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0,parent_tbl:void 0,min_val:void 0,max_val:void 0,edit_types:void 0,is_primary_key:!1,inheritedfrom:void 0,attstattarget:void 0,attnotnull:!1,attlen:null,attprecision:null},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_30",editable:"editable_check_for_table"},{id:"is_primary_key",label:e("Primary key?"),cell:n.Extension.TableChildSwitchCell,type:"switch",deps:["name"],cellHeaderClasses:"width_percent_5",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary"},visible:function(e){return o.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)},disabled:function(e){if(e.top&&(!o.isUndefined(e.top.get("oid"))&&e.top.get("primary_key").length>0&&!o.isUndefined(e.top.get("primary_key").first().get("oid"))||e.top.has("is_partitioned")&&e.top.get("is_partitioned")))return!0;var t=e.get("name");return!(e.inSchemaWithColumnCheck.apply(this,[e])||!o.isUndefined(t)&&!o.isNull(t)&&""!=t)},editable:function(e){var t=e.get("name");return e instanceof a.Collection||!(e.top&&!o.isUndefined(e.top.get("oid"))&&e.top.get("primary_key").length>0&&!o.isUndefined(e.top.get("primary_key").first().get("oid")))&&(e.top&&!o.isUndefined(e.top.get("is_partitioned"))&&e.top.get("is_partitioned")?(setTimeout(function(){e.set("is_primary_key",!1)},10),!1):!(e.inSchemaWithColumnCheck.apply(this,[e])||o.isUndefined(t)||o.isNull(t)||""===t))}},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:"notInSchema",mode:["properties"]},{id:"cltype",label:e("Data type"),cell:n.Extension.NodeAjaxOptionsCell.extend({exitEditMode:function(e){var t=this;this.$select.off("blur",this.exitEditMode),this.$select.select2("close"),this.$el.removeClass("editor");var i,a=this.$el.next(),o=this.$el.next().next().next();setTimeout(function(){if(a&&a.hasClass("editable")&&e?i=a:o&&o.hasClass("editable")&&e&&(i=o),i){e.preventDefault(),e.stopPropagation();var l=new n.Command({key:"Tab",keyCode:9,which:9});t.model.trigger("backgrid:edited",t.model,t.column,l),i.focus()}},20)}}),type:"text",disabled:"inSchemaWithColumnCheck",control:"node-ajax-options",url:"get_types",node:"table",cellHeaderClasses:"width_percent_30",first_empty:!0,select2:{allowClear:!1},group:e("Definition"),cache_node:"table",transform:function(e,t){var i=t||this,n=i.model;i.model.datatypes=e;var a=n.get("edit_types"),l=[];return o.isUndefined(n.top)||n.top.isNew()?n.isNew()?e:(o.each(e,function(e){-1!=o.indexOf(a,e.value)&&l.push(e)}),l):(o.each(e,function(e){-1!=o.indexOf(a,e.value)&&l.push(e)}),l.length>0?l:e)},editable:"editable_check_for_table"},{id:"inheritedfrom",label:e("Inherited from table"),type:"text",disabled:!0,editable:!1,cellHeaderClasses:"width_percent_10",visible:function(e){return o.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)}},{id:"attlen",label:e("Length"),cell:u,deps:["cltype"],type:"int",group:e("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(e){var t=e.get("cltype"),i=!0;return o.each(e.datatypes,function(n){t==n.value&&n.length&&(e.set("min_val",n.min_val,{silent:!0}),e.set("max_val",n.max_val,{silent:!0}),i=!1)}),i&&setTimeout(function(){e.get("attlen")&&e.set("attlen",null)},10),i},editable:function(e){if(!o.isUndefined(e.get("inheritedfrom")))return!1;if(!e.datatypes)return!0;var t=e.get("cltype"),i=!1;return o.each(e.datatypes,function(n){t==n.value&&n.length&&(e.set("min_val",n.min_val,{silent:!0}),e.set("max_val",n.max_val,{silent:!0}),i=!0)}),!i&&setTimeout(function(){e.get("attlen")&&e.set("attlen",null,{silent:!0})},10),i}},{id:"attprecision",label:e("Precision"),cell:u,deps:["cltype"],type:"int",group:e("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(e){var t=e.get("cltype"),i=!0;return o.each(e.datatypes,function(n){t==n.value&&n.precision&&(e.set("min_val",0,{silent:!0}),e.set("max_val",n.max_val,{silent:!0}),i=!1)}),i&&setTimeout(function(){e.get("attprecision")&&e.set("attprecision",null)},10),i},editable:function(e){if(!o.isUndefined(e.get("inheritedfrom")))return!1;if(!e.datatypes)return!0;var t=e.get("cltype"),i=!1;return o.each(e.datatypes,function(n){t==n.value&&n.precision&&(e.set("min_val",0,{silent:!0}),e.set("max_val",n.max_val,{silent:!0}),i=!0)}),!i&&setTimeout(function(){e.get("attprecision")&&e.set("attprecision",null)},10),i}},{id:"collspcname",label:e("Collation"),cell:"string",type:"text",control:"node-ajax-options",url:"get_collations",group:e("Definition"),node:"collation",deps:["cltype"],disabled:function(e){var t=e.get("cltype"),i=!0;return o.each(e.datatypes,function(e){t==e.value&&e.is_collatable&&(i=!1)}),i&&setTimeout(function(){e.get("collspcname")&&""!==e.get("collspcname")&&e.set("collspcname","")},10),i}},{id:"defval",label:e("Default Value"),cell:"string",type:"text",group:e("Definition"),deps:["cltype"],disabled:function(e){if(!e.inSchemaWithModelCheck.apply(this,[e])){var t=e.get("cltype");return"serial"==t||"bigserial"==t||"smallserial"==t}}},{id:"attnotnull",label:e("Not NULL?"),cell:"switch",type:"switch",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_20",group:e("Definition"),editable:"editable_check_for_table",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary"}},{id:"attstattarget",label:e("Statistics"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",mode:["properties","edit"],group:e("Definition")},{id:"attstorage",label:e("Storage"),group:e("Definition"),type:"text",mode:["properties","edit"],cell:"string",disabled:"inSchemaWithColumnCheck",first_empty:!0,control:"select2",select2:{placeholder:"Select storage",allowClear:!1,width:"100%"},options:[{label:"PLAIN",value:"p"},{label:"MAIN",value:"m"},{label:"EXTERNAL",value:"e"},{label:"EXTENDED",value:"x"}]},{id:"is_pk",label:e("Primary key?"),type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"is_fk",label:e("Foreign key?"),type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"is_inherited",label:e("Inherited?"),type:"switch",disabled:!0,mode:["properties"],group:e("Definition")},{id:"tbls_inherited",label:e("Inherited from table(s)"),type:"text",disabled:!0,mode:["properties"],deps:["is_inherited"],group:e("Definition"),visible:function(e){return!(o.isUndefined(e.get("is_inherited"))||!e.get("is_inherited"))}},{id:"is_sys_column",label:e("System column?"),cell:"string",type:"switch",disabled:!0,mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"notInSchema"},{id:"attoptions",label:e("Variables"),type:"collection",group:e("Variables"),control:"unique-col-collection",model:p,uniqueCol:["name"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},s.SecurityGroupSchema,{id:"attacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:s.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),mode:["edit"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security Labels"),canAdd:!0,model:s.SecLabelModel,group:"security",mode:["edit","create"],editable:!1,type:"collection",min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(t){var i=(this.changed,void 0);return t&&0==t.length?(this.errorModel.clear(),null):(this.errorModel.clear(),o.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Column name cannot be empty."),this.errorModel.set("name",i),i):o.isUndefined(this.get("cltype"))||""==String(this.get("cltype")).replace(/^\s+|\s+$/g,"")?(i=e("Column type cannot be empty."),this.errorModel.set("cltype",i),i):o.isUndefined(this.get("cltype"))||o.isUndefined(this.get("attlen"))||o.isNull(this.get("attlen"))||""===this.get("attlen")||(this.get("attlen")<this.get("min_val")&&(i=e("Length should not be less than: ")+this.get("min_val")),this.get("attlen")>this.get("max_val")&&(i=e("Length should not be greater than: ")+this.get("max_val")),!i)?o.isUndefined(this.get("cltype"))||o.isUndefined(this.get("attprecision"))||o.isNull(this.get("attprecision"))||""===this.get("attprecision")||(this.get("attprecision")<this.get("min_val")&&(i=e("Precision should not be less than: ")+this.get("min_val")),this.get("attprecision")>this.get("max_val")&&(i=e("Precision should not be greater than: ")+this.get("max_val")),!i)?null:(this.errorModel.set("attprecision",i),i):(this.errorModel.set("attlen",i),i))},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){var t=this.node_info||e.node_info||e.top.node_info;return!!(t&&("view"in t||"mview"in t)&&this&&o.has(this,"name")&&"defval"!=this.name)||(!(t&&"schema"in t)||(!o.isUndefined(e.get("inheritedfrom"))||!e.isNew()&&!(!o.isUndefined(e.get("attnum"))&&e.get("attnum")>0)))},editable_check_for_table:function(e){return e instanceof a.Collection?!e.model.prototype.inSchemaWithColumnCheck.apply(this,[e.top]):!e.inSchemaWithColumnCheck.apply(this,[e])}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e,r=[];a;){if(o.indexOf(["schema"],l._type)>-1)return!0;if(o.indexOf(["view","coll-view","mview","coll-mview"],l._type)>-1){r.push(l._type);break}r.push(l._type),a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!(o.indexOf(r,"catalog")>-1||o.indexOf(r,"coll-view")>-1||o.indexOf(r,"coll-mview")>-1||o.indexOf(r,"mview")>-1||o.indexOf(r,"view")>-1)}})),s.Nodes.column}.apply(t,o))&&(e.exports=l)}).call(t,i(11),i(10))},function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(4),i(3),i(6),i(9),i(315),i(316),i(317),i(318),i(319)],void 0!==(a=function(e,t,i,n,a,o){if(!o.Nodes["coll-constraints"]){a.Browser.Nodes["coll-constraints"]=a.Browser.Collection.extend({node:"constraints",label:e("Constraints"),type:"coll-constraints",getTreeNodeHierarchy:o.tableChildTreeNodeHierarchy,columns:["name","comment"]})}return o.Nodes.constraints||(a.Browser.Nodes.constraints=o.Node.extend({getTreeNodeHierarchy:o.tableChildTreeNodeHierarchy,type:"constraints",label:e("Constraints"),collection_type:"coll-constraints",parent_type:["table","partition"],Init:function(){this.initialized||(this.initialized=!0,o.add_menus([]))},model:a.Browser.Node.Model.extend({defaults:{name:void 0,oid:void 0,comment:void 0},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("Oid"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"]}]})})),o.Nodes.constraints}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(o=function(e,t,i,a,o,l,r,s){return r.Nodes.unique_constraint||(l.Browser.Nodes.unique_constraint=r.Node.extend({type:"unique_constraint",label:e("Unique constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"unique_constraint_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Index size"],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,getTreeNodeHierarchy:r.tableChildTreeNodeHierarchy,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_unique_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Unique constraint"),icon:"wcTabIcon icon-unique_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=r.tree,o=t,l=e,s=[],d=!1,c=!1;o;){if(d||"table"!=l._type&&"partition"!=l._type||(d=!0,"is_partitioned"in l&&l.is_partitioned&&(c=!0)),a.indexOf(["schema"],l._type)>-1)return!c;s.push(l._type),o=n.hasParent(o)?n.parent(o):null,l=o?n.itemData(o):null}return!(a.indexOf(s,"catalog")>-1)&&!c},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"columns",label:e("Columns"),type:"collection",group:e("Definition"),editable:!1,cell:n.StringCell.extend({initialize:function(){n.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(a.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(i),setTimeout(function(){t.render()},10);setTimeout(function(){constraints=t.model.top.get("unique_constraint");var e=[];constraints.each(function(t){0==t.get("columns").length&&e.push(t)}),constraints.remove(e)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});i.length>0&&i[0].set({column:e.get("name")},{silent:!0}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e,t){return e.pluck("column").toString()},toRaw:function(e,t){return e}},render:function(){return n.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),n.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:Backform.MultiSelectAjaxControl.extend({defaults:a.extend({},Backform.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:e("Select the column(s)")}}),keyPathAccessor:function(e,t){var i=e;if(a.isArray(i))return a.map(i,function(e){return e.column});t=t.split(".");for(var n=0;n<t.length;n++){if(a.isNull(i))return null;a.isEmpty(t[n])||(a.isUndefined(i[t[n]])||(i=i[t[n]]))}return a.isObject(i)&&!a.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(Backform.Select2Control.prototype.initialize.apply(this,arguments),a.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else Backform.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",function(){e.render.apply(e)})},resetColOptions:function(e){var t=this;setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&a.each(e.models,function(e){var i=e.get("name");a.isUndefined(i)||a.isNull(i)||t.push({label:i,value:i,image:"icon-column"})}),this.field.set("options",t)},onChange:function(e){var t=this,n=this.model,o=(i(e.target),this.field.get("name").split(".")),l=o.shift(),r=(o.join("."),this.getValueFromDOM()),s=n.get(l),d=[];this.stopListening(this.model,"change:"+l,this.render),s.each(function(e){var t=e.get("column"),i=a.indexOf(r,t);i>-1?r.splice(i,1):d.push(t)}),a.each(r,function(e){var i=new(t.field.get("model"))({column:e},{silent:!0,top:t.model.top,collection:s,handler:s});s.add(i)}),a.each(d,function(e){s.remove(s.where({column:e}))}),this.listenTo(this.model,"change:"+l,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),Backform.Select2Control.prototype.remove.apply(this,arguments)}else Backform.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:r.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&a.isArray(e)&&a.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},disabled:function(e){if(a.has(e,"top")&&!a.isUndefined(e.top)&&!e.top.isNew())return!a.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){e=e.top||e;var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("spcname","")},10),!0)}},{id:"index",label:e("Index"),type:"text",group:e("Definition"),control:Backform.NodeListByNameControl.extend({initialize:function(){a.isUndefined(this.model.top)?Backform.NodeListByNameControl.prototype.initialize.apply(this,arguments):Backform.Control.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",disabled:function(e){return!(!a.has(e,"top")||a.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!a.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:e("Fill factor"),deps:["index"],type:"int",group:e("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("fillfactor",null)},10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],disabled:function(e){if(a.has(e,"top")&&!a.isUndefined(e.top)&&!e.top.isNew())return!a.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(setTimeout(function(){e.get("condeferrable")&&e.set("condeferrable",!1)},10),!0)}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return!a.has(e,"top")||a.isUndefined(e.top)||e.top.isNew()?!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0):!a.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear(),a.has(this,"top")&&this.top.errorModel.clear();var t=this.get("columns"),i=this.get("index");if((a.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,""))&&(a.isUndefined(t)||a.isNull(t)||t.length<1)){var n=e("Please specify columns for %(node)s",{node:e("Unique constraint")});return this.errorModel.set("columns",n),n}return null}})})),r.Nodes.unique_constraint}.apply(t,a))&&(e.exports=o)}).call(t,i(11))},function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(9)],void 0!==(a=function(e,t,i,n,a,o,l,r){return l.Nodes.check_constraint||(o.Browser.Nodes.check_constraint=l.Node.extend({getTreeNodeHierarchy:l.tableChildTreeNodeHierarchy,type:"check_constraint",label:e("Check"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"check_dialog.html"}),hasSQL:!0,hasDepends:!0,parent_type:["table","partition"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_check_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Check..."),icon:"wcTabIcon icon-check_constraint",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_check_constraint",node:"check_constraint",module:this,applies:["object","context"],callback:"validate_check_constraint",category:"validate",priority:4,label:e("Validate check constraint"),icon:"fa fa-link",enable:"is_not_valid",data:{action:"edit",check:!0}}]))},is_not_valid:function(e,t,i){return!!this.canCreate(e,t,i)&&(e&&!e.valid)},callbacks:{validate_check_constraint:function(e){var t=e||{},n=this,a=l.tree,o=t.item||a.selected(),s=o&&1==o.length?a.itemData(o):void 0;if(!s)return!1;var d=s;return i.ajax({url:n.generate_url(o,"validate",s,!0),type:"GET",success:function(e){1==e.success&&(r.success(e.info),a.removeIcon(o),d.valid=!0,d.icon="icon-check_constraint",a.addIcon(o,{icon:d.icon}),setTimeout(function(){a.deselect(o)},10),setTimeout(function(){a.select(o)},100))},error:function(e,t,n){try{var l=i.parseJSON(e.responseText);0==l.success&&r.error(l.errormsg)}catch(e){}a.unload(o)}}),!1}},canDrop:l.Nodes.schema.canChildDrop,model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:e("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"consrc",label:e("Check"),type:"multiline",cell:"string",group:e("Definition"),mode:["properties","create","edit"],disabled:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()},editable:!1},{id:"connoinherit",label:e("No Inherit?"),type:"switch",cell:"boolean",group:e("Definition"),mode:["properties","create","edit"],min_version:90200,disabled:function(e){return n.has(e,"top")&&!n.isUndefined(e.top)&&e.top.get("is_partitioned")||n.has(e,"node_info")&&n.has(e.node_info,"table")&&n.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned?(setTimeout(function(){e.set("connoinherit",!1)},10),!0):n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()}},{id:"convalidated",label:e("Don't validate?"),type:"switch",cell:"boolean",group:e("Definition"),min_version:90200,disabled:function(e){return!!(n.isFunction(e.isNew)&&!e.isNew()||n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid")))&&!e.get("convalidated")},mode:["properties","create","edit"]}],validate:function(){var t,i={};return(n.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(i.consrc=e("Check cannot be empty."),t=t||i.consrc),this.errorModel.clear().set(i),n.size(i)?(this.trigger("on-status",{msg:t}),t):null},isDisabled:function(e){if(n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()){if((this.node_info||e.top.node_info).server.version<90200)return!0}return!1}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var a=l.tree,o=t,r=e,s=[];o;){if(n.indexOf(["schema"],r._type)>-1)return!0;s.push(r._type),o=a.hasParent(o)?a.parent(o):null,r=o?a.itemData(o):null}return!(n.indexOf(s,"catalog")>-1)}})),l.Nodes.check_constraint}.apply(t,n))&&(e.exports=a)},function(e,t,i){"use strict";(function(n,a){function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l,r;l=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(15),i(9)],void 0!==(r=function(e,t,i,l,r,s,d,c){var p=function(e){if(!e.id)return e.text;var t=i(e.element).data("image");return t?i('<span><span class="wcTabIcon '+t+'"/>'+e.text+"</span>"):e.text},u=l.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >','    <%=select2.first_empty ? " <option></option>" : ""%>',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),m=d.Node.Model.extend({defaults:{local_column:void 0,references:void 0,referenced:void 0},schema:[{id:"local_column",label:e("Local"),type:"text",editable:!1,cellHeaderClasses:"width_percent_50",cell:"string",headerCell:n.Extension.CustomHeaderCell},{id:"referenced",label:e("Referenced"),type:"text",editable:!1,cell:"string",cellHeaderClasses:"width_percent_50",headerCell:n.Extension.CustomHeaderCell}]}),g=Backform.ForeignKeyColumnControl=Backform.UniqueColCollectionControl.extend({initialize:function(t){Backform.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var n=this,o=[{id:"local_column",label:"",type:"text",node:"column",control:Backform.NodeListByNameControl.extend({initialize:function(){if(n.model.handler){if(Backform.Select2Control.prototype.initialize.apply(this,arguments),l.isUndefined(n.model.get("oid"))){var e=n.model.top.get("columns");this.listenTo(e,"remove",this.removeColumn),this.listenTo(e,"change:name",this.resetColOptions)}this.custom_options()}else Backform.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(e){var t=this;setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},resetColOptions:function(e){var t=this;e.previous("name")==n.headerData.get("local_column")&&(n.headerData.set({local_column:e.get("name")}),n.headerDataChanged()),setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},custom_options:function(){var e=n.model.top.get("columns"),t=[];e.length>0&&l.each(e.models,function(e){var i=e.get("name");l.isUndefined(i)||l.isNull(i)||t.push({label:i,value:i,image:"icon-column"})}),this.field.set("options",t)},template:u,remove:function(){if(n.model.handler){var e=n.model.top.get("columns");this.stopListening(e,"remove",this.removeColumn),this.stopListening(e,"change:name",this.resetColOptions),Backform.Select2Control.prototype.remove.apply(this,arguments)}else Backform.NodeListByNameControl.prototype.remove.apply(this,arguments)}}),select2:{allowClear:!1,width:"style",placeholder:e("Select column"),first_empty:!l.isUndefined(n.model.get("oid"))},version_compatible:n.field.get("version_compatible"),disabled:function(e){return!l.isUndefined(n.model.get("oid"))}},{id:"references",label:"",type:"text",cache_level:"server",select2:{allowClear:!1,width:"style",placeholder:"Select foreign table"},first_empty:!0,control:Backform.NodeListByNameControl.extend({formatter:Backform.ControlFormatter,template:u}),url:"all_tables",node:"table",version_compatible:n.field.get("version_compatible"),disabled:function(e){return!l.isUndefined(n.model.get("oid"))},transform:function(e){var t=[];return l.each(e,function(e){t.push({value:e.value,image:"icon-table",label:e.label})}),t}},{id:"referenced",label:"",type:"text",cache_level:"server",transform:function(e){var t=[];return l.each(e,function(e){t.push({value:e.name,image:"icon-column",label:e.name})}),t},control:Backform.Select2Control.extend({formatter:Backform.ControlFormatter,template:u,render:function(){var e=this,t=e.field.get("url")||e.defaults.url,n=e.model,a=n.get("references");if(n.set(e.field.get("name"),null,{silent:!0}),!t||l.isUndefined(a)||l.isNull(a)||""==a)e.field.set("options",[]);else{var o=this.field.get("schema_node"),r=this.field.get("node_info"),s=o.generate_url.apply(o,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,r]),d=[];this.field.get("version_compatible")&&(n.trigger("pgadmin:view:fetching",n,e.field),i.ajax({async:!1,data:{tid:a},url:s,success:function(e){d=e.data},error:function(){n.trigger("pgadmin:view:fetch:error",n,e.field)}}),n.trigger("pgadmin:view:fetched",n,e.field));var c=this.field.get("transform")||e.defaults.transform;c&&l.isFunction(c)?e.field.set("options",c.bind(e,d)):e.field.set("options",d)}return Backform.Select2Control.prototype.render.apply(this,arguments),this}}),url:"get_columns",select2:{allowClear:!1,width:"style",placeholder:e("Select column"),templateResult:p,templateSelection:p},deps:["references"],node:"table",version_compatible:n.field.get("version_compatible"),disabled:function(e){return!l.isUndefined(n.model.get("oid"))}}],r={local_column:null,references:null,referenced:null},s=["local_column","references","referenced"];if(!n.model.isNew()&&l.isUndefined(n.model.handler)||l.has(n.model,"handler")&&!l.isUndefined(n.model.handler)&&!l.isUndefined(n.model.get("oid"))){var d=n.collection.first();d&&(r.references=d.get("references"))}n.headerData=new(a.Model.extend({defaults:r,schema:o}))({});var c=Backform.generateViewSchema(n.field.get("node_info"),n.headerData,"create","foreign_key",n.field.get("node_data")),m=[];l.each(c,function(e){m=m.concat(e.fields)}),n.headerFields=new Backform.Fields(m),n.gridSchema=Backform.generateGridColumnsFromModel(n.field.get("node_info"),n.field.get("model"),"edit",s,n.field.get("schema_node")),n.controls=[],n.listenTo(n.headerData,"change",n.headerDataChanged),n.listenTo(n.headerData,"select2",n.headerDataChanged),n.listenTo(n.collection,"add",n.onAddorRemoveColumns),n.listenTo(n.collection,"remove",n.onAddorRemoveColumns)},generateHeader:function(t){var n=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-md-6" header="local_column"></div>','   <div class="col-md-2">','     <button class="btn-sm btn-default add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-references_label%></label>',"   </div>",'   <div class="col-md-6" header="references"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-referenced_label%></label>',"   </div>",'   <div class="col-md-6" header="referenced"></div>',"  </div>"," </div>","</div>"].join("\n");l.extend(t,{column_label:e("Local column"),references_label:e("References"),referenced_label:e("Referencing")});var a=this,o=l.template(n),r=i(o(t)),s=this.controls;return this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:a.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el),s.push(t)}),"properties"==t.mode&&r.html(""),a.$header=r,r},events:l.extend({},Backform.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,a=l.template(["<div class='subnode-header'>","<label class='control-label'><%-label%></label>","</div>"].join("\n")),o=i("<div class='pgadmin-control-group backgrid form-group col-xs-12 object subnode'></div>").append("properties"!==e.mode?a({label:e.label}):"");t.grid&&t.grid.remove(),o.append(t.generateHeader(e));var r=l.clone(this.gridSchema);0==e.disabled&&e.canDelete&&r.columns.unshift({name:"pg-backform-delete",label:"",cell:n.Extension.DeleteCell,editable:!1,cell_priority:-1});var s=t.grid=new n.Grid({columns:r.columns,collection:t.collection,className:"backgrid table-bordered"});return t.$grid=s.render().$el,o.append(t.$grid),setTimeout(function(){t.headerData.set({local_column:t.$header.find('div[header="local_column"] select option:first').val(),referenced:t.$header.find('div[header="referenced"] select option:first').val(),references:t.$header.find('div[header="references"] select option:first').val()},{silent:!0})},10),"properties"===e.mode&&o.find(".subnode-header-form").removeClass("subnode-header-form"),o},headerDataChanged:function(){var e,t=this,i=this.headerData.toJSON(),n=!1,a=["local_column","referenced"];t.$header&&(t.control_data.canAdd?t.collection.each(function(t){n||l.each(a,function(a){n||(e=t.get(a),n=(l.isUndefined(e)||l.isNull(e))&&(l.isUndefined(i[a])||l.isNull(i[a]))||e==i[a])})}):n=!0,t.$header.find("button.add").prop("disabled",n))},addColumns:function(e){e.preventDefault();var t=this,n=t.headerData.get("local_column"),a=t.headerData.get("referenced");if(!n||""==n||!a||""==a)return!1;var o=new(t.field.get("model"))(t.headerData.toJSON()),l=t.model.get(t.field.get("name"));l.add(o);var r=l.indexOf(o);if(r>-1){t.$grid.find(".new").removeClass("new");var s=t.grid.body.rows[r].$el;s.addClass("new"),i(s).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout(function(){e.collection.length>0?e.$header.find('div[header="references"] select').prop("disabled",!0):e.$header.find('div[header="references"] select').prop("disabled",!1),e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged(),(!l.has(e.model,"handler")||l.has(e.model,"handler")&&l.isUndefined(e.model.handler)||l.has(e.model,"handler")&&!l.isUndefined(e.model.handler)&&!l.isUndefined(e.model.handler.get("oid")))&&e.getCoveringIndex()},10)},getCoveringIndex:function(){var e=this,t=e.model,n=[],a=null;if(e.collection.each(function(e){n.push(e.get("local_column"))}),n.length>0){var o=this.field.get("schema_node"),l=this.field.get("node_info"),r=o.generate_url.apply(o,[null,"get_coveringindex",this.field.get("node_data"),this.field.get("url_with_id")||!1,l]);this.field.get("version_compatible")&&(t.trigger("pgadmin:view:fetching",t,e.field),i.ajax({async:!1,data:{cols:JSON.stringify(n)},url:r,success:function(e){a=e.data},error:function(){t.trigger("pgadmin:view:fetch:error",t,e.field)}}),t.trigger("pgadmin:view:fetched",t,e.field))}a?(t.set("hasindex",!0),t.set("autoindex",!1),t.set("coveringindex",a)):(t.set("coveringindex",null),t.set("autoindex",!0),t.set("hasindex",!1))},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onRemoveVariable),l.each(this.controls,function(e){e.remove()}),g.__super__.remove.apply(this,arguments),delete this.headerData}});return d.Nodes.foreign_key||(s.Browser.Nodes.foreign_key=d.Node.extend({getTreeNodeHierarchy:d.tableChildTreeNodeHierarchy,type:"foreign_key",label:e("Foreign key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"foreign_key_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,d.add_menus([{name:"create_foreign_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign key..."),icon:"wcTabIcon icon-foreign_key",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_foreign_key",node:"foreign_key",module:this,applies:["object","context"],callback:"validate_foreign_key",category:"validate",priority:4,label:e("Validate foreign key"),icon:"fa fa-link",enable:"is_not_valid"}]))},is_not_valid:function(e){return e&&!e.valid},callbacks:{validate_foreign_key:function(e){var t=e||{},n=this,a=d.tree,o=t.item||a.selected(),l=o&&1==o.length?a.itemData(o):void 0;if(!l)return!1;var r=l;return i.ajax({url:n.generate_url(o,"validate",l,!0),type:"GET",success:function(e){1==e.success&&(c.success(e.info),a.removeIcon(o),r.valid=!0,r.icon="icon-foreign_key",a.addIcon(o,{icon:r.icon}),setTimeout(function(){a.deselect(o)},10),setTimeout(function(){a.select(o)},100))},error:function(e,t,n){try{var l=i.parseJSON(e.responseText);0==l.success&&c.error(l.errormsg)}catch(e){}a.unload(o)}}),!1}},model:s.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,condeferrable:void 0,condeferred:void 0,confmatchtype:void 0,convalidated:void 0,columns:void 0,confupdtype:"a",confdeltype:"a",autoindex:!0,coveringindex:void 0,hasindex:void 0},toJSON:function(){var e=s.Browser.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.hasindex,e},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,headerCell:n.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),disabled:function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!l.isUndefined(e.get("oid")):!e.isNew()}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!l.isUndefined(e.get("oid")):!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0)}},{id:"confmatchtype",label:e("Match type"),type:"switch",group:e("Definition"),options:{onText:"FULL",offText:"SIMPLE"},disabled:function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!l.isUndefined(e.get("oid")):!e.isNew()}},{id:"convalidated",label:e("Validated?"),type:"switch",group:e("Definition"),options:{onText:e("Yes"),offText:e("No")},disabled:function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!(l.isUndefined(e.get("oid"))||e.get("convalidated")):!(e.isNew()||e.get("convalidated"))}},{id:"autoindex",label:e("Auto FK index?"),type:"switch",group:e("Definition"),deps:["name","hasindex"],options:{onText:e("Yes"),offText:e("No")},disabled:function(e){var t=e.get("coveringindex"),i=e.get("autoindex"),n=function(){var i=e.get("name"),n="fki_"+e.previous("name");if(e.get("hasindex"))return!0;if(!e.get("autoindex")||l.isUndefined(i)||l.isNull(i)||""==i||!l.isUndefined(t)&&!l.isNull(t)&&""!=t&&t!=n)return!1;var a="fki_"+i;return e.set("coveringindex",a),!1};return l.has(e,"handler")&&!l.isUndefined(e.handler)?l.isUndefined(e.get("oid"))&&l.isUndefined(e.handler.get("oid"))?(setTimeout(function(){e.get("autoindex")&&e.set("autoindex",!1)},10),!0):n():!(e.isNew()||!i||l.isUndefined(t)||l.isNull(t)||""==t||!e.get("hasindex"))||n()}},{id:"coveringindex",label:e("Covering index"),type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["autoindex","hasindex"],disabled:function(e){var t=e.get("coveringindex"),i=function(){return!!e.get("hasindex")||(e.get("autoindex")?(setTimeout(function(){var t=e.get("name"),i="fki_"+t;!e.get("autoindex")||l.isUndefined(t)||l.isNull(t)||""==t||e.set("coveringindex",i)}),!1):(setTimeout(function(){e.set("coveringindex",null)}),!0))};return l.has(e,"handler")&&!l.isUndefined(e.handler)?!(!l.isUndefined(e.get("oid"))||!l.isUndefined(e.handler.get("oid")))||i():!(e.isNew()||!e.get("autoindex")||l.isUndefined(t)||!l.isNull(t)||""!=t)||i()}},o({id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),disabled:!1,node:"foreign_key",editable:!1,headerCell:n.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50",cell:n.StringCell.extend({initialize:function(){n.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(l.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}e.model.get("columns").on("pgadmin:columns:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({local_column:e.get("name")});t.model.get("columns").remove(i),setTimeout(function(){t.render()},10),setTimeout(function(){var e=t.model.top.get("foreign_key"),i=[];e.each(function(e){0==e.get("columns").length&&i.push(e)}),e.remove(i)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({local_column:e.previous("name")});i.length>0&&i[0].set({local_column:e.get("name")}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e,t){var i=[],n=[];return e.length>0?(e.each(function(e){i.push(e.get("local_column")),n.push(e.get("referenced"))}),"("+i.join(", ")+") -> ("+n.join(", ")+")"):""},toRaw:function(e,t){return e}},render:function(){return n.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns");this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),n.StringCell.prototype.remove.apply(this,arguments)}}),canAdd:function(e){return e.isNew()},canDelete:!0,control:g,model:m},"disabled",function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!l.isUndefined(e.get("oid")):!e.isNew()}),{id:"confupdtype",label:e("On update"),type:"select2",group:e("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!l.isUndefined(e.get("oid")):!e.isNew()}},{id:"confdeltype",label:e("On delete"),type:"select2",group:e("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function(e){return l.has(e,"handler")&&!l.isUndefined(e.handler)?!l.isUndefined(e.get("oid")):!e.isNew()}}],validate:function(){this.errorModel.clear();var t=this.get("columns");if(l.isUndefined(t)||l.isNull(t)||t.length<1){var i=e("Please specify columns for Foreign key.");return this.errorModel.set("columns",i),i}var n=this.get("coveringindex");if(this.get("autoindex")&&(l.isUndefined(n)||l.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,""))){var i=e("Please specify covering index name.");return this.errorModel.set("coveringindex",i),i}return null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=d.tree,a=t,o=e,r=[],s=!1,c=!1;a;){if(s||"table"!=o._type&&"partition"!=o._type||(s=!0,"is_partitioned"in o&&o.is_partitioned&&(c=!0)),l.indexOf(["schema"],o._type)>-1)return!c;r.push(o._type),a=n.hasParent(a)?n.parent(a):null,o=a?n.itemData(a):null}return!(l.indexOf(r,"catalog")>-1)&&!c}})),d.Nodes.foreign_key}.apply(t,l))&&(e.exports=r)}).call(t,i(11),i(10))},function(e,t,i){"use strict";(function(n,a){var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(l=function(e,t,i,o,l,r,s,d){var c=s.Node.Model.extend({defaults:{column:void 0,oper_class:void 0,order:!1,nulls_order:!1,operator:void 0,col_type:void 0,is_sort_nulls_applicable:!0},toJSON:function(){var e=s.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.col_type,e},schema:[{id:"column",label:e("Column"),type:"text",editable:!1,cell:"string"},{id:"oper_class",label:e("Operator class"),type:"text",node:"table",url:"get_oper_class",first_empty:!0,editable:function(e){return e instanceof n.Collection||!(o.has(e.collection,"handler")&&!o.isUndefined(e.collection.handler)&&!o.isUndefined(e.collection.handler.get("oid")))&&!(o.has(e.collection,"handler")&&!o.isUndefined(e.collection.handler)&&!o.isUndefined(e.collection.handler.get("amname"))&&"btree"!=e.collection.handler.get("amname"))},select2:{allowClear:!0,width:"style",tags:!0,placeholder:e("Select the operator class")},cell:a.Extension.Select2Cell.extend({initialize:function(){a.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this,t=e.column.get("url")||e.defaults.url,n=e.model,l=e.model.collection.handler.get("amname");if(t&&("btree"==l||o.isUndefined(l)||o.isNull(l)||""==l)){setTimeout(function(){n.set("order",!0),n.set("nulls_order",!0)},10);var r=this.column.get("schema_node"),s=n.top||n,d=this.column.get("node_info"),c=r.generate_url.apply(r,[null,t,this.column.get("node_data"),this.column.get("url_with_id")||!1,d]),p=[];l="btree",this.column.get("version_compatible")&&(s.trigger("pgadmin:view:fetching",n,e.column),i.ajax({async:!1,data:{indextype:l},url:c,success:function(t){p=t.data,e.column.set("options",p)},error:function(){s.trigger("pgadmin:view:fetch:error",n,e.column)}}),s.trigger("pgadmin:view:fetched",n,e.column))}else e.column.set("options",[])}})},{id:"order",label:e("DESC"),type:"switch",options:{onText:"ASC",offText:"DESC"},editable:function(e){return e instanceof n.Collection||!(o.has(e.collection,"handler")&&!o.isUndefined(e.collection.handler)&&!o.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"nulls_order",label:e("NULLs order"),type:"switch",options:{onText:"FIRST",offText:"LAST"},editable:function(e){return e instanceof n.Collection||!(o.has(e.collection,"handler")&&!o.isUndefined(e.collection.handler)&&!o.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"operator",label:e("Operator"),type:"text",node:"table",url:"get_operator",editable:function(e){return e instanceof n.Collection||!(o.has(e.collection,"handler")&&!o.isUndefined(e.collection.handler)&&!o.isUndefined(e.collection.handler.get("oid")))},select2:{allowClear:!1,width:"style"},cell:a.Extension.Select2Cell.extend({initialize:function(){a.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this,t=e.column.get("url")||e.defaults.url,n=e.model,l=e.model.get("col_type");if(e.column.set("options",[]),t&&!o.isUndefined(l)&&!o.isNull(l)&&""!=l){var r=this.column.get("schema_node"),s=n.top||n,d=this.column.get("node_info"),c=r.generate_url.apply(r,[null,t,this.column.get("node_data"),this.column.get("url_with_id")||!1,d]),p=[];this.column.get("version_compatible")&&(s.trigger("pgadmin:view:fetching",n,e.column),i.ajax({async:!1,data:{col_type:l},url:c,success:function(t){p=t.data,e.column.set("options",p)},error:function(){s.trigger("pgadmin:view:fetch:error",n,e.column)}}),s.trigger("pgadmin:view:fetched",n,e.column))}}})}],validate:function(){this.errorModel.clear();var t=this.get("operator"),i=this.get("column");if(o.isUndefined(t)||o.isNull(t)){var n=e("Please specify operator for column: ")+i;return this.errorModel.set("operator",n),n}return null}}),p=Backform.ExclusionConstraintColumnControl=Backform.UniqueColCollectionControl.extend({initialize:function(e){Backform.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var t=this,i=[{id:"column",label:"",type:"text",node:"column",control:Backform.NodeListByNameControl.extend({initialize:function(){if(t.model.handler){if(Backform.Select2Control.prototype.initialize.apply(this,arguments),o.isUndefined(t.model.get("oid"))){var e=t.model.top.get("columns");this.listenTo(e,"remove",this.removeColumn),this.listenTo(e,"change:name",this.resetColOptions),this.listenTo(e,"change:cltype",this.resetColOptions)}this.custom_options()}else Backform.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(e){var t=this;setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},resetColOptions:function(e){var i=this;e.previous("name")==t.headerData.get("column")&&(t.headerData.set({column:e.get("name")}),t.headerDataChanged()),setTimeout(function(){i.custom_options(),i.render.apply(i)},50)},custom_options:function(){var e=t.model.top.get("columns"),i=[],n=[];e.length>0&&o.each(e.models,function(e){var t=e.get("name");o.isUndefined(t)||o.isNull(t)||(i.push({label:t,value:t,image:"icon-column"}),n.push({name:t,type:e.get("cltype")}))}),this.field.set("options",i),t.field.set("col_types",n)},remove:function(){if(t.model.handler){var e=t.model.top.get("columns");this.stopListening(e,"remove",this.removeColumn),this.stopListening(e,"change:name",this.resetColOptions),this.stopListening(e,"change:cltype",this.resetColOptions),Backform.Select2Control.prototype.remove.apply(this,arguments)}else Backform.NodeListByNameControl.prototype.remove.apply(this,arguments)},template:o.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n"))}),transform:function(e){var i=this,n=i.field.get("schema_node"),a=[],l=[],r=i.field.get("filter")||function(){return!0};return r=r.bind(i),o.each(e,function(e){if(r(e)){var t=o.isFunction(n.node_label)?n.node_label.apply(n,[e,i.model,i]):e.label,s=o.isFunction(n.node_image)?n.node_image.apply(n,[e,i.model,i]):n.node_image||"icon-"+n.type;a.push({value:e.label,image:s,label:t}),l.push({name:e.label,type:e.datatype})}}),t.field.set("col_types",l),a},canAdd:function(e){return!(o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew())},select2:{allowClear:!1,width:"style",placeholder:"Select column"},first_empty:!t.model.isNew(),disabled:function(e){return!o.isUndefined(t.model.get("oid"))}}],a={column:null},l=["column","oper_class","order","nulls_order","operator"];t.headerData=new(n.Model.extend({defaults:a,schema:i}))({});var r=Backform.generateViewSchema(t.field.get("node_info"),t.headerData,"create","exclusion_constraint",t.field.get("node_data")),s=[];o.each(r,function(e){s=s.concat(e.fields)}),t.headerFields=new Backform.Fields(s),t.gridSchema=Backform.generateGridColumnsFromModel(t.field.get("node_info"),t.field.get("model"),"edit",l,t.field.get("schema_node")),t.controls=[],t.listenTo(t.headerData,"change",t.headerDataChanged),t.listenTo(t.headerData,"select2",t.headerDataChanged),t.listenTo(t.collection,"add",t.onAddorRemoveColumns),t.listenTo(t.collection,"remove",t.onAddorRemoveColumns)},generateHeader:function(t){var n=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-xs-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-xs-4" header="column"></div>','   <div class="col-xs-4">','     <button class="btn-sm btn-default add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>"," </div>","</div>"].join("\n");o.extend(t,{column_label:e("Column")});var a=this,l=o.template(n),r=i(l(t)),s=this.controls;return this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:a.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el),s.push(t)}),"properties"==t.mode&&r.html(""),a.$header=r,r},events:o.extend({},Backform.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,n=o.template("<div class='subnode-header'></div>"),l=i("<div class='pgadmin-control-group backgrid form-group col-xs-12 object subnode'></div>").append("properties"!==e.mode?n({label:e.label}):"");l.append(t.generateHeader(e));var r=o.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&r.unshift({name:"pg-backform-delete",label:"",cell:a.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var s=t.grid=new a.Grid({columns:r,collection:t.collection,className:"backgrid table-bordered"});return t.$grid=s.render().$el,l.append(t.$grid),setTimeout(function(){t.headerData.set({column:t.$header.find('div[header="column"] select').val()},{silent:!0})},10),"properties"===e.mode&&l.find(".subnode-header-form").removeClass("subnode-header-form"),l},headerDataChanged:function(){var e,t=this,i=this.headerData.toJSON(),n=!1,a=["column"];t.$header&&(t.control_data.canAdd?t.collection.each(function(t){n||o.each(a,function(a){n||(e=t.get(a),n=(o.isUndefined(e)||o.isNull(e))&&(o.isUndefined(i[a])||o.isNull(i[a]))||e==i[a])})}):n=!0,t.$header.find("button.add").prop("disabled",n))},addColumns:function(e){e.preventDefault();var t=this,n=t.headerData.get("column");if(!n||""==n)return!1;for(var a=t.model.get(t.field.get("name")),o=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.model.top,collection:a,handler:a}),l=t.field.get("col_types")||[],r=0;r<l.length;r++){var s=l[r];if(s.name==o.get("column")){o.set({col_type:s.type});break}}a.add(o);var d=a.indexOf(o);if(d>-1){t.$grid.find(".new").removeClass("new");var c=t.grid.body.rows[d].$el;c.addClass("new"),i(c).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout(function(){e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged()},10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveColumns),o.each(this.controls,function(e){e.remove()}),p.__super__.remove.apply(this,arguments),delete this.headerData}});return s.Nodes.exclusion_constraint||(r.Browser.Nodes.exclusion_constraint=s.Node.extend({getTreeNodeHierarchy:s.tableChildTreeNodeHierarchy,type:"exclusion_constraint",label:e("Exclusion constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"exclusion_constraint_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Index size"],Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"create_exclusion_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Exclusion constraint..."),icon:"wcTabIcon icon-exclusion_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},is_not_valid:function(e){return e&&!e.valid},model:r.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,amname:"gist",fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"amname",label:e("Access method"),type:"text",group:e("Definition"),url:"get_access_methods",node:"table",control:Backform.NodeAjaxOptionsControl.extend({onChange:function(){Backform.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("amname"),n=t.model.previous("amname"),a=t.model.get("columns");if(a.length>0&&i!=n){var o=e("Changing access method will clear columns collection");d.confirm(o,function(e){a.each(function(e){a.remove(e)}),setTimeout(function(){a.trigger("pgadmin:columns:updated",a)},10)},function(){setTimeout(function(){t.model.set("amname",n)},10)})}}}),select2:{allowClear:!0},disabled:function(e){return o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew()}},{id:"fillfactor",label:e("Fill factor"),type:"int",group:e("Definition"),allowNull:!0},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],disabled:function(e){return o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew()}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return!!(o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew())||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0)}},{id:"constraint",label:e("Constraint"),cell:"string",type:"multiline",mode:["create","edit"],editable:!1,group:e("Definition"),disabled:function(e){return o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew()}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),deps:["amname"],canDelete:!0,editable:!1,canAdd:function(e){return!(o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew())},control:p,model:c,disabled:function(e){return o.has(e,"handler")&&!o.isUndefined(e.handler)&&!o.isUndefined(e.get("oid"))||o.isFunction(e.isNew)&&!e.isNew()},cell:a.StringCell.extend({initialize:function(){a.StringCell.prototype.initialize.apply(this,arguments);var e=this;if(o.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.removeColumn),e.listenTo(t,"change:name",e.resetColOptions),e.listenTo(t,"change:cltype",e.removeColumnWithType)}this.model.get("columns").on("pgadmin:columns:updated",function(){e.render.apply(e)})},removeColumnWithType:function(e){var t=this,i=t.model.get("columns"),n=i.where({col_type:e.previous("cltype")});i.remove(n),setTimeout(function(){t.render()},10),setTimeout(function(){var e=t.model.top.get("exclude_constraint"),i=[];e.each(function(e){0==e.get("columns").length&&i.push(e)}),e.remove(i)},100)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(i),setTimeout(function(){t.render()},10),setTimeout(function(){var e=t.model.top.get("exclude_constraint"),i=[];e.each(function(e){0==e.get("columns").length&&i.push(e)}),e.remove(i)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});i.length>0&&i[0].set({column:e.get("name")}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e,t){return e.pluck("column").toString()},toRaw:function(e,t){return e}},render:function(){return a.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:columns:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),this.stopListening(e,"change:cltype",self.removeColumnWithType),a.StringCell.prototype.remove.apply(this,arguments)}})}],validate:function(){this.errorModel.clear();var t=this.get("columns"),i=this.get("name");if(o.isUndefined(i)||o.isNull(i)||i.length<1){var n=e("Please specify name for exclusion constraint.");return this.errorModel.set("name",n),n}if(o.isUndefined(t)||o.isNull(t)||t.length<1){var n=e("Please specify columns for exclusion constraint.");return this.errorModel.set("columns",n),n}return null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e,r=[],d=!1,c=!1;a;){if(d||"table"!=l._type&&"partition"!=l._type||(d=!0,"is_partitioned"in l&&l.is_partitioned&&(c=!0)),o.indexOf(["schema"],l._type)>-1)return!c;r.push(l._type),a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!(o.indexOf(r,"catalog")>-1)&&!c}})),s.Nodes.exclusion_constraint}.apply(t,o))&&(e.exports=l)}).call(t,i(10),i(11))},function(e,t,i){"use strict";(function(n){var a,o;a=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(8),i(9)],void 0!==(o=function(e,t,i,a,o,l,r,s){return r.Nodes.primary_key||(l.Browser.Nodes.primary_key=r.Node.extend({type:"primary_key",label:e("Primary key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"primary_key_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Index size"],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,getTreeNodeHierarchy:r.tableChildTreeNodeHierarchy,Init:function(){this.initialized||(this.initialized=!0,r.add_menus([{name:"create_primary_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Primary key"),icon:"wcTabIcon icon-primary_key",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,n){if(n&&0==n.check)return!0;for(var o=r.tree,l=t,s=e,d=[],c=!1,p=!1;l;){if(c||"table"!=s._type&&"partition"!=s._type||(c=!0,"is_partitioned"in s&&s.is_partitioned&&(p=!0)),a.indexOf(["schema"],s._type)>-1){if(p)return!1;var u=o.children(arguments[1],!1),m=!1;return a.each(u,function(e){n=r.tree.itemData(i(e)),m||"primary_key"!=n._type||(m=!0)}),!m}d.push(s._type),l=o.hasParent(l)?o.parent(l):null,s=l?o.itemData(l):null}return!(a.indexOf(d,"catalog")>-1)&&!p},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout(function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)},10),!0)}},{id:"columns",label:e("Columns"),type:"collection",group:e("Definition"),editable:!1,cell:n.StringCell.extend({initialize:function(){n.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(a.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",function(){e.render.apply(e)}),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(i),setTimeout(function(){t.render()},10);setTimeout(function(){constraints=t.model.top.get("primary_key");var e=[];constraints.each(function(t){0==t.get("columns").length&&e.push(t)}),constraints.remove(e)},100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});i.length>0&&i[0].set({column:e.get("name")},{silent:!0}),setTimeout(function(){t.render()},10)},formatter:{fromRaw:function(e,t){return e.pluck("column").toString()},toRaw:function(e,t){return e}},render:function(){return n.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),n.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:Backform.MultiSelectAjaxControl.extend({defaults:a.extend({},Backform.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:e("Select the column(s)")}}),keyPathAccessor:function(e,t){var i=e;if(a.isArray(i))return a.map(i,function(e){return e.column});t=t.split(".");for(var n=0;n<t.length;n++){if(a.isNull(i))return null;a.isEmpty(t[n])||(a.isUndefined(i[t[n]])||(i=i[t[n]]))}return a.isObject(i)&&!a.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(Backform.Select2Control.prototype.initialize.apply(this,arguments),a.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else Backform.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",function(){e.render.apply(e)})},resetColOptions:function(e){var t=this;setTimeout(function(){t.custom_options(),t.render.apply(t)},50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&a.each(e.models,function(e){var i=e.get("name");a.isUndefined(i)||a.isNull(i)||t.push({label:i,value:i,image:"icon-column"})}),this.field.set("options",t)},onChange:function(e){var t=this,n=this.model,o=(i(e.target),this.field.get("name").split(".")),l=o.shift(),r=(o.join("."),this.getValueFromDOM()),s=n.get(l),d=[];this.stopListening(this.model,"change:"+l,this.render),s.each(function(e){var t=e.get("column"),i=a.indexOf(r,t);i>-1?r.splice(i,1):d.push(t)}),a.each(r,function(e){var i=new(t.field.get("model"))({column:e},{silent:!0,top:t.model.top,collection:s,handler:s});s.add(i)}),a.each(d,function(e){s.remove(s.where({column:e}))}),this.listenTo(this.model,"change:"+l,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),Backform.Select2Control.prototype.remove.apply(this,arguments)}else Backform.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:r.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&a.isArray(e)&&a.each(e,function(e){t.push({label:e.label,value:e.label,image:"icon-column"})}),t},select2:{allowClear:!1},disabled:function(e){if(a.has(e,"top")&&!a.isUndefined(e.top)&&!e.top.isNew())return!a.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){e=e.top||e;var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("spcname","")},10),!0)}},{id:"index",label:e("Index"),type:"text",group:e("Definition"),control:Backform.NodeListByNameControl.extend({initialize:function(){a.isUndefined(this.model.top)?Backform.NodeListByNameControl.prototype.initialize.apply(this,arguments):Backform.Control.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",disabled:function(e){return!(!a.has(e,"top")||a.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!a.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:e("Fill factor"),deps:["index"],type:"int",group:e("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(setTimeout(function(){e.set("fillfactor",null)},10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],disabled:function(e){if(a.has(e,"top")&&!a.isUndefined(e.top)&&!e.top.isNew())return!a.isUndefined(e.get("oid"));if(!e.isNew())return!0;var t=e.get("index");return!a.isUndefined(t)&&""!=t&&(setTimeout(function(){e.get("condeferrable")&&e.set("condeferrable",!1)},10),!0)}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return!a.has(e,"top")||a.isUndefined(e.top)||e.top.isNew()?!e.isNew()||1!=e.get("condeferrable")&&(setTimeout(function(){e.get("condeferred")&&e.set("condeferred",!1)},10),!0):!a.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear(),a.has(this,"top")&&this.top.errorModel.clear();var t=this.get("columns"),i=this.get("index");if((a.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,""))&&(a.isUndefined(t)||a.isNull(t)||t.length<1)){var n=e("Please specify columns for %(node)s",{node:e("Primary key")});return this.errorModel.set("columns",n),n}return null}})})),r.Nodes.primary_key}.apply(t,a))&&(e.exports=o)}).call(t,i(11))},function(e,t,i){"use strict";(function(n){function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o,l;o=[i(2),i(5),i(0),i(1),i(4),i(3),i(6),i(17),i(15),i(9),i(194)],void 0!==(l=function(e,t,i,o,l,r,s,d,c){if(!s.Nodes["coll-partition"]){r.Browser.Nodes["coll-partition"]=r.Browser.Collection.extend({node:"partition",label:e("Partitions"),getTreeNodeHierarchy:s.tableChildTreeNodeHierarchy,type:"coll-partition",columns:["name","schema","partition_value","is_partitioned","description"]})}if(!s.Nodes.partition){var p;r.Browser.Nodes.partition=s.Node.extend((p={getTreeNodeHierarchy:s.tableChildTreeNodeHierarchy,parent_type:"table",collection_type:"coll-partition",type:"partition",label:e("Partition"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:["Size","Indexes size","Table size","Toast table size","Tuple length","Dead tuple length","Free space"],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:t("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create"],height:"95%",width:"85%",Init:function(){this.initialized||(this.initialized=!0,s.add_menus([{name:"truncate_table",node:"partition",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:e("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"partition",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:e("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"partition",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:e("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"detach_partition",node:"partition",module:this,applies:["object","context"],callback:"detach_partition",priority:2,label:e("Detach Partition"),icon:"fa fa-remove"}]))}},a(p,"getTreeNodeHierarchy",function(e){var t=0,i={},n=s.tree;do{var a=n.itemData(e);a._type in s.Nodes&&s.Nodes[a._type].hasId&&("partition"==a._type&&"partition"in i?"table"in i||(i.table=o.extend({},a,{priority:t}),t-=1):"table"==a._type?"table"in i||(i.table=o.extend({},a,{priority:t}),t-=1):(i[a._type]=o.extend({},a,{priority:t}),t-=1)),e=n.hasParent(e)?n.parent(e):null}while(e);return i}),a(p,"generate_url",function(e,t,i,n,a){return-1==o.indexOf(["stats","statistics","dependency","dependent","reset","get_relations","get_oftype","get_attach_tables"],t)?s.Node.generate_url.apply(this,arguments):("statistics"==t&&(t="stats"),a=o.isUndefined(e)||o.isNull(e)?a||{}:this.getTreeNodeHierarchy(e),l("table/%s/%s/%s/%s/%s/%s").sprintf(encodeURIComponent(t),encodeURIComponent(a.server_group._id),encodeURIComponent(a.server._id),encodeURIComponent(a.database._id),encodeURIComponent(a.partition.schema_id),encodeURIComponent(a.partition._id)).value())}),a(p,"canDrop",s.Nodes.schema.canChildDrop),a(p,"canDropCascade",s.Nodes.schema.canChildDrop),a(p,"callbacks",{enable_triggers_on_table:function(e){var t={enable:!0};this.callbacks.set_triggers.apply(this,[e,t])},disable_triggers_on_table:function(e){var t={enable:!1};this.callbacks.set_triggers.apply(this,[e,t])},set_triggers:function(e,t){var n=e||{},a=this,o=s.tree,l=n.item||o.selected(),r=l&&1==l.length?o.itemData(l):void 0;if(!r)return!1;i.ajax({url:a.generate_url(l,"set_trigger",r,!0),type:"PUT",data:t,dataType:"json",success:function(e){1==e.success&&(c.success(e.info),o.unload(l),o.setInode(l),o.deselect(l),setTimeout(function(){o.select(l)},10))},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}o.unload(l)}})},truncate_table:function(e){var t={cascade:!1};this.callbacks.truncate.apply(this,[e,t])},truncate_table_cascade:function(e){var t={cascade:!0};this.callbacks.truncate.apply(this,[e,t])},truncate:function(t,n){var a=t||{},o=this,r=s.tree,d=a.item||r.selected(),p=d&&1==d.length?r.itemData(d):void 0;if(!p)return!1;c.confirm(e("Truncate Table"),l(e("Are you sure you want to truncate table %s?")).sprintf(p.label).value(),function(e){if(e){var t=p;i.ajax({url:o.generate_url(d,"truncate",p,!0),type:"PUT",data:n,dataType:"json",success:function(e){1==e.success&&(c.success(e.info),r.removeIcon(d),t.icon="icon-partition",r.addIcon(d,{icon:t.icon}),r.unload(d),r.setInode(d),r.deselect(d),setTimeout(function(){r.select(d)},10))},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}r.unload(d)}})}},function(){})},reset_table_stats:function(t){var n=t||{},a=this,o=s.tree,r=n.item||o.selected(),d=r&&1==r.length?o.itemData(r):void 0;if(!d)return!1;c.confirm(e("Reset statistics"),l(e('Are you sure you want to reset the statistics for table "%s"?')).sprintf(d._label).value(),function(e){if(e){var t=d;i.ajax({url:a.generate_url(r,"reset",d,!0),type:"DELETE",success:function(e){1==e.success&&(c.success(e.info),o.removeIcon(r),t.icon="icon-partition",o.addIcon(r,{icon:t.icon}),o.unload(r),o.setInode(r),o.deselect(r),setTimeout(function(){o.select(r)},10))},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}o.unload(r)}})}},function(){})},detach_partition:function(t){var n=t||{},a=this,o=s.tree,r=n.item||o.selected(),d=r&&1==r.length?o.itemData(r):void 0;if(!d)return!1;c.confirm(e("Detach Partition"),l(e("Are you sure you want to detach the partition %s?")).sprintf(d._label).value(),function(e){if(e){i.ajax({url:a.generate_url(r,"detach",d,!0),type:"PUT",success:function(e){if(1==e.success){c.success(e.info);var t=o.next(r);t&&t.length||(t=o.prev(r))&&t.length||(t=o.parent(r),o.setInode(t,!0)),o.remove(r),t.length&&o.select(t)}},error:function(e,t,n){try{var a=i.parseJSON(e.responseText);0==a.success&&c.error(a.errormsg)}catch(e){}}})}},function(){})}}),a(p,"model",s.Node.Model.extend({defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1,partition_value:void 0},initialize:function(e,t){if(0===o.size(e)){var i=s.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({relowner:i.name,schema:n._label},{silent:!0})}s.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),type:"text",mode:["properties"]},{id:"relowner",label:e("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit","properties"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:e("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))}},{id:"partition",type:"group",label:e("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:e("Partitioned Table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()}},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"partition_value",label:e("Partition Scheme"),type:"text",visible:!1},{id:"coll_inherits",label:e("Inherited from table(s)"),type:"text",group:e("Advanced"),mode:["properties"]},{id:"Columns",type:"group",label:e("Columns"),mode:["edit","create"],min_version:1e5,visible:function(e){return!1}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),model:s.Nodes.column.model,subnode:s.Nodes.column.model,mode:["create","edit"],disabled:function(e){return e.isNew()&&e.get("is_partitioned")&&setTimeout(function(){var t=e.get("columns");t.remove(t.filter(function(e){return!o.isUndefined(e.get("inheritedfrom"))}))},10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:d.UniqueColCollectionControl.extend({initialize:function(){d.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this;e.model.get(e.field.get("name")).on("change:is_primary_key",function(t){var i,n=e.model.get("primary_key"),a=t.get("name");if(t.get("is_primary_key")){if(n.length<1?(i=new n.model({},{top:e.model,collection:n,handler:n}),n.add(i)):i=n.first(),o.isUndefined(i.get("oid"))){var l=i.get("columns"),r=l.where({column:a});if(0==r.length){var s=new l.model({column:a},{silent:!0,top:e.model,collection:n,handler:n});l.add(s)}l.trigger("pgadmin:multicolumn:updated",l)}}else if(n.length>0){var i=n.first();if(!o.isUndefined(i.get("oid")))return;var l=i.get("columns"),d=l.where({column:a});d.length>0&&(l.remove(d),o.each(d,function(e){e.destroy()}),0==l.length&&setTimeout(function(){n.remove(n.first())},10)),l.trigger("pgadmin:multicolumn:updated",l)}})},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),d.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{id:"inherited_tables_cnt",label:e("Inherited tables count"),type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{type:"nested",control:"tab",group:e("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:e("Primary key"),model:s.Nodes.primary_key.model,subnode:s.Nodes.primary_key.model,editable:!1,type:"collection",group:e("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("primary_key");t.remove(t.filter(function(e){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&o.some(t.pluck("name"))}},{id:"foreign_key",label:e("Foreign key"),model:s.Nodes.foreign_key.model,subnode:s.Nodes.foreign_key.model,editable:!1,type:"collection",group:e("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("foreign_key");t.remove(t.filter(function(e){return!0}))},10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}},{id:"check_constraint",label:e("Check constraint"),model:s.Nodes.check_constraint.model,subnode:s.Nodes.check_constraint.model,editable:!1,type:"collection",group:e("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:e("Unique Constraint"),model:s.Nodes.unique_constraint.model,subnode:s.Nodes.unique_constraint.model,editable:!1,type:"collection",group:e("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("unique_constraint");t.remove(t.filter(function(e){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}},{id:"exclude_constraint",label:e("Exclude constraint"),model:s.Nodes.exclusion_constraint.model,subnode:s.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:e("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout(function(){var t=e.get("exclude_constraint");t.remove(t.filter(function(e){return!0}))},10),!1)},canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}}]},a({id:"typname",label:e("Of type"),type:"text",control:"node-ajax-options",mode:["properties","create","edit"],disabled:"checkOfType",url:"get_oftype",group:e("Advanced"),deps:["coll_inherits","is_partitioned"],transform:function(e,t){return(t||this).model.of_types_tables=e,e}},"control",d.NodeAjaxOptionsControl.extend({onChange:function(){d.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("typname"),n=void 0,a=void 0,l=t.model.get("columns");if(o.isUndefined(i)||""===i||0===l.length)o.isUndefined(i)||""!==i||l.reset();else{var r=e("Changing of table type will clear columns collection.");c.confirm(r,function(e){if(!e)return this;l.reset()})}o.isUndefined(i)||""===i||(a={tname:i},n=t.model.fetch_columns_ajax.apply(t,[a]),l.set(n,{merge:!1,remove:!1}))}})),{id:"fillfactor",label:e("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:e("Advanced")},{id:"relhasoids",label:e("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:e("Advanced")},{id:"relpersistence",label:e("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Advanced")},{id:"conname",label:e("Primary key"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"reltuples",label:e("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"rows_cnt",label:e("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"relhassubclass",label:e("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"is_sys_table",label:e("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:e("Like"),group:e("Advanced"),schema:[{id:"like_relation",label:e("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:e("Like")},{id:"like_default_value",label:e("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_constraints",label:e("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_indexes",label:e("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_storage",label:e("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_comments",label:e("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")}]},{id:"partition_type",label:e("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:[{label:e("Range"),value:"range"},{label:e("List"),value:"list"}],mode:["create"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.isNew()||!e.get("is_partitioned")}},{id:"partition_keys",label:e("Partition Keys"),model:d.PartitionKeyModel,subnode:d.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),i=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(i=1),e.get("partition_keys")&&e.get("partition_keys").length<i&&o.some(t.pluck("name"))},visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.get("partition_keys")&&e.get("partition_keys").models.length>0&&setTimeout(function(){var t=e.get("partition_keys");t.remove(t.filter(function(e){return!0}))},10)}},{id:"partition_scheme",label:e("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partitions",label:e("Partitions"),model:d.PartitionsModel,subnode:d.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,customDeleteTitle:e("Detach Partition"),customDeleteMsg:e("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","values_from","values_to","values_in"],control:d.SubNodeCollectionControl.extend({row:n.PartitionRow,initialize:function(){d.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var n=this.field.get("schema_node"),a=this.field.get("node_info");i.ajax({url:n.generate_url.apply(n,[null,"get_attach_tables",this.field.get("node_data"),!0,a]),type:"GET",async:!1,success:function(i){1==i.success?t.model.table_options=i.data:c.alert(e("Error fetching tables to be attached"),i.data.result)},error:function(t){var n=i.parseJSON(t.responseText);c.alert(e("Error fetching tables to be attached"),n.errormsg)}})}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()&&e.get("partitions")&&e.get("partitions").models.length>0&&setTimeout(function(){var t=e.get("partitions");t.remove(t.filter(function(e){return!0}))},10)}},{id:"partition_note",label:e("Partition"),type:"note",group:"partition",text:e("The control above is used to Create/Attach/Detach partitions.<br><ul><li>Create Mode: User will be able to create N number of partitions. Mode switch control is disabled in this scenario.</li><li>Edit Mode: User will be able to create/attach/detach N number of partitions. In attach mode there will be list of suitable tables to be attached.</li></ul>"),visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{type:"nested",control:"tab",group:e("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:d.VacuumSettingsSchema},{id:"relacl_str",label:e("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:e("Security")},s.SecurityGroupSchema,{id:"relacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:s.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security labels"),canEdit:!1,model:s.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:e("Storage settings"),type:"multiline",group:e("Advanced"),mode:["properties"]}],validate:function(t){var i=(this.changed,void 0),n=this.get("name"),a=this.get("schema"),l=this.get("relowner"),r=this.get("is_partitioned"),s=this.get("partition_keys");return!t||0!=t.length&&-1==o.indexOf(t,"autovacuum_enabled")&&-1==o.indexOf(t,"toast_autovacuum_enabled")?(this.errorModel.clear(),o.isUndefined(n)||o.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(i=e("Table name cannot be empty."),this.errorModel.set("name",i),i):o.isUndefined(a)||o.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(i=e("Table schema cannot be empty."),this.errorModel.set("schema",i),i):o.isUndefined(l)||o.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(i=e("Table owner cannot be empty."),this.errorModel.set("relowner",i),i):r&&this.isNew()&&!o.isNull(s)&&s.length<=0?(i=e("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",i),i):null):null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!o.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!o.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("coll_inherits",[])},10),!0):!(!e.inSchema.apply(this,[e])&&(o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return e.get("is_partitioned")?(setTimeout(function(){e.set("typname",void 0)},10),!0):!(!e.inSchemaWithModelCheck.apply(this,[e])&&(o.isUndefined(e.get("coll_inherits"))||o.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,n="get_columns",a=t.model.top||t.model,l=(o.clone(a.get("columns")),void 0),r=this.field.get("schema_node"),d=this.field.get("node_info"),c=r.generate_url.apply(r,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||!1,d]),p=this.field.get("cache_level")||r.type,u=this.field.get("cache_node");return u=u&&s.Nodes.cache_node||r,a.trigger("pgadmin:view:fetching",a,t.field),i.ajax({async:!1,url:c,data:e,success:function(e){l=u.cache(n,d,p,e.data)},error:function(){a.trigger("pgadmin:view:fetch:error",a,t.field)}}),a.trigger("pgadmin:view:fetched",a,t.field),l=l&&l.data||[]}})),a(p,"canCreate",function(e,t,i){if(i&&0==i.check)return!0;for(var n=s.tree,a=t,l=e;a;){if(o.indexOf(["schema"],l._type)>-1)return!0;if("coll-table"==l._type){var r=n.hasParent(a)?n.parent(a):null;return"catalog"!=(r?n.itemData(r):null)._type}a=n.hasParent(a)?n.parent(a):null,l=a?n.itemData(a):null}return!0}),a(p,"canCreate_with_trigger_enable",function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return e.tigger_count>0}),a(p,"canCreate_with_trigger_disable",function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return e.tigger_count>0&&e.has_enable_triggers>0}),p))}return s.Nodes.partition}.apply(t,o))&&(e.exports=l)}).call(t,i(11))}],[229]).default});